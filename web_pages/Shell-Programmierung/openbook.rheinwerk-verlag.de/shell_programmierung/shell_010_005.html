<html>

<!-- Mirrored from openbook.rheinwerk-verlag.de/shell_programmierung/shell_010_005.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 May 2017 19:57:42 GMT -->
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Rheinwerk Computing :: Shell-Programmierung – 8.6 Mehrere Scripts verbinden und ausf&uuml;hren (Kommunikation zwischen Scripts)</title>
<meta name="title" content="Rheinwerk Computing :: Shell-Programmierung">
<meta name="author" content="J&uuml;rgen Wolf">
<meta name="publisher" content="Rheinwerk Verlag GmbH 2005">
<meta name="copyright" content="Rheinwerk Verlag GmbH 2005">
<meta name="description" content="Shell-Programmierung - Einf&uuml;hrung, Praxis, Referenz – ISBN 3-89842-683-1">
<meta name="audience" content="Alle">
<meta name="robots" content="INDEX,FOLLOW">
<meta http-equiv="content-language" content="de">
<link rel="stylesheet" type="text/css" href="common/rw_open.css">
<link rel="prev" href="shell_010_004.html">
<link rel="next" href="shell_010_006.html"><script type="text/javascript" language="JavaScript"><!--
function OpenWin(url,name,height,width)
{
  var InfoWin = window.open(url,name,"directories=0,height="+height+",width=" + width + ",hotkeys=0,location=0,menubar=0,resizable=1,screenX=150,screenY=10,left=150,top=10,scrollbars=1,status=1,titlebar=0,toolbar=0");
  InfoWin.focus();
}
//--></script></head>
<body vlink="#000099" link="#000099" alink="#000099">
    <table width="100%" height="74" border="0" cellpadding="0" cellspacing="0" bgcolor="#00549d">
        <tr>
            <td height="74" valign="bottom" colspan="2"><a href="https://www.rheinwerk-verlag.de/openbook/?GPP=opsh"><img src="common/rw_openbook.gif" width="200" height="56" border="0" alt="Rheinwerk Computing < openbook >" title="Rheinwerk Computing < openbook >"></a></td>
            <td width="80" height="74"><a href="https://www.rheinwerk-verlag.de/?GPP=opsh"><img src="common/rw_computing.gif" border="0" alt="Rheinwerk Computing - Professionelle B&uuml;cher. Auch f&uuml;r Einsteiger." title="Rheinwerk Computing - Professionelle B&uuml;cher. Auch f&uuml;r Einsteiger."></a></td>
        </tr>
    </table>
    <div align="right"><a href="https://www.rheinwerk-verlag.de/?GPP=opsh" class="navnav">Professionelle B&uuml;cher. Auch f&uuml;r Einsteiger.</a></div>
    <br />
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td width="156" valign="top">
    <table border="0" cellpadding="0" cellspacing="0" width="100%" align="left">
        <tr>
            <td colspan="2" class="nav1" align="left" valign="top" height="150">
                <table class="tbl1" width="150" border="0" cellpadding="3" cellspacing="0">
<tr>
<td class="tbl2" height="25"><A class="nav" href="index-2.html">Inhaltsverzeichnis</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_001_000.html#Xxx999207">Vorwort des Autors</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_002_000.html#Xxx999207">Vorwort des Gutachters – die Shell: Fluch oder Segen?</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_003_000.html#Xxx999276">1 Einf&uuml;hrung</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_004_000.html#Xxx999276">2 Variablen</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_005_000.html#Xxx999276">3 Parameter und Argumente</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_006_000.html#Xxx999276">4 Kontrollstrukturen</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_007_000.html#Xxx999276">5 Terminal-Ein- und Ausgabe</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_008_000.html#Xxx999276">6 Funktionen</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_009_000.html#Xxx999276">7 Signale</A></td>
</tr>
<tr>
<td><A class="navh" href="shell_010_000.html#Xxx999276">8 Rund um die Ausf&uuml;hrung von Scripts und Prozessen</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_011_000.html#Xxx999276">9 N&uuml;tzliche Funktionen</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_012_000.html#Xxx999276">10 Fehlersuche und Debugging</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_013_000.html#Xxx999276">11 Regul&auml;re Ausdr&uuml;cke und grep</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_014_000.html#Xxx999276">12 Der Stream-Editor sed</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_015_000.html#Xxx999276">13 awk-Programmierung</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_016_000.html#Xxx999276">14 Linux-UNIX-Kommandoreferenz</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_017_000.html#Xxx999276">15 Die Praxis</A></td>
</tr>
<tr>
<td><A class="navnav" href="shell_018_A_000.html#Xxx999299">A Anhang</A></td>
</tr>
<tr>
<td><A class="navnav" href="stichwort.html">Index</A></td>
</tr>
<tr><td><br /><!--<a class="navnav" href="http://download.galileo-press.de/openbook/shell_programmierung/galileocomputing_shell_programmierung.zip"><strong>Download:</strong><br />- ZIP, ca. 2,4 MB</a></td></tr>
<tr><td><a class="navnav" href="https://www.rheinwerk-verlag.de/1007/?GPP=opsh">Buch bestellen</a></td></tr>
<tr><td>--><a class="navnav" href="#kommentar">Ihre Meinung?</a><br /><br /></td></tr>
</table></td>
</tr>
</table>
</td>
<td width="10"><img src="common/spacer10.gif" width="10" height="10"></td>
<td width="85%" valign="top" align="center">
    <div align="center">
        <table width="98%" border="0" cellspacing="0" cellpadding="0" bgcolor="#FFFFFF">
            <tr>
                <td width="100%" class="start" colspan="1" height="22" align="center">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="25%"><a class="navnav" href="shell_010_004.html"> &lt;&lt; zur&uuml;ck</a></td>
<td width="49%">
<div align="center"><a href="https://www.rheinwerk-verlag.de/?GPP=opsh" class="navnav">Rheinwerk Computing /</a><a class="navnav" href="https://www.rheinwerk-verlag.de/openbook/?GPP=opsh"> &lt;openbook&gt; /</a><a href="index-2.html" class="navnav"> Shell-Programmierung</a></div></td>
<td align="right" width="25%">
<div align="right"><a class="navnav" href="shell_010_006.html">vor &gt;&gt; </a></div>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td width="100%" valign="top">
    <table width="100%" border="0" cellpadding="10" cellspacing="0" class="box">
        <tr>
            <td colspan="2"><a href="https://www.rheinwerk-verlag.de/1007/?GPP=opsh" class="buchtitel">Shell-Programmierung</a><span class="autor"> von J&uuml;rgen Wolf</span><br><span class="untertitel">Einf&uuml;hrung, Praxis, Referenz</span></td>
        </tr>
        <tr>
            <td valign="top" width="90"><a href="https://www.rheinwerk-verlag.de/1007/?GPP=opsh"><img src="common/9783898426831.gif" border="0" alt="Buch: Shell-Programmierung" title="Buch: Shell-Programmierung" align="left"></a><br/><br/><a href="https://www.rheinwerk-verlag.de/1007/?GPP=opsh"><span class="autor"><strong>Shell-Programmierung</strong><br />782 S., mit CD, 44,90 Euro<br />Rheinwerk Computing<br />ISBN 3-89842-683-1</span></a></a></td>
            <td width="80%">
<table border="0">
<tr>
<td valign="baseline"><img src="common/pfeil_u.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="3" class="kap"><b>Kapitel <a href="shell_010_000.html#RxxKap01000004004EEC1F010172">8 Rund um die Ausf&uuml;hrung von Scripts und Prozessen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="shell_010_000.html#RxxKap01000004004EEC1F010174">8.1 Prozesspriorit&auml;ten</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="shell_010_001.html#RxxKap01000104004F031F038172">8.2 Warten auf andere Prozesse</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="shell_010_002.html#RxxKap01000204004F041F02E172">8.3 Hintergrundprozess wieder hervorholen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="shell_010_003.html#RxxKap01000304004F051F035172">8.4 Hintergrundprozess sch&uuml;tzen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="shell_010_004.html#RxxKap01000404004F061F049172">8.5 Subshells</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a class="navh" href="#RxxKap01000504004F071F049172">8.6 Mehrere Scripts verbinden und ausf&uuml;hren (Kommunikation zwischen Scripts)</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><a class="navh" href="#RxxKap01000504004F071F049174">8.6.1 Daten&uuml;bergabe zwischen Scripts</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><a class="navh" href="#RxxKap01000504004F071F04918A">8.6.2 R&uuml;ckgabe von Daten an andere Scripts</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><a class="navh" href="#RxxKap01000504004F071F04919F">8.6.3 Scripts synchronisieren</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="shell_010_006.html#RxxKap01000604004F081F041172">8.7 Jobverwaltung</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="shell_010_007.html#RxxKap01000704004F091F027172">8.8 Shellscripts zeitgesteuert ausf&uuml;hren</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="shell_010_008.html#RxxKap01000804004F0A1F024172">8.9 Startprozess- und Profildaten der Shell</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><a href="shell_010_008.html#RxxKap01000804004F0A1F02417D">8.9.1 Arten von Initialisierungsdateien</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><a href="shell_010_008.html#RxxKap01000804004F0A1F024181">8.9.2 Ausf&uuml;hren von Profildateien beim Start einer Login-Shell</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><a href="shell_010_008.html#RxxKap01000804004F0A1F02419B">8.9.3 Ausf&uuml;hren von Profildateien beim Start einer Nicht-Login-Shell (Bash und Korn-Shell)</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><a href="shell_010_008.html#RxxKap01000804004F0A1F0241A6">8.9.4 Zusammenfassung alle Profil- und Startup-Dateien</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="shell_010_009.html#RxxKap01000904004F0B1F04C172">8.10 Ein Shellscript bei der Ausf&uuml;hrung</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><a href="shell_010_009.html#RxxKap01000904004F0B1F04C177">8.10.1 Syntax&uuml;berpr&uuml;fung</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><a href="shell_010_009.html#RxxKap01000904004F0B1F04C179">8.10.2 Expansionen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><a href="shell_010_009.html#RxxKap01000904004F0B1F04C180">8.10.3 Kommandos</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="shell_010_010.html#RxxKap01001004004F0C1F02C172">8.11 Shellscripts optimieren</a></b></td>
</tr>
</table><br></td>
</tr>
</table>
<table width="100%" cellpadding="20" cellspacing="0" border="0" bgcolor="#eeeeee">
<tr>
<td>
<a name="t21"></a><a name="t2t31"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div>
<h2 class="t2">8.6 <a id="RxxKap00851MehrereScriptsverbindenundausfuhrenKommunikationzwischenScripts" name="RxxKap00851MehrereScriptsverbindenundausfuhrenKommunikationzwischenScripts"></a>Mehrere Scripts verbinden und ausf&uuml;hren (Kommunikation zwischen Scripts<a id="RxxKap01000504004F071F049172" name="RxxKap01000504004F071F049172"></a>) 
      <a href="#t2t32"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><img src="common/15x15leer.gif" width="15" height="15" border="0" alt="top"></h2>
<p><a id="Xxx999277" name="Xxx999277"></a><a id="Xxx999278" name="Xxx999278"></a>Im Laufe der Zeit werden Sie eine Menge Scripts schreiben und sammeln. H&auml;ufig will man hierbei gern das ein oder andere von einem anderen Script verwenden. Entweder man verwendet dann »Copy &amp; Paste« oder man ruft das Script aus dem Haupt-Script auf. Da es nicht immer ganz einfach ist, Scripts miteinander zu verbinden und die Daten&uuml;bertragung zu behandeln, soll im folgenden Abschnitt ein wenig genauer darauf eingegangen werden.</p>
<a name="t31"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t32"></a><h3 class="t3">8.6.1 Daten&uuml;bergabe zwischen Scripts<a id="RxxKap01000504004F071F049174" name="RxxKap01000504004F071F049174"></a> 
      <a href="#t2t33"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t31"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999281" name="Xxx999281"></a>Zur &Uuml;bergabe von Daten an das neue Script gibt es mehrere g&auml;ngige M&ouml;glichkeiten. Eine einfache ist das Exportieren der Daten, bevor das zweite Script aufgerufen wird. Der Einfachheit halber werden wir hier von »script1« und »script2« reden und diese in der Praxis auch mehrmals verwenden. Hier die M&ouml;glichkeit, Daten an ein anderes Script mittels <span class="listing">export</span> zu &uuml;bergeben:</p>
<pre># Name script1
a=1
b=2
c=3
export a b c
./script2</pre>
<p>Jetzt das <span class="listing">script2</span>:</p>
<pre># Name : script2
echo "$0 : a=$a; b=$b; c=$c"</pre>
<p>Die Daten&uuml;bergabe bei der Ausf&uuml;hrung:</p>
<pre>you@host &gt; ./script1
./script2 : a=1; b=2; c=3</pre>
<p>Eine weitere M&ouml;glichkeit ist die &Uuml;bergabe als Argument, wie Sie dies von der Kommandozeile her kennen. Dem aufgerufenen Script stehen dann die einzelnen Variablen mit den Positionsparametern <span class="listing">$1</span> bis <span class="listing">$9</span> bzw. <span class="listing">${n}</span> zur Verf&uuml;gung. Auch hierzu wieder die beiden Scripts.</p>
<pre># Name script1
a=1
b=2
c=3
./script2 $a $b $c</pre>
<p>Und <span class="listing">script2</span>:</p>
<pre># Name : script2
echo "$0 : a=$1; b=$2; c=$3"</pre>
<p>Die Ausf&uuml;hrung entspricht der im Beispiel mittels <span class="listing">export</span>.</p>
<p>Sobald allerdings der Umfang der Daten zunimmt, werden Sie mit diesen beiden M&ouml;glichkeiten recht schnell an Grenzen sto&szlig;en. Hierzu w&uuml;rde sich die Verwendung einer tempor&auml;ren Datei anbieten: Ein Prozess schreibt etwas in die Datei und ein anderer liest wieder daraus.</p>
<pre># Name script1
IFS='\n'
for var in `ls -l`
do
   echo $var
done &gt; file.tmp
./script2</pre>
<p>Das »script2«:</p>
<pre># Name : script2
while read line
do
   echo $line
done &lt; file.tmp</pre>
<p>Im Beispiel liest »script1« zeilenweise von <span class="listing">`ls</span> <span class="listing">–l`</span> ein und lenkt die Standardausgabe von <span class="listing">echo</span> auf die tempor&auml;re Datei file.tmp um. Am Ende wird »script2« gestartet. »script2« wiederum liest zeilenweise &uuml;ber eine Umlenkung von der Datei file.tmp ein und gibt dies auch zeilenweise mit <span class="listing">echo</span> auf dem Bildschirm aus. Das Ganze k&ouml;nnten Sie auch ohne eine tempor&auml;re Datei erledigen, indem Sie beide Scripts mit einer Pipe starten, da hier ja ein Script die Daten auf die Standardausgabe ausgibt und ein anderes Script die Daten von der Standardeingabe erh&auml;lt:</p>
<pre>you@host &gt; ./script1 | ./script2</pre>
<p>Damit dies auch funktioniert, m&uuml;ssen Sie in den beiden Scripts lediglich die Umlenkungen und den Scriptaufruf entfernen. Somit sieht »script1« wie folgt aus:</p>
<pre># Name script1
IFS='\n'
for var in `ls -l`
do
   echo $var
done</pre>
<p>Und gleiches Bild bei »script2«:</p>
<pre># Name : script2
while read line
do
   echo $line
done</pre>
<a name="t32"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t33"></a><h3 class="t3">8.6.2 R&uuml;ckgabe von Daten an andere Scripts<a id="RxxKap01000504004F071F04918A" name="RxxKap01000504004F071F04918A"></a> 
      <a href="#t2t34"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t32"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999304" name="Xxx999304"></a>Der g&auml;ngigste Weg, Daten aus einem Script an ein anderes zur&uuml;ckzugeben, ist eigentlich die Kommando-Substitution. Ein simples Beispiel:</p>
<pre># Name : script1
var=`./script2`
echo "var=$var"</pre>
<p>Und das »<span class="listing">script2</span>«:</p>
<pre># Name : script2
echo "Hallo script1"</pre>
<p>»script1« bei der Ausf&uuml;hrung:</p>
<pre>you@host &gt; ./script1
var=Hallo script1</pre>
<p>Gleiches funktioniert auch, wenn das Script mehrere Werte zur&uuml;ckgibt. Hierzu w&uuml;rde sich etwa das Aufsplitten der R&uuml;ckgabe mittels <span class="listing">set</span> anbieten:</p>
<pre># Name script1
var=`./script2`
set $var
echo "$1; $2; $3"</pre>
<p>Jetzt noch »script2«:</p>
<pre># Name : script2
var1=wert1
var2=wert2
var3=wert3
echo $var1 $var2 $var3</pre>
<p>»script1« bei der Ausf&uuml;hrung:</p>
<pre>you@host &gt; ./script1
wert1; wert2; wert3</pre>
<p>Sollten Sie allerdings nicht wissen, wie viele Werte ein Script zur&uuml;ckgibt, k&ouml;nnen Sie das Ganze auch in einer Schleife abarbeiten:</p>
<pre># Name script1
var=`./script2`
i=1
for wert in $var
do
   echo "$i: $wert"
   i=`expr $i + 1`
done</pre>
<p>Trotzdem sollte man auch bedenken, dass mit steigendem Umfang der anfallenden Datenmenge auch hier nicht so vorgegangen werden kann. In einer Variablen Daten von mehreren Megabytes zu speichern, ist nicht mehr sehr sinnvoll. Hier bleibt Ihnen nur noch die Alternative, eine tempor&auml;re Datei zu verwenden, wie Sie sie schon in Abschnitt 8.6.2 verwendet haben. Allerdings besteht auch hier ein Problem, wenn bspw. »script1« die Daten aus der tempor&auml;ren Datei lesen will, die »script2« hineinschreibt, aber »script2« die Daten nur scheibchenweise oder eben permanent in die tempor&auml;re Datei hineinschreibt. Dann w&auml;re eine L&ouml;sung mit einer Pipe die bessere Alternative. Auch hierzu m&uuml;ssten Sie nur »script1« ver&auml;ndern:</p>
<pre># Name script1
./script2 | while read wert
do
   for val in $wert
   do
      echo "$val"
   done
done</pre>
<h4 class="t4">Named Pipe</h4>
<p><a id="Xxx999322" name="Xxx999322"></a><a id="Xxx999323" name="Xxx999323"></a><a id="Xxx999324" name="Xxx999324"></a>Ein weiteres sehr interessantes Mittel zur Daten&uuml;bertragung zwischen mehreren Scripts haben Sie in Abschnitt 5.6 mit der Named Pipe (FIFOs) kennen gelernt. Der Vor- bzw. auch Nachteil (je nach Anwendungsfall) ist hierbei, dass ein Prozess, der etwas in eine Pipe schreibt, so lange blockiert wird, bis auf der anderen Seite ein Prozess ist, der etwas daraus liest. Umgekehrt nat&uuml;rlich derselbe Fall. Ein typischer Anwendungsfall w&auml;re ein so genannter Server, der Daten von beliebigen Clients, die ihm etwas durch die Pipe schicken, einliest:</p>
<pre># Name: PipeServer
mknod meine_pipe p
while true
do
   # Wartet auf Daten aus der Pipe
   read zeile &lt; meine_pipe
   echo $zeile
done</pre>
<p>Statt einer Ausgabe auf dem Bildschirm k&ouml;nnen Sie mit diesem Server munter Daten von beliebig vielen anderen Scripts sammeln. Der Vorteil: Die anderen Scripts, die Daten in diese Pipe schicken, werden nicht blockiert, weil immer auf der anderen Seite des Rohrs der Server »PipeServer« darauf wartet.</p>
<a name="t33"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t34"></a><h3 class="t3">8.6.3 Scripts synchronisieren<a id="RxxKap01000504004F071F04919F" name="RxxKap01000504004F071F04919F"></a> 
      <img src="common/15x15leer.gif" width="15" height="15" border="0" alt="top"><a href="#t2t33"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999329" name="Xxx999329"></a><a id="Xxx999330" name="Xxx999330"></a>Sp&auml;testens, wenn Ihre Scripts dauerhaft laufen sollen, ben&ouml;tigen Sie eine Prozess-Synchronisation. Fallen hierbei dann mehr als zwei Scripts an und wird au&szlig;erdem in eine Datei geschrieben und gelesen, haben Sie schnell Datensalat. <a id="Xxx999332" name="Xxx999332"></a>Eine recht einfache und zuverl&auml;ssige Synchronisation zweier oder auch mehrerer Scripts erreichen Sie bspw. mit den Signalen. Richten Sie hierzu einfach einen Signalhandler mit <span class="listing">trap</span> ein, der auf ein bestimmtes Signal reagiert und ein weiteres Script aufruft. Bspw.:</p>
<pre># Name: script1
trap './script2' SIGUSR1
while true
do
   echo "Lese Daten ..."
   sleep 5
   echo "Starte script2 ..."
   kill -SIGUSR1 $$
done</pre>
<p>Und das »script2«:</p>
<pre># Name: script2
trap './script1' SIGUSR2
while true
do
   echo "Schreibe Daten ..."
   sleep 5
   echo "Starte script1 ..."
   kill -SIGUSR2 $$
done</pre>
<p>Die Scripts bei der Ausf&uuml;hrung:</p>
<pre>you@host &gt; ./script1
Lese Daten ...
Starte script2 ...
Schreibe Daten ...
Starte script1 ...
Lese Daten ...
Starte script2 ...
Schreibe Daten ...
Starte script1 ...
Lese Daten ...
Starte script2 ...
Schreibe Daten ...</pre>
<p>Eine weitere M&ouml;glichkeit zur Synchronisation von Scripts besteht darin, eine Datei zu verwenden. Hierbei wird in einer Endlosschleife immer &uuml;berpr&uuml;ft, ob eine bestimmte Bedingung erf&uuml;llt ist. Je nach Bedingung wird dann ein entsprechendes Script ausgef&uuml;hrt. Hierzu werden alle Scripts aus einem Haupt-Script gesteuert. Was Sie dabei alles &uuml;berpr&uuml;fen, bleibt Ihnen &uuml;berlassen. H&auml;ufig verwendet werden die Existenz, das Alter, die Gr&ouml;&szlig;e oder die Zugriffsrechte auf eine Datei. Eben alles, was sich mit dem Kommando <span class="listing">test</span> realisieren l&auml;sst. Nat&uuml;rlich sollten Sie in einem Haupt-Script weiterhin die Steuerung &uuml;bernehmen. Ein Beispiel:</p>
<pre># Name: mainscript
FILE=tmpfile.tmp
rm $FILE
touch $FILE
while true
do
  # Ist die Datei lesbar
  if [ -r $FILE ]
  then
     echo "Datei wird gelesen ..."
     sleep 1
     #./script_zum_Lesen
     # Freigeben zum Schreiben
     chmod 0200 $FILE;
  fi
  if [ -w $FILE ]
  then
     echo "Datei ist bereit zum Schreiben ..."
     sleep 1
     #./script_zum_Shreiben
     # Freigeben zum Lesen
     chmod 0400 $FILE
  fi
  sleep 1
done</pre>
<p>Hier wird in einer Endlosschleife immer &uuml;berpr&uuml;ft, ob eine Datei lesbar oder schreibbar ist und dann eben entsprechende Aktionen ausgef&uuml;hrt. Selbiges k&ouml;nnten Sie &uuml;brigens auch ohne eine extra Datei mit einer globalen Variablen erledigen. Sie &uuml;berpr&uuml;fen in einer Endlosschleife st&auml;ndig den Wert der globalen Variablen und f&uuml;hren entsprechende Aktionen aus. Nach der Ausf&uuml;hrung einer Aktion ver&auml;ndern Sie die globale Variable so, dass eine weitere Aktion ausgef&uuml;hrt werden kann.</p>
<br><hr><a name="kommentar"></a><h3>Ihr Kommentar</h3>
                                                <p>Wie hat Ihnen das &lt;openbook&gt; gefallen? Wir freuen uns immer über Ihre freundlichen
                                                   und kritischen Rückmeldungen.
                                                </p>
                                                <!--<form action="http://www.galileo-press.de/feedback/openbook" method="post" style="text-align: center; margin-top: 10px;"><input type="hidden" name="openbookurl" value="http://openbook.galileocomputing.de/shell_programmierung/"><input type="hidden" name="buchtitel" value="Shell-Programmierung"><table border="0">
                                                      <tbody>
                                                         <tr>
                                                            <td><label for="name">Name</label><br></td>
                                                            <td><input type="text" name="name" id="name" size="40"><br></td>
                                                         </tr>
                                                         <tr>
                                                            <td><label for="email">E-Mail</label><br></td>
                                                            <td><input type="text" name="email" id="email" size="40"><br></td>
                                                         </tr>
                                                         <tr>
                                                            <td valign="top"><label for="comment">Ihr Kommentar</label><br></td>
                                                            <td><textarea name="comment" id="comment" rows="10" cols="40"></textarea><br></td>
                                                         </tr>
                                                         <tr>
                                                            <td></td>
                                                            <td><input type="submit" value="Kommentar absenden"></td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </form>--><a href="https://www.rheinwerk-verlag.de/feedback/produkt/1007/">>> Zum Feedback-Formular</a>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td width="100%" class="start" colspan="1" height="22" align="center">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="25%"><a class="navnav" href="shell_010_004.html"> &lt;&lt; zur&uuml;ck</a></td>
<td width="49%">
<div align="center"><a class="navnav" href="#">&lt;top&gt;</a></div>
</td>
<td align="right" width="25%">
<div align="right"><a class="navnav" href="shell_010_006.html">vor &gt;&gt; </a></div>
</td>
</tr>
</table>
</td>
</tr>
</table>
</div>
</td>
<td width="10" valign="top">&nbsp;&nbsp;</td>
<td width="160" valign="top">
    <table border="0" cellpadding="0" cellspacing="0" width="160">
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                        <td class="tbl2" height="20" colspan="2">
                            &nbsp;<a href="https://www.rheinwerk-verlag.de/?GPP=opsh" class="navs">
                            <strong>Zum Katalog</strong></a>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2">
                            <img src="common/leer.gif" border="0" height="1" width="1"></td>
                        <td valign="top">
                            <table cellspacing="3">
                                <tr>
                                    <td><a href="https://www.rheinwerk-verlag.de/shell-programmierung_1007/?GPP=opsh">
                                        <img src="common/683.gif" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Shell-Programmierung" title="Zum Katalog: Shell-Programmierung">
                                        <br /><strong>Shell-Programmierung</strong><br /><img src="common/pfeil_rechts5.gif" border="0" alt="">bestellen</a>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        
        <tr>
            <td><img src="common/leer.gif" height="2" width="1" border="0" /></td>
        </tr>
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                        <td class="tbl2" height="20" colspan="2">&nbsp;<a href="https://www.rheinwerk-verlag.de/?GPP=opsh" class="navs"><strong>Buchtipps</strong></a></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/shell-programmierung_3345/?GPP=opsh">
                        <img src="common/2310.gif" width="69" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Shell-Programmierung" title="Zum Katalog: Shell-Programmierung"><br /><br /><br /><br /><br /><br /><br />&nbsp;Shell-Programmierung</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/linux-server_3685/?GPP=opsh">
                        <img src="common/3020.gif" width="78" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Linux-Server" title="Zum Katalog: Linux-Server"><br /><br /><br /><br /><br /><br /><br />&nbsp;Linux-Server</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/das-komplettpaket-lpic-1-lpic-2_3782/?GPP=opsh">
                        <img src="common/3529.gif" width="70" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Das Komplettpaket LPIC-1 &amp; LPIC-2" title="Zum Katalog: Das Komplettpaket LPIC-1 &amp; LPIC-2"><br /><br /><br /><br /><br /><br /><br />&nbsp;Das Komplettpaket<br />&nbsp;LPIC-1 &amp; LPIC-2</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/linux-hochverfugbarkeit_3420/?GPP=opsh">
                        <img src="common/2542.gif" width="70" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Linux-Hochverfügbarkeit" title="Zum Katalog: Linux-Hochverfügbarkeit"><br /><br /><br /><br /><br /><br /><br />&nbsp;Linux-<br />&nbsp;Hochverfügbarkeit</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/linux_3436/?GPP=opsh">
                        <img src="common/2591.gif" width="79" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Linux Handbuch" title="Zum Katalog: Linux Handbuch"><br /><br /><br /><br /><br /><br /><br />&nbsp;Linux Handbuch</a><br /><br /></td>
                    </tr>
                </table></td>
        </tr>
        <tr>
            <td><img src="common/leer.gif" height="2" width="1" border="0" /></td>
        </tr>
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                        <td class="tbl2" height="20" colspan="2"><strong>&nbsp;Shopping</strong></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td>
                        <td valign="top">
                            <table cellspacing="3">
                                <tr>
                                    <td><b>Versandkostenfrei</b> bestellen in Deutschland und &Ouml;sterreich<br /><a href="https://www.rheinwerk-verlag.de/hilfe/bestellung_6?GPP=opsh"><img src="common/pfeil_rechts5.gif" border="0" alt="Info">Info</a><br /><br /></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</td>
</tr>
</table>
<br /><br />
<hr width="70%" align="center">
<br><div align="center">
<p class="standard"><b>Copyright © Rheinwerk Verlag GmbH 2005</b><br>F&uuml;r Ihren privaten Gebrauch d&uuml;rfen Sie die Online-Version nat&uuml;rlich ausdrucken. Ansonsten unterliegt das &lt;openbook&gt; denselben Bestimmungen, wie die gebundene Ausgabe: Das Werk einschlie&szlig;lich aller seiner Teile ist urheberrechtlich gesch&uuml;tzt. Alle Rechte vorbehalten einschlie&szlig;lich der Vervielf&auml;ltigung, &Uuml;bersetzung, Mikroverfilmung sowie Einspeicherung und Verarbeitung in elektronischen Systemen.</p><br><a href="https://www.rheinwerk-verlag.de/?GPP=opsh">[Rheinwerk Computing]</a><br><br>Rheinwerk Verlag GmbH, Rheinwerkallee 4, 53227 Bonn, Tel.: 0228.42150.0, Fax 0228.42150.77, <a href="mailto:service@rheinwerk-verlag.de">service@rheinwerk-verlag.de</a></div><br><br></body>

<!-- Mirrored from openbook.rheinwerk-verlag.de/shell_programmierung/shell_010_005.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 May 2017 19:57:42 GMT -->
</html>
