<html>

<!-- Mirrored from openbook.rheinwerk-verlag.de/linux_unix_programmierung/Kap12-004.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 May 2017 19:58:03 GMT -->
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Linux-UNIX-Programmierung – 12.5 MySQL C-API</title>
<meta name="title" content="Linux-UNIX-Programmierung">
<meta name="author" content="J&uuml;rgen Wolf">
<meta name="publisher" content="Rheinwerk Verlag GmbH 2006">
<meta name="copyright" content="Rheinwerk Verlag GmbH 2006">
<meta name="description" content="Linux-UNIX-Programmierung - Das umfassende Handbuch – 2., aktualisierte und erweiterte Auflage 2006 – ISBN 3-89842-749-8">
<meta name="audience" content="Alle">
<meta name="robots" content="INDEX,FOLLOW">
<meta http-equiv="content-language" content="de">
<link rel="stylesheet" type="text/css" href="common/rw_open.css">
<link rel="prev" href="Kap12-003.html">
<link rel="next" href="Kap12-005.html"><script type="text/javascript" language="JavaScript"><!--
function OpenWin(url,name,height,width)
{
  var InfoWin = window.open(url,name,"directories=0,height="+height+",width=" + width + ",hotkeys=0,location=0,menubar=0,resizable=1,screenX=150,screenY=10,left=150,top=10,scrollbars=1,status=1,titlebar=0,toolbar=0");
  InfoWin.focus();
}
//--></script></head>
<body vlink="#000099" link="#000099" alink="#000099">
<table width="100%" height="74" border="0" cellpadding="0" cellspacing="0" bgcolor="#00549d">
<tr>
<td height="74" valign="bottom" colspan="2"><a href="https://www.rheinwerk-verlag.de/openbook/?GPP=oplup"><img src="common/rw_openbook.gif" width="200" height="56" border="0" alt="Rheinwerk Computing < openbook >"></a></td>
<td width="80" height="74">
<a href="https://www.rheinwerk-verlag.de/?GPP=oplup"><img src="common/rw_computing.gif" border="0" alt="Rheinwerk Computing - Professionelle B&uuml;cher. Auch f&uuml;r Einsteiger."></a>
</td>
</tr>
</table><div align="right"><a href="https://www.rheinwerk-verlag.de/?GPP=oplup" class="navnav">Professionelle B&uuml;cher. Auch f&uuml;r Einsteiger</a></div><br /><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="156" valign="top"><table border="0" cellpadding="0" cellspacing="0" width="100%" align="left">
<tr>
<td colspan="2" class="nav1" align="left" valign="top" height="150">
<table class="tbl1" width="150" border="0" cellpadding="3" cellspacing="0">
<tr>
<td class="tbl2" height="25"><A class="nav" href="index-2.html">Inhaltsverzeichnis</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap00a-000.html#Xxx999195">Vorwort des Autors</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap00b-000.html#Xxx999195">Vorwort der Fachgutachter</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap01-000.html#Xxx999235">1 Einf&uuml;hrung</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap02-000.html#Xxx999234">2 E/A-Funktionen</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap03-000.html#Xxx999234">3 Attribute von Dateien und Verzeichnissen</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap04-000.html#Xxx999234">4 Zugriff auf Systeminformationen</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap05-000.html#Xxx999234">5 Devices – eine einfache Verbindung zur Hardware</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap06-000.html#Xxx999234">6 System- und Benutzerdateien</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap07-000.html#Xxx999234">7 D&auml;monen, Zombies und Prozesse</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap08-000.html#Xxx999235">8 Signale</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap09-000.html#Xxx999235">9 IPC – Interprozesskommunikation</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap10-000.html#Xxx999234">10 Threads</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap11-000.html#Xxx999235">11 Netzwerkprogrammierung</A></td>
</tr>
<tr>
<td><A class="navnavh" href="Kap12-000.html#Xxx999236">12 MySQL und PostgreSQL</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap13-000.html#Xxx999235">13 Terminal E/A und Benutzerschnittstellen f&uuml;r die Konsole</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap14-000.html#Xxx999235">14 Xlib – X Window-Programmierung</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap15-000.html#Xxx999235">15 GTK+</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap16-000.html#Xxx999235">16 SDL</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap17-000.html#Xxx999247">17 Werkzeuge f&uuml;r Programmierer</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap18A-000.html#Xxx999248">A Sicherheit unter Linux</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap18B-000.html#Xxx999245">B Funktionsreferenz</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap18C-000.html#Xxx999245">C Inhalt der Buch-CD</A></td>
</tr>
<tr>
<td><A class="navnav" href="stichwort.html#Xxx537584">Index</A></td>
</tr>
<tr><td><br /><!--<a class="navnav" href="http://download.galileo-press.de/openbook/lup/galileocomputing_linux_unix_programmierung.zip"><strong>Download:</strong><br />- ZIP, ca. 4,3 MB</a></td></tr>
<tr><td><a class="navnav" href="https://www.rheinwerk-verlag.de/1137/?GPP=oplup">Buch bestellen</a></td></tr>
<tr><td>--><a class="navnav" href="https://www.rheinwerk-verlag.de/feedback/">Ihre Meinung?</a><br /><br /></td></tr>
</table></td>
</tr>

</table>
</td>
<td width="10"><img src="common/spacer10.gif" width="10" height="10"></td>
<td width="85%" valign="top" align="center">
<div align="center">
<table width="98%" border="0" cellspacing="0" cellpadding="0" bgcolor="#FFFFFF">
<tr>
<td width="100%" class="start" colspan="1" height="22" align="center">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="20%"><a class="navnav" href="Kap12-003.html"> &lt;&lt; zur&uuml;ck</a></td>
<td width="59%">
<div align="center"><a href="https://www.rheinwerk-verlag.de/?GPP=oplup" class="navnav">Rheinwerk Computing /</a><a class="navnav" href="https://www.rheinwerk-verlag.de/openbook/?GPP=oplup"> &lt;openbook&gt; /</a> <a href="index-2.html" class="navnav"> Linux-UNIX-Programmierung</a></div>
</td>
<td align="right" width="20%">
<div align="right"><a class="navnav" href="Kap12-005.html">vor &gt;&gt; </a></div>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td width="100%" valign="top">
<table width="100%" border="0" cellpadding="10" cellspacing="0" class="box">
<tr>
<td colspan="2"><a href="https://www.rheinwerk-verlag.de/1137/?GPP=oplup" class="buchtitel">Linux-UNIX-Programmierung</a><span class="autor"> von J&uuml;rgen Wolf</span><br><span class="untertitel">Das umfassende Handbuch – 2., aktualisierte und erweiterte Auflage 2006</span></td>
</tr>
<tr>
<td valign="top" width="90"><a href="https://www.rheinwerk-verlag.de/1137/?GPP=oplup"><img src="common/9783898427494.gif" border="0" alt="Buch: Linux-UNIX-Programmierung" title="Buch: Linux-UNIX-Programmierung" align="left"><br /><br /><span class="autor"><strong>Linux-UNIX-Programmierung</strong><br />1216 S., mit CD, 49,90 Euro<br />Rheinwerk Computing<br />ISBN 3-89842-749-8</span></a></a></td>
<td width="80%">
<table border="0">
<tr>
<td valign="baseline"><img src="common/pfeil_u.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="3" class="kap"><b>Kapitel <a href="Kap12-000.html#RxxKap12000040004161F04F100">12 MySQL und PostgreSQL</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap12-000.html#RxxKap12000040004161F04F103">12.1 Relationales Datenbanksystem</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap12-001.html#RxxKap12001040004331F01E100">12.2 Relationaler Datenbankserver</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap12-002.html#RxxKap12002040004341F03B100">12.3 SQL-Server im &Uuml;berblick</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap12-003.html#RxxKap12003040004351F038100">12.4 MySQL</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F038105">12.4.1 Anwendungsgebiete von MySQL</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F03810C">12.4.2 Schnittstellen von MySQL</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F03810F">12.4.3 Installation von MySQL</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F038114">12.4.4 MySQL-Server starten und stoppen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F03817A">12.4.5 Konfigurationsdatei my.cnf</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F03818C">12.4.6 Kommandozeilenwerkzeuge f&uuml;r und von mysql</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F0381B6">12.4.7 Grafische Clients</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F0381BE">12.4.8 MySQL-Crashkurs</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F0381C8">12.4.9 Datentypen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F038251">12.4.10 Datenbank anlegen, verwenden und l&ouml;schen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F038275">12.4.11 Tabelle anlegen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F038281">12.4.12 Schl&uuml;sselfelder (Tabellen anlegen)</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F038286">12.4.13 Indizes</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F03828F">12.4.14 Tabellentypen (Tabellen anlegen)</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F038291">12.4.15 Autowerte definieren</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F038294">12.4.16 Tabellen umbenennen und &auml;ndern</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F0382A5">12.4.17 Daten einf&uuml;gen, &auml;ndern und l&ouml;schen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F0382BB">12.4.18 Daten importieren</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F0382C1">12.4.19 Datenausgabe</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F0382D4">12.4.20 NULL ist 0 oder undefiniert?</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-003.html#RxxKap12003040004351F0382D6">12.4.21 Unscharfe Suche</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a class="navh2" href="#RxxKap12004040004361F03F100">12.5 MySQL C-API</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F175">12.5.1 Verbindung mit dem MySQL-Server aufbauen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F199">12.5.2 Aufgetretene Fehler ermitteln – mysql_errno() und mysql_error()</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F1A0">12.5.3 Schlie&szlig;t die Verbindung zum Server – mysql_close()</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F1A4">12.5.4 Erstes Beispiel</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F1AF">12.5.5 Verschiedene Informationen ermitteln</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F1C8">12.5.6 Datenbanken, Tabellen und Felder ausgeben (MYSQL_RES)</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F1DF">12.5.7 Ergebnismenge zeilenweise bearbeiten (MYSQL_ROW)</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F1F7">12.5.8 Ergebnismenge spaltenweise einlesen (und ausgeben) (MYSQL_FIELD)</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F267">12.5.9 Ein Beispiel</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F26C">12.5.10 Ergebnismenge – weitere Funktionen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F276">12.5.11 Befehle an den Server – mysql_query() und mysql_real_query()</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F2A4">12.5.12 Weitere Funktionen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F2F8">12.5.13 Veraltete Funktionen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap12004040004361F03F308">12.5.14 Neue Funktionen ab Version 4.1.x</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap12-005.html#RxxKap12005040004371F021100">12.6 Beispiel eines Newssystems mit MySQL</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-005.html#RxxKap12005040004371F02110B">12.6.1 Die Headerdatei my_cgi.h</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-005.html#RxxKap12005040004371F02110E">12.6.2 (Pseudo-)Planung</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-005.html#RxxKap12005040004371F021114">12.6.3 Datenbank und Tabellen anlegen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-005.html#RxxKap12005040004371F0211AA">12.6.4 MySQL-Clients mit GUI</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-005.html#RxxKap12005040004371F0211AC">12.6.5 Randnotiz</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap12-006.html#RxxKap12006040004381F04D100">12.7 Neue SQL-Funktionen f&uuml;r die Shell – MySQL erweitern</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap12-007.html#RxxKap12007040004391F02B100">12.8 MySQL-Funktionen mit der UDF-Schnittstelle entwerfen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-007.html#RxxKap12007040004391F02B17D">12.8.1 UDF-Sequenzen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-007.html#RxxKap12007040004391F02B187">12.8.2 UDF_INIT-Struktur</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-007.html#RxxKap12007040004391F02B18D">12.8.3 UDF_ARGS-Struktur</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-007.html#RxxKap12007040004391F02B19C">12.8.4 R&uuml;ckgabewert</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-007.html#RxxKap12007040004391F02B1A1">12.8.5 Benutzerdefinierte Funktionen erstellen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-007.html#RxxKap12007040004391F02B1A9">12.8.6 Benutzerdefinierte Funktion kompilieren, installieren und ausf&uuml;hren</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap12-008.html#RxxKap120080400043A1F017100">12.9 PostgreSQL – objektrelationales Datenbankverwaltungssystem</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-008.html#RxxKap120080400043A1F017104">12.9.1 PostgreSQL im Vergleich zu MySQL</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-008.html#RxxKap120080400043A1F017116">12.9.2 Unterschiede in der Syntax zwischen MySQL und PostgreSQL</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-008.html#RxxKap120080400043A1F01717A">12.9.3 PostgreSQL installieren</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-008.html#RxxKap120080400043A1F017183">12.9.4 Konfigurationsdateien bei PostgreSQL – (postgresql.conf, pg_hba_conf)</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-008.html#RxxKap120080400043A1F017195">12.9.5 CRASHKURS PostgreSQL</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-008.html#RxxKap120080400043A1F017247">12.9.6 PostgreSQL C-API – libpg</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-008.html#RxxKap120080400043A1F017304">12.9.7 Umgebungsvariablen und Passwortdatei</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-008.html#RxxKap120080400043A1F017312">12.9.8 PostgreSQL und Threads</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap12-008.html#RxxKap120080400043A1F017316">12.9.9 Ausblick</a></b></td>
</tr>
</table><br></td>
</tr>
</table>
<table width="100%" cellpadding="20" cellspacing="0" border="0" bgcolor="#eeeeee">
<tr>
<td>
<a name="t21"></a><a name="t2t31"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div>
<h2 class="t2">12.5 <a id="RxxKap12276MySQLCAPI" name="RxxKap12276MySQLCAPI"></a>MySQL C-<a id="RxxKap12004040004361F03F100" name="RxxKap12004040004361F03F100"></a>API 
      <a href="#t2t32"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><img src="common/15x15leer.gif" width="15" height="15" border="0" alt="top"></h2>
<p><a id="Xxx999237" name="Xxx999237"></a>Mit der MySQL C-API (API = Application Interface) sind Sie in der Lage, eigene Clientanwendungen wie <span class="listing">mysql</span> (Shell) oder <span class="listing">mysqladmin</span> zu entwickeln, womit Sie Zugriff auf den MySQL-Server haben. Um eigene Clientanwendungen zu schreiben, ben&ouml;tigen Sie die Bibliothek zu MySQL (lib) und die entsprechenden Headerdateien (include). Die Bibliothek sollten Sie gew&ouml;hnlich im Verzeichnis <span class="listing">/usr/lib</span>, <span class="listing">/usr/lib/mysql</span> oder <span class="listing">/usr/local/lib/mysql</span> vorfinden. Die Headerdatei(en) befindet sich im Verzeichnis, wo sich auch die anderen Include-Dateien aufhalten sollten (<span class="listing">/usr/include/mysql</span> oder <span class="listing">/usr/local/include/mysql</span>). Sollte sich bei Ihnen in den eben genannten Verzeichnissen nichts dergleichen befinden, haben Sie wahrscheinlich eine RPM-Installation gemacht. In diesem Fall m&uuml;ssen Sie noch extra ein RPM namens Developer RPM nachinstallieren. Gew&ouml;hnlich sollte diese RPM Ihrer Distribution beiliegen. Ansonsten m&uuml;ssen Sie bei http://www.mysql.de vorbeischauen und entsprechende RPMs herunterladen und installieren.</p>
<p>Wenn Sie Ihren MySQL Client-Quellcode erstellt haben, m&uuml;ssen Sie dem Compiler sagen, wo sich die Include-Dateien befinden, und der Linker will ebenfalls wissen, welche Bibliotheken er von wo zum Linken verwenden soll. Die Information f&uuml;r den Compiler geben Sie mit dem Flag <span class="listing">-I</span> an. Ist der Programmname z. B. <span class="listing">mein_Client.c</span>, dann sieht der Compileraufruf wie folgt aus:</p>
<pre>$ gcc -c -I/usr/include/mysql mein_Client.c</pre>
<p>Nach erfolgreicher Kompilierung befindet sich jetzt im Verzeichnis eine Objektdatei (<span class="listing">*.o</span>). Um daraus jetzt eine ausf&uuml;hrbare Datei zu machen, m&uuml;ssen Sie dem Linker sagen, wo er die Bibliothek f&uuml;r seine Arbeit findet und welche Bibliothek er dazu verwenden soll. Das Wo erledigen Sie mit dem Flag <span class="listing">-L</span> und der Pfadangabe, und welche Bibliothek dazu verwendet werden soll, geben Sie hinter dem Flag <span class="listing">-l</span> an. Die komplette Eingabe lautet hierzu also:</p>
<pre>$ gcc -o mein_Client mein_Client.o -L/usr/lib/mysql -lmysqlclient</pre>
<p>Wenn beim Compilerlauf und beim anschlie&szlig;enden Linken keine Probleme aufgetreten sind, k&ouml;nnen Sie die Clientanwendung mit dem Namen starten:</p>
<pre>$ ./my_Client</pre>
<p>Damit Sie aber nicht dauernd so viel tippen m&uuml;ssen, k&ouml;nnen Sie auch die Datei <span class="listing">.bash_profile</span> anpassen, oder besser noch, Sie verwenden ein Makefile.</p>
<p>Bei manchen Systemen kann es zu Problemen mit dem Linkerlauf kommen. Meistens will der Linker dabei nur mehr Input zu weiteren Bibliotheken. Geben Sie dem Linker, was er will, und Sie k&ouml;nnen in Ruhe weiterarbeiten. Hier einige Libraries, die Sie eventuell hinzulinken m&uuml;ssen:</p>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<caption class="tabunter">
<p><span class="tabunter"><b>Tabelle 12.5   
    </b>Eventuell weitere ben&ouml;tigte Linkerflags</span></p>
</caption>
<tr>
<td class="tabellenkopf" bgcolor="#000000"><b>Flag</b>
</td>
<td class="tabellenkopf" bgcolor="#000000"><b>Bedeutung</b>
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">-lm
</td>
<td class="tabellentext" bgcolor="#000000">Die C-API verwendet einige Funktionen aus der Headerdatei &lt;math.h&gt;, und einige Linux-Systeme wollen dies immer noch extra angegeben haben.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">(-lm) –lsocket
 -lnsl
</td>
<td class="tabellentext" bgcolor="#000000">Diese Flags wollen die Solaris-Rechner haben.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">-lz (zlib)
</td>
<td class="tabellentext" bgcolor="#000000">Diese Bibliothek ben&ouml;tigen Sie bei einem Undefined-Reference-Fehler bei den Funktionen compress und uncompress. Dieser Fehler hat den Autor schon an den Rand eines Nervenzusammenbruchs gebracht.
</td>
</tr>
</table><br>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis[1]</b>   Auf Linux braucht man keine der o. g. Extra-Bibliotheken anzugeben, da weitere von MySQL ben&ouml;tigte Bibliotheken bereits in der <span class="listing">libmysqlclient.so</span> angegeben sind und daher automatisch eingebunden werden.</p>
<p class="BStandard"><b>Hinweis[2]</b>   Sollten Sie dennoch Probleme mit den Pfaden zum Include-Verzeichnis oder den Bibliotheken haben, k&ouml;nnen Sie hierzu auch das Shellscript <span class="listing">mysql_config</span> mit dem Flag <span class="listing">--cflags</span> (f&uuml;r die Include-Angaben) und <span class="listing">--libs</span> (f&uuml;r die Bibliotheksangaben) verwenden.</p>
<p class="BStandard"><b>Hinweis am Rande   </b>Das Verwenden einer neuen API (unabh&auml;ngig davon, welche das jetzt ist) l&auml;sst den Code anfangs immer etwas komplexer und eben fremd aussehen. Sie sollten sich davon aber nicht abschrecken lassen. Gew&ouml;hnlich steckt in jeder API ein gut durchdachtes Design, das schnell zu durchschauen ist. Gew&ouml;hnlich funktionieren APIs immer nach demselben Prinzip. Man initialisiert etwas, indem man z. B. Speicher reserviert. Dann stellt man eine Verbindung/Beziehung her, und anschlie&szlig;end kann mit dieser Verbindung/Beziehung gearbeitet werden. Am Ende gibt man alles wieder frei. Wenn Sie ein wenig zur&uuml;ckdenken, wird Ihnen auffallen, dass das Prinzip immer dasselbe ist.</p>
</td>
</tr>
</table><br>
<a name="t31"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t32"></a><h3 class="t3">12.5.1 Verbindung mit dem MySQL-Server aufbaue<a id="RxxKap12004040004361F03F175" name="RxxKap12004040004361F03F175"></a>n 
      <a href="#t2t33"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t31"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p>Im ersten Beispiel werden Sie sehen, wie Sie eine Verbindung zum MySQL-Server aufbauen, die Verbindung auf Fehler &uuml;berpr&uuml;fen und die Verbindung wieder ordentlich schlie&szlig;en k&ouml;nnen.</p>
<h4 class="t4">MySQL-Objekt alloziieren oder initialisieren – mysql_init()</h4>
<p>Bevor Sie eine Verbindung zum Server aufbauen, m&uuml;ssen Sie erst f&uuml;r ein MySQL-Objekt Speicher alloziieren oder es initialisieren. Diese Aufgabe erledigt die Funktion <span class="listing">mysql_init()<a id="Xxx999283" name="Xxx999283"></a></span>:</p>
<pre>#include &lt;mysql.h&gt;
MYSQL *mysql_init(MYSQL *mysql) </pre>
<p><a id="Xxx999285" name="Xxx999285"></a>Geben Sie dieser Funktion als Parameter <span class="listing">NULL</span>, wird zuerst Speicherplatz f&uuml;r das MySQL-Objekt reserviert und dieses anschlie&szlig;end gleich initialisiert. Der R&uuml;ckgabewert ist dabei die Adresse eines neuen MySQL-Objekts. Bei diesem MySQL-Objekt handelt es sich intern nat&uuml;rlich nur um eine Struktur, die sich hinter einem <span class="listing">typedef</span> versteckt. Dieses MySQL-Objekt, Sie k&ouml;nnen es auch gerne Handle oder MySQL-Stream nennen, wird f&uuml;r fast alle Funktionen der MySQL C-API ben&ouml;tigt. Geben Sie hingegen f&uuml;r den Parameter ein MySQL-Objekt an, wird das Objekt initialisiert und die Adresse des Objekts zur&uuml;ckgegeben. <span class="listing">mysql_init()</span> ist somit das <span class="listing">malloc()</span> f&uuml;r MySQL, wenn Sie so wollen. Reicht der Speicher f&uuml;r ein neues Objekt nicht aus, wird <span class="listing">NULL</span> zur&uuml;ckgegeben.</p>
<h4 class="t4">Verbindung zum MySQL-Server aufbauen – mysql_real_connect()</h4>
<p><a id="Xxx999288" name="Xxx999288"></a>Nach erfolgreicher Ausf&uuml;hrung der Funktion <span class="listing">mysql_init()</span> wird versucht, mit der Funktion <span class="listing">mysql_real_connect()<a id="Xxx999290" name="Xxx999290"></a></span> eine Verbindung zum MySQL-Server herzustellen. Nat&uuml;rlich ist auch klar, dass ohne das Zustandekommen einer Verbindung keine weiteren API-Funktionen verwendet werden k&ouml;nnen (abgesehen von <span class="listing">mysql_get_client_info()</span>). Die Syntax zu dieser Funktion:</p>
<pre>#include &lt;mysql.h&gt;
MYSQL *mysql_real_connect( MYSQL *mysql, const char *host,
                           const char *user, const char *passwd,
                           const char *db, unsigned int port,
                           const char *unix_socket,
                           unsigned int client_flag   );</pre>
<p>Auf den ersten Blick wirkt diese Funktion mit den vielen Parametern recht erschlagend. Aber bei genauerem Hinsehen kann man ein wenig die Parallelen beim Einloggen in der MySQL-Shell (<span class="listing">mysql</span>) erkennen. Der erste Parameter ist die Adresse der MySQL-Struktur, die Sie zuvor mit der Funktion <span class="listing">mysql_init()</span> alloziiert und initialisiert haben.</p>
<p>Mit dem zweiten Parameter k&ouml;nnen Sie den Hostnamen oder eine IP-Adresse zum MySQL-Server angeben. Der Vorteil ist, dass Sie sich selbst hier nicht die M&uuml;he machen m&uuml;ssen, Sockets oder Named Pipes zu erstellen, um sich mit dem Server zu verbinden (zumindest ist dies unter Linux und BSD so). Bei einer Angabe von <span class="listing">NULL</span> oder <span class="listing">localhost</span> wird versucht, sich mit einem UNIX-Socket zu verbinden.</p>
<p>Mit dem dritten Parameter <span class="listing">user</span> geben Sie den User-Namen an, den Sie zur MySQL-Login-Benutzererkennung verwenden. Bei der Angabe von <span class="listing">NULL</span> wird versucht, den aktuellen Benutzer einzuloggen – was unter Linux der aktuelle Login-Name w&auml;re.</p>
<p>Mit <span class="listing">passwd</span> geben Sie das entsprechende Passwort f&uuml;r <span class="listing">user</span> an. Bei einer Angabe von <span class="listing">NULL</span> gilt hier, dass in der <span class="listing">user</span>-Tabelle auf &Uuml;bereinstimmung mit den Benutzern &uuml;berpr&uuml;ft wird, die ein leeres Passwortfeld haben (was aus Sicherheitsgr&uuml;nden allerdings nicht zu empfehlen ist).</p>
<p>Mit <span class="listing">db</span> geben Sie den Namen der Datenbank an, mit der Sie gleich arbeiten wollen. Bei einer Angabe von <span class="listing">NULL</span> wird eine den Vorgaben entsprechende Datenbank f&uuml;r die Verwendung gesetzt. Nat&uuml;rlich k&ouml;nnen Sie auch erst nach der Verbindung eine bestimmte Datenbank zum Arbeiten ausw&auml;hlen.</p>
<p>Wenn Sie f&uuml;r <span class="listing">port</span> nicht 0 angeben, h&auml;ngt dieser Parameter von der Portnummer der TCP/IP-Verbindung des <span class="listing">host</span>-Parameters ab.</p>
<p>Mit dem Parameter <span class="listing">unix_socket</span> k&ouml;nnen Sie einen String angeben, der ein Socket oder eine Namend Pipe festlegt, womit eine Verbindung hergestellt werden soll. Hierbei ist der Verbindungstyp allerdings ebenfalls von dem Parameter <span class="listing">host</span> abh&auml;ngig. Alternativ kann auch hier <span class="listing">NULL</span> angegeben werden.</p>
<p>F&uuml;r den letzten Parameter wird &uuml;blicherweise 0 angegeben. Allerdings lassen sich auch spezielle Optionen einzeln oder auch miteinander kombiniert setzen. Folgende Flags und deren Bedeutung k&ouml;nnen Sie dabei setzen:</p>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CLIENT_COMPRESS</span> – Komprimiertes Protokoll benutzen</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CLIENT_FOUND_ROWS</span> – Die Anzahl &uuml;bereinstimmender Zeilen zur&uuml;ckgeben</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CLIENT_IGNORE_SPACE</span> – Leerzeichen nach Funktionsnamen zulassen. Macht alle Funktionsnamen zu reservierten W&ouml;rtern.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CLIENT_INTERACTIVE</span> – Bei <span class="listing">interactive_timeout</span> Sekunden der Inaktivit&auml;t wird die Verbindung beendet – standardm&auml;&szlig;ig ist das <span class="listing">wait_timeout</span> Sekunden.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CLIENT_NO_SCHEMA</span> – Das Flag ist bei der Fehlersuche einiger Anwendungen hilfreich, die ODBC verwenden. Damit wird die Syntax datenbank.tabelle.spalte verboten.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CLIENT_ODBC</span> – Der Client ist ein ODBC-Client.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CLIENT_SSL</span> – SSL benutzen (verschl&uuml;sseltes Protokoll)</td>
</tr>
</table>
<p>Wenn <span class="listing">mysql_real_connect()</span> ordnungsgem&auml;&szlig; eine Verbindung aufbauen konnte, wird derselbe Zeiger auf die Adresse der MySQL-Struktur zur&uuml;ckgegeben, den Sie als ersten Parameter in der Funktion angegeben haben. Bei einem Fehler wird <span class="listing">NULL</span> zur&uuml;ckgegeben.</p>
<p>Folgende Fehler, die Sie mit der Funktion <span class="listing">mysql_errno()<a id="Xxx999308" name="Xxx999308"></a></span> ermitteln k&ouml;nnten (dazu gleich mehr), k&ouml;nnen bei der Funktion <span class="listing">mysql_real_connect()<a id="Xxx999310" name="Xxx999310"></a></span> auftreten:<a id="Xxx999311" name="Xxx999311"></a></p>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_CONN_HOST_ERROR</span> – Verbindung zum MySQL-Server fehlgeschlagen</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_CONNECTION_ERROR</span> – Verbindung zum lokalen MySQL-Server fehlgeschlagen</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_IPSOCK_ERROR</span> – IP-Socket konnte nicht erzeugt werden.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_OUT_OF_MEMORY</span> – Nicht mehr gen&uuml;gend Speicherplatz vorhanden</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_SOCKET_CREATE_ERROR</span> – UNIX-Socket konnte nicht erzeugt werden.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_UNKNOWN_HOST</span> – IP-Adresse f&uuml;r den Hostnamen konnte nicht gefunden werden.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_VERSION_ERROR</span> – Client und Server verwenden eine unterschiedliche Protokollversion (z. B. Client-Bibliothek ist veraltet).</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_SERVER_LOST</span> – Verbindung zum Server dauerte l&auml;nger als <span class="listing">connect_timeout</span> Sekunden, oder der Server ist w&auml;hrend der Ausf&uuml;hrung von <span class="listing">init-command</span> gestorben.</td>
</tr>
</table>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>Sofern Sie in der Dokumentation von MySQL auf die Funktion <span class="listing">mysql_connect()<a id="Xxx999323" name="Xxx999323"></a></span> gesto&szlig;en sind: Diese ist mittlerweile veraltet und wird nur aus Kompatibilit&auml;tsgr&uuml;nden zu &auml;lteren Programmen erhalten, die diese Funktion verwenden.</p>
</td>
</tr>
</table><br>
<a name="t32"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t33"></a><h3 class="t3">12.5.2 Aufgetretene Fehler ermitteln – mysql_errno() und 
mysql_error<a id="RxxKap12004040004361F03F199" name="RxxKap12004040004361F03F199"></a>() 
      <a href="#t2t34"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t32"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999327" name="Xxx999327"></a>Alleine bei der Funktion <span class="listing">mysql_real_connect()</span> kann eine Menge Fehler auftreten, wie Sie soeben lesen konnten. Da sich in den Headerdateien <span class="listing">&lt;errmsg.h&gt;</span> (Fehlermeldungen vom Client) und <span class="listing">&lt;mysqld_error.h&gt;</span> (Fehlermeldungen vom Server), die sich im selben Verzeichnis befindet wie <span class="listing">&lt;mysql.h&gt;</span>, mehrere hundert Fehlercodes befinden, k&ouml;nnte ein Suchen danach ohne die Funktionen <span class="listing">mysql_errno()<a id="Xxx999329" name="Xxx999329"></a></span> und <span class="listing">mysql_error()<a id="Xxx999330" name="Xxx999330"></a></span> recht schwierig werden. Mit der Funktion</p>
<pre>#include &lt;mysql.h&gt;
unsigned int mysql_errno(MYSQL *mysql) ;</pre>
<p>k&ouml;nnen Sie sich, falls ein Fehler auftrat, entsprechenden Fehlercode der zuletzt aufgerufenen API-Funktion zur&uuml;ckgeben lassen. Wird dabei 0 zur&uuml;ckgegeben, ist kein Fehler aufgetreten, ansonsten wird eben entsprechender Fehlercode vom Client oder vom Server (je nach Auftritt des Fehlers) zur&uuml;ckgegeben.</p>
<p>Die Fehlernummern sind einem h&auml;ufig nicht hilfreich und davon abh&auml;ngig, ob der Anwender wei&szlig;, dass er im Dokumentenverzeichnis der MySQL-Distribution nach der Datei <span class="listing">mysqld_error.txt</span> sehen muss. Zum Gl&uuml;ck gibt es auch f&uuml;r die MySQL C-API eine <span class="listing">perror()</span>-Funktion, die den Fehler im Klartext (zumindest so klar wie m&ouml;glich) ausgibt:</p>
<pre>#include &lt;mysql.h&gt;
const char *mysql_error(MYSQL *mysql) ;</pre>
<p>Hierbei wird bei einer Verbindung eine Fehlermeldung (ein String) der zuletzt fehlgeschlagenen API-Funktion zur&uuml;ckgegeben. Wenn keine Fehlermeldung zur&uuml;ckgegeben wird, dann wird ein leerer String (index[0] = '\0') zur&uuml;ckgegeben. Wollen Sie anstatt der Standardsprache Englisch eine andere ausgeben lassen, m&uuml;ssen Sie entweder die MySQL-Client-Bibliothek nochmals neu kompilieren oder den Server mit <span class="listing">mysqld</span> und der Option –<span class="listing">language=german</span> starten. Was Sie dabei beachten m&uuml;ssen, entnehmen Sie bitte der Dokumentation.</p>
<a name="t33"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t34"></a><h3 class="t3">12.5.3 Schlie&szlig;t die Verbindung zum Server – mysql_close(<a id="RxxKap12004040004361F03F1A0" name="RxxKap12004040004361F03F1A0"></a>) 
      <a href="#t2t35"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t33"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999338" name="Xxx999338"></a>Wenn Sie die mit <span class="listing">mysql_real_connect()</span> eingerichtete Verbindung wieder schlie&szlig;en wollen, dann muss die Funktion <span class="listing">mysql_close()<a id="Xxx999340" name="Xxx999340"></a></span> verwendet werden:</p>
<pre>#include &lt;mysql.h&gt;
void mysql_close(MYSQL *mysql) ;</pre>
<p>Damit schlie&szlig;en Sie die Verbindung mit dem MySQL-Handle und geben auch den Speicher dazu wieder frei, der zuvor mit <span class="listing">mysql_init()</span> alloziiert oder initialisiert wurde.</p>
<a name="t34"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t35"></a><h3 class="t3">12.5.4 Erstes Beispie<a id="RxxKap12004040004361F03F1A4" name="RxxKap12004040004361F03F1A4"></a>l 
      <a href="#t2t36"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t34"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p>Nachdem Sie die grundlegenden Funktionen nun kennen, k&ouml;nnen Sie den ersten Schritt machen, um sich mit Ihrer (Client-)Anwendung dem MySQL-Server zu n&auml;hern. Das Beispiel macht keine gro&szlig;en Aktionen, es versucht lediglich, eine Verbindung mit dem Server einzugehen, wertet ggf. Fehler aus und schlie&szlig;t anschlie&szlig;end diese Verbindung gleich wieder. Bitte passen Sie die Verbindungsdaten f&uuml;r <span class="listing">mysql_real_connect()</span> an Ihrem Account an.</p>
<pre><a id="Xxx999346" name="Xxx999346"></a>/* mysql1.c */
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;mysql.h&gt;
/* Bitte Daten anpassen */
#define HOST     "localhost"
#define USER     "root"
#define PASSWORT "k4p6m3o3"
#define DBNAME   NULL
#define PORT     0
#define SOCKET   NULL
#define FLAG     0
int main (int argc, char **argv) {
  MYSQL *my;
  /* Handle initialisieren */
  my = mysql_init (NULL);
  if (my == NULL) {
    fprintf (stderr, " Initialisierung fehlgeschlagen\n");
    exit (EXIT_FAILURE);
  }
  /* Mit dem Server verbinden */
  if (mysql_real_connect (my,     /* Zeiger auf MySQL-Handler */
                          HOST,     /* Hostname */
                          USER,     /* User-Name */
                          PASSWORT, /* Passwort f&uuml;r user_name */
                          DBNAME,   /* Name der Datenbank */
                          PORT,     /* Port (default=0) */
                          SOCKET,   /* Socket (default=NULL) */
                          FLAG      /* keine Flags */
                         ) == NULL) {
    fprintf (stderr, "Fehler mysql_real_connect():"
             "%u (%s)\n", mysql_errno (my), mysql_error (my));
  } 
  else
      printf ("Erfolgreich mit dem MySQL-Server verbunden\n");
  /* Hier befindet sich der Code f&uuml;r die Arbeit mit MySQL */
  /* Verbindung trennen */
  mysql_close (my);
  return EXIT_SUCCESS;
}</pre>
<p>Das Programm bei der Ausf&uuml;hrung:</p>
<pre>$ gcc -c -I/usr/include/mysql mysql1.c
$ gcc -o mysql1 mysql1.o -L/usr/lib/mysql -lmysqlclient
$ ./mysql1
Fehler mysql_real_connect():2002 (Can't connect to local MySQL server through 
socket '/var/lib/mysql/mysql.sock' (2))
(Hoppala)
$ su
Password: ********
# rcmysql start
Starting service MySQL                                                       done
# exit
exit
$ ./mysql1
Erfolgreich mit dem MySQL-Server verbunden</pre>
<p>Sofern Sie nicht die passenden Angaben f&uuml;r die Funktion <span class="listing">mysql_real_connect()</span> gemacht haben, bekommen Sie die entsprechende Fehlermeldung ausgegeben, was schief gelaufen ist.</p>
<p>Besser ist es nat&uuml;rlich, die Abfrage erst beim Starten des Programms vorzunehmen. Dazu k&ouml;nnen Sie entweder die Kommandozeilenoptionen auswerten (man popt) oder eine entsprechende Abfrage bei der Anwendung machen. Wie eine solche Abfrage aussehen k&ouml;nnte, demonstriert Ihnen folgendes Beispiel:</p>
<pre><a id="Xxx999352" name="Xxx999352"></a>/* mysql2.c */
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;mysql.h&gt;
#define MAX 255
/* Verbindungsdaten f&uuml;r mysql_real_connect */
static char *connect_param[7];
/* globaler Hilfsz&auml;hler f&uuml;r die Verbindungsdaten */
static int connect_param_count = 0;
/* Eigene fgets-Funktion, die \n entfernt */
static void my_fgets( char *ptr, unsigned int max ) {
  char *help;
  fgets(ptr, max, stdin );
  if( ( help = strchr( ptr, '\n') ) != NULL )
    *help = '\0'; /* Newline durch \0 ersetzen */
}
/* Zusammenstellen der Verbindungsdaten in connect_param */
static void my_cat( char *ptr ) {
  connect_param[connect_param_count] = malloc( strlen (ptr) + 1);
  if (connect_param[connect_param_count] == NULL) {
    printf("Konnte keinen Speicher reservieren ...\n");
    exit (EXIT_FAILURE);
  }
  strcpy( connect_param[connect_param_count], ptr );
  connect_param_count++;
}
/* Einlesen der Verbindungsdaten - Ein Dr&uuml;cken von &lt;ENTER&gt; */
/* bezweckt, dass die Standardwerte verwendet werden -     */
/* Garantiert allerdings keinen Verbindungsaufbau.         */
static void get_connect_param( void ) {
  char puffer[MAX];
  printf("Host-Name (&lt;ENTER&gt; == default) : ");
  my_fgets( &amp;puffer[0], MAX );
  if( puffer[0] == '\0' )
    connect_param[connect_param_count++] = NULL;
  else
    my_cat( &amp;puffer[0] );
  printf("User-Name (&lt;ENTER&gt; == default) : ");
  my_fgets( &amp;puffer[0], MAX );
  if( puffer[0] == '\0' )
    connect_param[connect_param_count++] = NULL;
  else
    my_cat( &amp;puffer[0] );
  printf("Passwort (&lt;ENTER&gt; == default)  : ");
  my_fgets( &amp;puffer[0], MAX );
  if( puffer[0] == '\0' )
    connect_param[connect_param_count++] = NULL;
  else
    my_cat( &amp;puffer[0] );
  printf("Datenbank (&lt;ENTER&gt; == default) : ");
  my_fgets( &amp;puffer[0], MAX );
  if( puffer[0] == '\0' )
    connect_param[connect_param_count++] = NULL;
  else
    my_cat( &amp;puffer[0] );
  printf("Port (&lt;ENTER&gt; == default)      : ");
  my_fgets( &amp;puffer[0], MAX );
  if( puffer[0] == '\0' ) {
    puffer[0] = '0';
    my_cat( &amp;puffer[0] );
  } 
  else
    my_cat( &amp;puffer[0] );
  printf("Socket (&lt;ENTER&gt; == default)    : ");
  my_fgets( &amp;puffer[0], MAX );
  if( puffer[0] == '\0' )
    connect_param[connect_param_count++] = NULL;
  else
    my_cat( &amp;puffer[0] );
  printf("Flag (&lt;ENTER&gt; == default)      : ");
  my_fgets( &amp;puffer[0], MAX );
  if( puffer[0] == '\0' ) {
    puffer[0] = '0';
    my_cat( &amp;puffer[0] );
  } 
  else
    my_cat( &amp;puffer[0] );
}
/* Mit dem MySQL-Server und den entsprechenden */
/* Verbindungsdaten eine Verbindung herstellen  */
static int mein_connect( MYSQL *my ) {
  /* Mit dem Server verbinden */
  if( mysql_real_connect (
        my,                     /* Zeiger auf MySQL-Handler*/
        connect_param[0],       /* Hostname*/
        connect_param[1],       /* User-Name*/
        connect_param[2],       /* Passwort f&uuml;r user_name */
        connect_param[3],       /* Name der Datenbank*/
        strtoul(connect_param[4], NULL, 0),/* Port(default=0) */
        connect_param[5],       /* Socket (default=NULL)*/
        strtoul(connect_param[6], NULL, 0)  /* keine Flags */
      )  == NULL) {
    fprintf (stderr, "Fehler mysql_real_connect():"
             "%u (%s)\n",mysql_errno (my), mysql_error (my));
    return -1;
  }
  return 1;
}
/* Speicher freigeben und Verbindung beenden */
static void clean_up_shutdown( MYSQL * my ) {
  free( connect_param );
  mysql_close (my);
}
int main (int argc, char **argv) {
  MYSQL  *my;
  /* Handle initialisieren */
  my = mysql_init(NULL);
  if(my == NULL) {
    fprintf(stderr, " Initialisierung fehlgeschlagen\n");
    exit (EXIT_FAILURE);
  }
  /* Verbindungsdaten f&uuml;r die Datenbank abfragen */
  get_connect_param( );
  /* Mit dem Server verbinden */
  if( mein_connect( my ) != -1 )
    printf("Erfolgreich mit dem MySQL-Server verbunden\n");
  /* Hier befindet sich der Code f&uuml;r die Arbeit mit MySQL */
  /* Verbindung trennen */
  clean_up_shutdown( my );
  return EXIT_SUCCESS;
}</pre>
<p>Das Programm bei der Ausf&uuml;hrung:</p>
<pre>$  gcc -c -I/usr/include/mysql mysql2.c
$  gcc -o mysql2 mysql2.o -L/usr/lib/mysql -lmysqlclient
$ ./mysql2
Hostname (&lt;ENTER&gt; == default)  : localhost
User-Name (&lt;ENTER&gt; == default) : root
Passwort (&lt;ENTER&gt; == default)  : k4p6m3o3
Datenbank (&lt;ENTER&gt; == default) : news
Port (&lt;ENTER&gt; == default)      : ENTER
Socket (&lt;ENTER&gt; == default)    : ENTER
Flag (&lt;ENTER&gt; == default)      : ENTER
Erfolgreich mit dem MySQL-Server verbunden</pre>
<p>Da ja C-Kenntnisse Voraussetzung f&uuml;r das Buch sind, denke ich, dass Sie den Code selbst nachvollziehen k&ouml;nnen. Bez&uuml;glich der MySQL C-API finden Sie hierbei nichts Neues, au&szlig;er dass die Ausf&uuml;hrung des Programms ein wenig modularisiert wurde.</p>
<a name="t35"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t36"></a><h3 class="t3">12.5.5 Verschiedene Informationen ermittel<a id="RxxKap12004040004361F03F1AF" name="RxxKap12004040004361F03F1AF"></a>n 
      <a href="#t2t37"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t35"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999359" name="Xxx999359"></a>Die MySQL C-API bietet auch Funktionen, mit denen Sie diverse Informationen abfragen k&ouml;nnen. Die Funktionen sind alle recht einfach aufgebaut, weshalb die Erkl&auml;rung hierf&uuml;r etwas k&uuml;rzer ausf&auml;llt als gew&ouml;hnlich.</p>
<p>Ben&ouml;tigen Sie die Versionsnummer der Client-Bibliothek, dann ist die folgende Funktion Ihr Fall:<a id="Xxx999362" name="Xxx999362"></a></p>
<pre>#include &lt;mysql.h&gt;
const char *mysql_get_client_info(void) ;</pre>
<p>Diese Funktion gibt eine Adresse zur&uuml;ck, die auf eine Zeichenkette mit der Versionsnummer der Client-Bibliothek verweist.</p>
<p>Ben&ouml;tigen Sie Informationen zur benutzten Verbindung (TCP, UNIX-Socket ...), dann k&ouml;nnen Sie folgende Funktion verwenden:<a id="Xxx999366" name="Xxx999366"></a></p>
<pre>#include &lt;mysql.h&gt;
const char *mysql_get_host_info(MYSQL *mysql) ;</pre>
<p>Die Funktion liefert Ihnen neben dem Typ der benutzten Verbindung auch den Server-Hostnamen zur&uuml;ck. Als Parameter wird ein Zeiger auf die verbundene MySQL-Struktur &uuml;bergeben.</p>
<p>Um die Protokollversion der aktuellen Verbindung zu ermitteln, wird folgende Funktion verwendet:<a id="Xxx999370" name="Xxx999370"></a></p>
<pre>#include &lt;mysql.h&gt;
unsigned int mysql_get_proto_info(MYSQL *mysql) ;</pre>
<p>Als Parameter wird ein Zeiger auf die verbundene MySQL-Struktur &uuml;bergeben. Der R&uuml;ckgabewert (eine vorzeichenlose Ganzzahl) gibt dabei die Protokollversion an.</p>
<p>Um die Versionsnummer des Servers zu ermitteln, steht Ihnen die folgende Funktion zur Verf&uuml;gung:<a id="Xxx999374" name="Xxx999374"></a></p>
<pre>#include &lt;mysql.h&gt;
const char *mysql_get_server_info(MYSQL *mysql) ;</pre>
<p>Dabei wird eine Zeichenkette von der angegebenen Verbindung (MySQL-Struktur), welche die Serverversionsnummer angibt, zur&uuml;ckgegeben.</p>
<p>Informationen &uuml;ber zuletzt ausgef&uuml;hrte Anfragen erhalten Sie mit der Funktion<a id="Xxx999377" name="Xxx999377"></a>:</p>
<pre>#include &lt;mysql.h&gt;
const char *mysql_info(MYSQL *mysql) ;</pre>
<p>Damit wird ein String abgerufen, der einem der folgenden Statements entspricht:</p>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> INSERT</span> <span class="listing">INTO</span> <span class="listing">...</span> <span class="listing">SELECT</span> <span class="listing">...
Zeichenkettenformat: Records: 100 Duplicates: 0 Warnings: 0 </span></td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> INSERT</span> <span class="listing">INTO</span> <span class="listing">...</span> <span class="listing">VALUES</span> <span class="listing">(...),(...),(...)...
Zeichenkettenformat: Records: 3 Duplicates: 0 Warnings: 0 </span></td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> LOAD</span> <span class="listing">DATA</span> <span class="listing">INFILE</span> <span class="listing">...
Zeichenkettenformat: Records: 1 Deleted: 0 Skipped: 0 Warnings: 0 </span></td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> ALTER</span> <span class="listing">TABLE
Zeichenkettenformat: Records: 3 Duplicates: 0 Warnings: 0 </span></td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> UPDATE
Zeichenkettenformat: Rows matched: 40 Changed: 40 Warnings: 0 </span></td>
</tr>
</table>
<p>Bei anderen Statements wird <span class="listing">NULL</span> zur&uuml;ckgegeben. Das Format der Zeichenkette variiert au&szlig;erdem vom Anfragetyp, wie eben gesehen (die Zahlen sind dabei nur Beispiele). Beachten Sie, dass <span class="listing">mysql_info()</span> einen Nicht-<span class="listing">NULL</span>-Wert f&uuml;r das <span class="listing">INSERT</span> <span class="listing">...</span> <span class="listing">VALUES</span>-Statement nur dann zur&uuml;ckgibt, wenn im Statement mehrfache Wertlisten angegeben sind. Wenn keine Anfrageinformationen zur Verf&uuml;gung stehen, gibt diese Funktion <span class="listing">NULL</span> zur&uuml;ck.</p>
<p>Die eben erw&auml;hnten Funktionen sollen anhand eines einfachen Beispiels demonstriert werden.</p>
<pre><a id="Xxx999388" name="Xxx999388"></a>/* mysql3.c */
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;mysql.h&gt;
#define MAX 255
/* Verbindungsdaten f&uuml;r mysql_real_connect */
static char *connect_param[7];
/* globaler Hilfsz&auml;hler f&uuml;r die Verbindungsdaten */
static int connect_param_count = 0;
/*
 *  &Uuml;bernehmen Sie die my_fgets()-, my_cat()-, get_connect_param()-,
 *  mein_connect()-, cleanup_shutdown()-Funktionen von oben
 *  (mysql2.c) -&gt; oder den kompletten Code auf der Buch-CD
 */
int main (int argc, char **argv) {
  MYSQL *my;
  int auswahl;
  /* Handle initialisieren */
  my = mysql_init (NULL);
  if (my == NULL) {
    fprintf (stderr, " Initialisierung fehlgeschlagen\n");
    exit (EXIT_FAILURE);
  }
  /* Verbindungsdaten f&uuml;r die Datenbank abfragen */
  get_connect_param ();
  /* Mit dem Server verbinden */
  if (mein_connect (my) != -1)
    printf ("Erfolgreich mit dem MySQL-Server verbunden\n");
  do {
    printf ("Informationen zum MySQL-Server auf"
            " Ihrem System\n");
    printf ("-----------------------------------"
            "------------\n\n");
    printf ("- 1 - Aktiven Zeichensatz ausgeben \n");
    printf ("- 2 - Versionsnummer des Clients\n");
    printf ("- 3 - Hostinformationen\n");
    printf ("- 4 - Protokollversion\n");
    printf ("- 5 - Versionsnummer des Servers\n");
    printf ("- 6 - Infos &uuml;ber die letzten MySQL-Abfragen\n");
    printf ("- 0 - Beenden\n\n");
    printf ("Ihre Auswahl : ");
    scanf ("%d", &amp;auswahl);
    switch (auswahl) {
    case 1:
      printf ("\nZeichensatz auf Ihrem MySQL-System : %s\n\n",
         mysql_character_set_name (my));
      getchar ();
      break;
    case 2:
      printf ("\nVersionsnummer : %s\n\n",
         mysql_get_client_info ());
      getchar ();
      break;
    case 3:
      printf ("\nInfos zum Host : %s\n\n",
         mysql_get_host_info (my));
      getchar ();
      break;
    case 4:
      printf ("\nProtokollversion : %d\n\n",
         mysql_get_proto_info (my));
      getchar ();
      break;
    case 5:
      printf ("\nVersionsnummer : %s\n\n",
         mysql_get_server_info (my));
      getchar ();
      break;
    case 6:
      printf ("\nDie letzten Aktionen : %s\n\n",
         mysql_info (my));
      getchar ();
      break;
    case 0:
      printf ("Bye\n");
      break;
    default:
      printf ("Fehlerhafte Eingabe\n");
    }
  } while (auswahl != 0);
  /* Verbindung trennen */
  clean_up_shutdown (my);
  return EXIT_SUCCESS;
}</pre>
<a name="t36"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t37"></a><h3 class="t3">12.5.6 Datenbanken, Tabellen und Felder ausgeben (MYSQL_RES<a id="RxxKap12004040004361F03F1C8" name="RxxKap12004040004361F03F1C8"></a>) 
      <a href="#t2t38"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t36"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p>Mit den gleich folgenden API-Funktionen k&ouml;nnen Sie sich die vorhandenen Datenbanken, Tabellen oder Felder mit einer unscharfen Suche ausgeben lassen. Nebenbei werden noch Funktionen der API beschrieben, welche die aktuellen Prozesse auflistet, was sonst von den Aufrufen <span class="listing">mysqladmin</span> <span class="listing">processlist</span> oder <span class="listing">SHOW</span> <span class="listing">PROCESSLIST</span> m&ouml;glich ist.</p>
<p><a id="Xxx999393" name="Xxx999393"></a>Alle gleich hier beschriebenen Funktionen geben einen Datentypen von <span class="listing">MYSQL_RES</span> zur&uuml;ck. Dabei handelt es sich um eine Struktur, die das Ergebnis einer Anfrage repr&auml;sentiert, die Zeilen zur&uuml;ckgibt (<span class="listing">SELECT</span>, <span class="listing">SHOW</span>, <span class="listing">DESCRIBE</span>, <span class="listing">EXPLAIN</span>). Bei der R&uuml;ckgabe spricht man hierbei von einer Ergebnismenge (auch »Resultset« genannt).</p>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>Wenn Sie die Ergebnismenge in <span class="listing">MYSQL_RES</span> nicht mehr ben&ouml;tigen, m&uuml;ssen Sie diese wieder freigeben, um Memory Leaks zu vermeiden. Die Ergebnismenge wird immer mit der Funktion <span class="listing">mysql_free_result()</span> oder (nat&uuml;rlich) bei Beendigung der Anwendung freigegeben.</p>
</td>
</tr>
</table><br>
<h4 class="t4">Datenbanknamen eines Servers – mysql_list_dbs()</h4>
<p><a id="Xxx999400" name="Xxx999400"></a>Um Datenbanknamen abzufragen, wird die folgende Funktion verwendet:<a id="Xxx999401" name="Xxx999401"></a></p>
<pre>#include &lt;mysql.h&gt;
MYSQL_RES *mysql_list_dbs(MYSQL *mysql, const char *wild) ;</pre>
<p>Hiermit bekommen Sie eine Ergebnismenge zum MySQL-Handle <span class="listing">mysql</span> zur&uuml;ck, die aus den Datenbanknamen besteht, die mit dem regul&auml;ren Ausdruck des <span class="listing">wild</span>-Parameters &uuml;bereinstimmen. Dabei d&uuml;rfen Sie f&uuml;r <span class="listing">wild</span> die Platzhalterzeichen '<span class="listing">%</span>' und '<span class="listing">_</span>' verwenden.</p>
<p>Wird hingegen der <span class="listing">NULL</span>-Zeiger f&uuml;r <span class="listing">wild</span> angegeben, werden alle vorhandenen Datenbanken ausgegeben. Wenn ein Fehler auftrat, wird <span class="listing">NULL</span> zur&uuml;ckgegeben. Sie m&uuml;ssen die Ergebnismenge mit <span class="listing">mysql_free_result()<a id="Xxx999406" name="Xxx999406"></a></span> freigeben.</p>
<h4 class="t4">Tabellennamen einer Datenbank – mysql_list_tables()</h4>
<p><a id="Xxx999408" name="Xxx999408"></a>Weiter geht's mit:</p>
<pre>#include &lt;mysql.h&gt;
MYSQL_RES *mysql_list_tables(MYSQL *mysql, const char *wild) ;</pre>
<p>Mit dieser Funktion bekommen Sie als Ergebnismenge Tabellennamen der aktuellen Datenbank zur&uuml;ck, die mit dem regul&auml;ren Ausdruck <span class="listing">wild</span> &uuml;bereinstimmen. Auch hierbei k&ouml;nnen f&uuml;r <span class="listing">wild</span> die Platzhalterzeichen '<span class="listing">%</span>' oder '<span class="listing">_</span>' verwendet werden, und auch hierbei werden bei einer Angabe von <span class="listing">NULL</span> f&uuml;r den Parameter <span class="listing">wild</span> alle Tabellen einer Datenbank aufgelistet. Bei einem Fehler wird <span class="listing">NULL</span> zur&uuml;ckgegeben. Nat&uuml;rlich m&uuml;ssen Sie auch hier die Ergebnismenge mit <span class="listing">mysql_free_result()</span> freigeben.</p>
<h4 class="t4">Feldnamen einer Tabelle – mysql_list_fields()</h4>
<p><a id="Xxx999413" name="Xxx999413"></a>Mit der Funktion</p>
<pre>#include &lt;mysql.h&gt;
MYSQL_RES *mysql_list_fields( MYSQL *mysql, 
                              const char *table,
                              const char *wild );</pre>
<p>wird eine Ergebnismenge zur&uuml;ckgegeben, die aus den Feldnamen in der angegebenen Tabelle bestehen, die auf den regul&auml;ren Ausdruck <span class="listing">wild</span> passen. Auch hierbei k&ouml;nnen Sie als Platzhalterzeichen '<span class="listing">%</span>' oder '<span class="listing">_</span>' angeben. Bei der Verwendung des <span class="listing">NULL</span>-Zeigers f&uuml;r <span class="listing">wild</span> werden alle Feldnamen der Tabelle ausgegeben. Bei einem Fehler liefert auch diese Funktion <span class="listing">NULL</span> zur&uuml;ck. Sie m&uuml;ssen die Ergebnismenge mit <span class="listing">mysql_free_result()<a id="Xxx999417" name="Xxx999417"></a></span> freigeben.</p>
<h4 class="t4">Aktuelle Server-Threads – mysql_list_processes()</h4>
<p><a id="Xxx999419" name="Xxx999419"></a>Mit der n&auml;chsten Funktion<a id="Xxx999420" name="Xxx999420"></a></p>
<pre>#include &lt;mysql.h&gt;
MYSQL_RES *mysql_list_processes(MYSQL *mysql) ;</pre>
<p>k&ouml;nnen Sie die Ergebnismenge der aktuellen Server-Threads zur aktuellen Verbindung des MySQL-Handles ermitteln. Das Ergebnis ist dasselbe wie von <span class="listing">mysqladmin</span> <span class="listing">processlist</span> oder einer <span class="listing">SHOW</span> <span class="listing">PROCESSLIST</span>-Anfrage. Bei einem Fehler wird <span class="listing">NULL</span> zur&uuml;ckgegeben. Auch diese Ergebnismenge m&uuml;ssen Sie mit <span class="listing">mysql_free_result()</span> freigeben.</p>
<p>Die R&uuml;ckgaben der letzten Befehle k&ouml;nnen durch die Benutzerverwaltung von MySQL eingeschr&auml;nkt sein. Wenn Sie sich zum Beispiel alle Datenbanknamen auflisten lassen, bekommen Sie nicht zwangsl&auml;ufig alle Datenbanknamen zur&uuml;ckgeliefert.</p>
<a name="t37"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t38"></a><h3 class="t3">12.5.7 Ergebnismenge zeilenweise bearbeiten (MYSQL_ROW<a id="RxxKap12004040004361F03F1DF" name="RxxKap12004040004361F03F1DF"></a>) 
      <a href="#t2t39"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t37"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999427" name="Xxx999427"></a><a id="Xxx999428" name="Xxx999428"></a><a id="Xxx999429" name="Xxx999429"></a>Wollen Sie eine Ergebnismenge, die sich in der Struktur <span class="listing">MYSQL_RES</span> befindet, nur zeilenweise einlesen oder ausgeben lassen, ben&ouml;tigen Sie auf jeden Fall hierzu den Datentyp oder besser die Struktur <span class="listing">MYSQL_ROW</span>. Dieser Datentyp repr&auml;sentiert eine Zeile von Daten, die als ein Array von gez&auml;hlten Byte-Zeichenketten implementiert ist.</p>
<p>Um einzelne Zeilen (bei einer Datenbank spricht man ja vom Datensatz) aus der Ergebnismenge zu holen, wird folgende Funktion verwendet:<a id="Xxx999432" name="Xxx999432"></a></p>
<pre>#include &lt;mysql.h&gt;
MYSQL_ROW mysql_fetch_row(MYSQL_RES *result) ;</pre>
<p>Damit wird immer der n&auml;chste Datensatz (Zeile) einer Ergebnismenge abgerufen. Als R&uuml;ckgabewert erhalten Sie einen Zeiger auf die Werte einer Zeile, worauf Sie mit <span class="listing">feld[0]</span> bis <span class="listing">feld[n-1]</span> zugreifen k&ouml;nnen. Sind keine Datens&auml;tze mehr einzulesen oder trat ein Fehler auf, wird <span class="listing">NULL</span> zur&uuml;ckgegeben.</p>
<p>Um auf die einzelnen Felder zuzugreifen, haben Sie soeben erfahren, dass dies mit <span class="listing">feld[0]</span> bis <span class="listing">feld[n-1]</span> realisierbar ist. Nur wenn Sie bei einer Datenbank die Tabelle um ein weiteres Feld erweitern, bringt Ihnen der konstante Wert <span class="listing">n</span> f&uuml;r die Anzahl der Felder nichts mehr. Dann ben&ouml;tigen Sie zum Ermitteln der einzelnen Felder, die sich im Datensatz (Zeile) befinden und die Sie soeben mit <span class="listing">mysql_fetch_row()</span> ermittelt haben, die folgende Funktion:<a id="Xxx999436" name="Xxx999436"></a></p>
<pre>#include &lt;mysql.h&gt;
unsigned int mysql_num_fields(MYSQL_RES *result) ;</pre>
<p>Mit dieser Funktion erhalten Sie die Anzahl von Spalten (Felder) der Ergebnismenge, die sich in <span class="listing">MYSQL_RES</span> befindet. Somit k&ouml;nnen Sie jetzt auf die einzelnen Spalten mit <span class="listing">feld[0]</span> bis <span class="listing">feld[mysql_num_fields(result)-1]</span> zugreifen. Somit s&auml;he ein zeilenweises Auslesen eines Datensatzes wie folgt aus:</p>
<pre>MYSQL_RES *res;
MYSQL_ROW row;
/* Datensatz einlesen */
while ((row = mysql_fetch_row (res)) != NULL)
{ /* Anzahl der Spalten ermitteln und Feld f&uuml;r Feld ausgeben */
   for (i = 0; i &lt; mysql_num_fields (res); i++)
      printf ("%s | ", row[i]);
    printf ("\n");
}</pre>
<p>Ben&ouml;tigen Sie jetzt auch noch die L&auml;nge der Feldwerte in der Zeile, dann k&ouml;nnen Sie diese mit der Funktion <span class="listing">mysql_fetch_lengths()</span> bestimmen. Mehr dazu sp&auml;ter.</p>
<p>Wollen Sie hingegen die Anzahl der Datens&auml;tze (Zeilen) ermitteln, die sich in der Ergebnismenge befinden, so k&ouml;nnen Sie auf die Funktion <span class="listing">mysql_num_rows()</span> zur&uuml;ckgreifen:<a id="Xxx999442" name="Xxx999442"></a></p>
<pre>#include &lt;mysql.h&gt;
my_ulonglong mysql_num_rows(MYSQL_RES *result) ;</pre>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>Die Dokumentation der MySQL API empfiehlt aus Portabilit&auml;tsgr&uuml;nden des Typs <span class="listing">my_ulonglong<a id="Xxx999447" name="Xxx999447"></a></span>, den R&uuml;ckgabewert mit <span class="listing">unsigned</span> <span class="listing">long</span> zu casten! Dieser Typ stellt einen Bereich von 0 bis 1.84e19 zur Verf&uuml;gung. Auf manchen »Systemen« funktioniert der Versuch, einen Wert des Typs <span class="listing">my_ulonglong</span> auszugeben, nicht – was allerdings mehr ein Problem des Compilers statt des Systems ist.</p>
</td>
</tr>
</table><br>
<h4 class="t4">Platzieren und Abfragen eines Zeilencursors – MYSQL_ROW_OFFSET</h4>
<p><a id="Xxx999450" name="Xxx999450"></a><a id="Xxx999451" name="Xxx999451"></a><span class="listing">MYSQL_ROW_OFFSET</span> ist eine typensichere Repr&auml;sentation eines Offsets f&uuml;r einen Zeilencursor. Das Offset sollte ein Wert sein, der von einem Aufruf von <span class="listing">mysql_row_tell()</span> oder <span class="listing">mysql_row_seek()</span> zur&uuml;ckgegeben wird. Dieser Wert ist nicht einfach eine Zeilennummer.</p>
<p>Den Zeilencursor k&ouml;nnen Sie mit der folgenden Funktion verschieben:<a id="Xxx999453" name="Xxx999453"></a></p>
<pre>#include &lt;mysql.h&gt;
MYSQL_ROW_OFFSET mysql_row_seek( MYSQL_RES *ergebnis,
                                 MYSQL_ROW_OFFSET offset ) ;</pre>
<p>Damit setzen Sie den Zeilencursor auf eine beliebige Zeile in der Anfrage-Ergebnismenge. Zur&uuml;ckgegeben wird der vorherige Wert des Zeilencursors. Diesen Wert k&ouml;nnen Sie wiederum bei einer sp&auml;teren Verwendung von <span class="listing">mysql_row_seek()</span> als zweiten Parameter &uuml;bergeben.</p>
<p><a id="Xxx999457" name="Xxx999457"></a>Wollen Sie hingegen die aktuelle Position des Zeilencursors ermitteln, so steht Ihnen die folgende Funktion zur Verf&uuml;gung:<a id="Xxx999459" name="Xxx999459"></a></p>
<pre>#include &lt;mysql.h&gt;
MYSQL_ROW_OFFSET mysql_row_tell(MYSQL_RES *ergebnis) ;</pre>
<p>Mit <span class="listing">mysql_row_tell()</span> erhalten Sie die aktuelle Position des letzten <span class="listing">mysql_fetch_row()</span>-Aufrufs zur&uuml;ck. Den R&uuml;ckgabewert k&ouml;nnen Sie auch hier f&uuml;r eine sp&auml;tere Verwendung von <span class="listing">mysql_row_seek()</span> als zweiten Parameter verwenden. Als R&uuml;ckgabewert erhalten Sie hierbei die aktuelle Position des Zeilencursors.</p>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>Da <span class="listing">mysql_row_tell()</span> und <span class="listing">mysql_row_seek()</span> als Parameter eine Ergebnismenge der Struktur <span class="listing">MYSQL_RES</span> ben&ouml;tigen, k&ouml;nnen Sie diese Funktionen nur nach einem <span class="listing">mysql_store_result()</span> und nicht nach einem <span class="listing">mysql_use_result()</span> verwenden. Mehr dazu sp&auml;ter.</p>
</td>
</tr>
</table><br>
<a name="t38"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t39"></a><h3 class="t3">12.5.8 Ergebnismenge spaltenweise einlesen (und ausgeben) (MYSQL_FIELD<a id="RxxKap12004040004361F03F1F7" name="RxxKap12004040004361F03F1F7"></a>) 
      <a href="#t2t310"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t38"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999468" name="Xxx999468"></a><a id="Xxx999469" name="Xxx999469"></a>Sie werden es sicherlich erahnen, wenn es eine Struktur f&uuml;r die Verbindung zur Datenbank (<span class="listing">MYSQL</span>), eine f&uuml;r die Ergebnismenge (<span class="listing">MYSQL_RES</span>) und eine f&uuml;r die Zeile/den Datensatz (<span class="listing">MYSQL_ROW</span>) gibt, dann ist das n&auml;chstkleinste Glied in der Kette das Feld. Daf&uuml;r steht Ihnen die Struktur <span class="listing">MYSQL_FIELD</span> zur Verf&uuml;gung. Diese Struktur beinhaltet Informationen zu einem Feld wie den Namen, den Feldtyp und die Feldgr&ouml;&szlig;e. Sie erhalten solch eine <span class="listing">MYSQL_FIELD</span>-Struktur f&uuml;r jedes Feld durch einen wiederholten Aufruf von <span class="listing">mysql_fetch_field()</span>. Um Missverst&auml;ndnisse zu vermeiden, Feldwerte sind nicht Teil der <span class="listing">MYSQL_FIELD</span>-Struktur. Die Werte selbst sind in der zuvor beschriebenen Struktur <span class="listing">MYSQL_ROW</span> enthalten.</p>
<p>Die Elemente der Struktur <span class="listing">MYSQL_FIELD</span> sind im Folgenden erkl&auml;rt.</p>
<h4 class="t4">MYSQL_FIELD – Struktur</h4>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> char</span> <span class="listing">*name</span> – Name des Feldes als terminierte Zeichenkette</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> char</span> <span class="listing">*table</span> – Name der Tabelle, die das Feld enth&auml;lt, sofern es sich nicht um ein berechnetes Feld handelt – bei berechneten Feldern findet sich hier eine leere Zeichenkette.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> char</span> <span class="listing">*def</span> – Vorgabewert des Feldes als terminierte Zeichenkette. Wird nur gesetzt, wenn Sie die Funktion <span class="listing">mysql_list_fields()</span> verwenden.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> enum</span> <span class="listing">enum_field_types</span> – Der Typ des Feldes, der folgende Werte haben kann:</td>
</tr>
</table>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<caption class="tabunter">
<p><span class="tabunter"><b>Tabelle 12.6   
    </b>Typ des Feldes in enum enum_field_types</span></p>
</caption>
<tr>
<td class="tabellenkopf" bgcolor="#000000"><b>Wert</b>
</td>
<td class="tabellenkopf" bgcolor="#000000"><b>Bedeutung</b>
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_TINY
</td>
<td class="tabellentext" bgcolor="#000000">TINYINT-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_SHORT
</td>
<td class="tabellentext" bgcolor="#000000">SMALLINT-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_LONG 
</td>
<td class="tabellentext" bgcolor="#000000">INTEGER-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_INT24
</td>
<td class="tabellentext" bgcolor="#000000">MEDIUMINT-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_LONGLONG
</td>
<td class="tabellentext" bgcolor="#000000">BIGINT-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_DECIMAL
</td>
<td class="tabellentext" bgcolor="#000000">DECIMAL- oder NUMERIC-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_FLOAT
</td>
<td class="tabellentext" bgcolor="#000000">FLOAT-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_DOUBLE
</td>
<td class="tabellentext" bgcolor="#000000">DOUBLE- oder REAL-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_TIMESTAMP
</td>
<td class="tabellentext" bgcolor="#000000">TIMESTAMP-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_DATE
</td>
<td class="tabellentext" bgcolor="#000000">DATE-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_TIME
</td>
<td class="tabellentext" bgcolor="#000000">TIME-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_DATETIME
</td>
<td class="tabellentext" bgcolor="#000000">DATETIME-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_YEAR
</td>
<td class="tabellentext" bgcolor="#000000">YEAR-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_STRING
</td>
<td class="tabellentext" bgcolor="#000000">CHAR- oder VARCHAR-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_BLOB
</td>
<td class="tabellentext" bgcolor="#000000">BLOB- oder TEXT-Feld (benutzen Sie max_length, um die maximale L&auml;nge festzulegen)
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_SET
</td>
<td class="tabellentext" bgcolor="#000000">SET-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_ENUM
</td>
<td class="tabellentext" bgcolor="#000000">ENUM-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_NULL
</td>
<td class="tabellentext" bgcolor="#000000">NULL-Feld
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">FIELD_TYPE_CHAR
</td>
<td class="tabellentext" bgcolor="#000000">veraltet; benutzen Sie stattdessen FIELD_TYPE_TINY
</td>
</tr>
</table><br>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16">
             
        </td>
<td valign="top" width="100%" align="left">Au&szlig;erdem k&ouml;nnen Sie das Makro <span class="listing">IS_NUM()</span> verwenden, um zu testen, ob ein Feld einem nummerischen Typ entspricht oder nicht. Beispiel einer solchen Anwendung:</td>
</tr>
<tr>
<td valign="baseline" width="16">
                 
            </td>
<td valign="top" width="100%" align="left">
                 
            </td>
</tr>
</table>
if (IS_NUM(field-&gt;type))
    printf("Feld ist nummerisch\n");
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> unsigned</span> <span class="listing">int</span> <span class="listing">length</span> – Gibt die Breite des Feldes an, die in der Tabellendefinition festgelegt wurde.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> unsigned</span> <span class="listing">int</span> <span class="listing">max_length</span> – Gibt die maximale Breite des Feldes f&uuml;r die Ergebnismenge (die L&auml;nge des l&auml;ngsten Feldwertes f&uuml;r die Zeilen, die tats&auml;chlich in der Ergebnismenge enthalten sind) an. Wenn Sie <span class="listing">mysql_store_result()</span> oder <span class="listing">mysql_list_fields()</span> benutzen, enth&auml;lt die Variable die maximale L&auml;nge f&uuml;r das Feld. Wenn Sie <span class="listing">mysql_use_result()</span> benutzen, ist sie 0.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> unsigned</span> <span class="listing">int</span> <span class="listing">flags</span> – Hier finden Sie die verschiedenen Flags. Wenn dieser Wert nicht 0 ist, dann ist mindestens eines der folgenden Bits gesetzt:</td>
</tr>
</table>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<caption class="tabunter">
<p><span class="tabunter"><b>Tabelle 12.7   
    </b>Spezielle Feldattribute f&uuml;r die Strukturvariable flags</span></p>
</caption>
<tr>
<td class="tabellenkopf" bgcolor="#000000"><b>Flag</b>
</td>
<td class="tabellenkopf" bgcolor="#000000"><b>Bedeutung</b>
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">NOT_NULL_FLAG
</td>
<td class="tabellentext" bgcolor="#000000">Feld darf nicht NULL sein.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">PRI_KEY_FLAG
</td>
<td class="tabellentext" bgcolor="#000000">Feld ist Teil eines Prim&auml;rschl&uuml;ssels.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">UNIQUE_KEY_FLAG
</td>
<td class="tabellentext" bgcolor="#000000">Feld ist Teil eines eindeutigen Schl&uuml;ssels.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">MULTIPLE_KEY_FLAG
</td>
<td class="tabellentext" bgcolor="#000000">Feld ist Teil eines nicht eindeutigen Schl&uuml;ssels.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">UNSIGNED_FLAG
</td>
<td class="tabellentext" bgcolor="#000000">Feld hat das UNSIGNED-Attribut.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">BINARY_FLAG
</td>
<td class="tabellentext" bgcolor="#000000">Feld hat das BINARY-Attribut.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">AUTO_INCREMENT_FLAG
</td>
<td class="tabellentext" bgcolor="#000000">Feld hat das AUTO_INCREMENT-Attribut.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">ENUM_FLAG
</td>
<td class="tabellentext" bgcolor="#000000">Feld ist ein ENUM (veraltet).
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">BLOB_FLAG
</td>
<td class="tabellentext" bgcolor="#000000">Feld ist ein BLOB oder TEXT (veraltet).
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">TIMESTAMP_FLAG
</td>
<td class="tabellentext" bgcolor="#000000">Feld ist ein TIMESTAMP (veraltet).
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">ZEROFILL_FLAG
</td>
<td class="tabellentext" bgcolor="#000000">Feld hat das ZEROFILL-Attribut.
</td>
</tr>
</table><br>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16">
             
        </td>
<td valign="top" width="100%" align="left">Sie k&ouml;nnen diese Flags auch mit den folgenden Makros testen, um einen flag-Wert zu bestimmen:</td>
</tr>
<tr>
<td valign="baseline" width="16">
                 
            </td>
<td valign="top" width="100%" align="left">
                 
            </td>
</tr>
</table>
<span class="listing"> IS_NOT_NULL(flags)</span> – WAHR, wenn der Feldwert als <span class="listing">NOT NULL</span> definiert ist.
<span class="listing"> IS_PRI_KEY(flags)</span> – WAHR, wenn der Feldwert ein Prim&auml;rschl&uuml;ssel ist.
<span class="listing"> IS_BLOB(flags)</span> – (veraltet; testen Sie stattdessen <span class="listing">field-&gt;type</span>)
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> unsigned</span> <span class="listing">int</span> <span class="listing">decimals</span> – Die Anzahl von Dezimalstellen f&uuml;r nummerische Felder</td>
</tr>
</table>
<p>Um die Definition einer Spalte aus der Ergebnismenge zu holen, kann die Funktion<a id="Xxx999633" name="Xxx999633"></a></p>
<pre>#include &lt;mysql.h&gt;
MYSQL_FIELD *mysql_fetch_field(MYSQL_RES *result) ;</pre>
<p>verwendet werden. Damit Sie die Informationen zu allen Spalten erhalten, m&uuml;ssen Sie diese Funktion mehrmals aufrufen. Bei einem Fehler gibt diese Funktion <span class="listing">NULL</span> zur&uuml;ck. <span class="listing">NULL</span> wird auch zur&uuml;ckgegeben, wenn keine weiteren Felder mehr vorhanden sind. Ein Beispiel der Anwendung:</p>
<pre>MYSQL_FIELD *field;
while((field = mysql_fetch_field(ergebnis))) {
    printf("Feldname %s\n", field-&gt;name);
}</pre>
<p>Wollen Sie ein Array aller <span class="listing">MYSQL_FIELD</span>-Strukturen f&uuml;r eine Ergebnismenge auf einmal ermitteln, so k&ouml;nnen Sie die folgende Funktion verwenden:<a id="Xxx999639" name="Xxx999639"></a></p>
<pre>#include &lt;mysql.h&gt;
MYSQL_FIELD *mysql_fetch_fields(MYSQL_RES *result) ;</pre>
<p>Jede Struktur stellt hierbei Felddefinitionen f&uuml;r eine Spalte der Ergebnismenge zur Verf&uuml;gung. Beispiel einer solchen Verwendung:</p>
<pre>unsigned int num_fields;
unsigned int i;
MYSQL_FIELD *fields;
/* Anzahl der Felder ermitteln */
num_fields = mysql_num_fields(ergebnis);
fields = mysql_fetch_fields(ergebnis);
for(i = 0; i &lt; num_fields; i++) {
   printf("Feld %u ist %s\n", i, fields[i].name);
}</pre>
<p>Wollen Sie innerhalb einer Ergebnismenge eine bestimmte Spalte direkt abrufen, dann steht Ihnen die folgende Funktion zur Verf&uuml;gung:<a id="Xxx999644" name="Xxx999644"></a></p>
<pre>#include &lt;mysql.h&gt;
MYSQL_FIELD *mysql_fetch_field_direct( MYSQL_RES *result, 
                                       unsigned int feldnr ) ;</pre>
<p>Mit der Angabe einer Feldnummer <span class="listing">feldnr</span> f&uuml;r eine Spalte innerhalb einer Ergebnismenge gibt diese Funktion die Felddefinition dieser Spalte als <span class="listing">MYSQL_FIELD</span>-Struktur zur&uuml;ck. Sie k&ouml;nnen diese Funktion verwenden, um die Definition f&uuml;r eine beliebige Spalte abzurufen. Der Wert von <span class="listing">feldnr</span> sollte im Bereich von 0 bis <span class="listing">mysql_num_fields(ergebnis)-1</span> liegen. Beispiel einer solchen Aktion:</p>
<pre>unsigned int num_fields;
unsigned int i;
MYSQL_FIELD *field;
num_fields = mysql_num_fields(ergebnis);
for(i = 0; i &lt; num_fields; i++) {
    field = mysql_fetch_field_direct(ergebnis, i);
    printf("Feld %u ist %s\n", i, field-&gt;name);
}</pre>
<p><a id="Xxx999648" name="Xxx999648"></a>Wie bei der Ergebnismenge von Zeilen mit dem Zeilencursor kann auch bei den Spalten der Feldcursor abgefragt und versetzt werden. Hierf&uuml;r wird der Datentyp <span class="listing">MYSQL_FIELD_OFFSET</span> ben&ouml;tigt. Das ist eine typsichere Repr&auml;sentation eines Offsets in einer MySQL-Feldliste (benutzt von <span class="listing">mysql_field_seek()</span>). Offsets sind Feldnummern innerhalb einer Zeile, beginnend mit 0.</p>
<p>Um einen Feldcursor zu versetzen, kann die Funktion<a id="Xxx999650" name="Xxx999650"></a><a id="Xxx999651" name="Xxx999651"></a></p>
<pre>#include &lt;mysql.h&gt;
MYSQL_FIELD_OFFSET mysql_field_seek(MYSQL_RES *result, 
                                    MYSQL_FIELD_OFFSET offset) ;</pre>
<p>verwendet werden. Damit wird der Feldcursor auf das angegebene Offset des zweiten Parameters gesetzt. Folgt anschlie&szlig;end ein Aufruf von <span class="listing">mysql_fetch_field()</span>, wird die Felddefinition der Spalte aufgerufen, die mit diesem Offset verkn&uuml;pft ist. Wollen Sie (wieder) an den Anfang der Zeile springen, k&ouml;nnen Sie den <span class="listing">offset</span>-Wert 0 angeben.</p>
<p>Um die aktuelle Position des Feldcursors zu ermitteln, kann die Funktion <span class="listing">mysql_field_tell()</span> verwendet werden:<a id="Xxx999656" name="Xxx999656"></a><a id="Xxx999657" name="Xxx999657"></a></p>
<pre>#include &lt;mysql.h&gt;
MYSQL_FIELD_OFFSET mysql_field_tell(MYSQL_RES *result) ;</pre>
<p>Den R&uuml;ckgabewert von der aktuellen Position des Feldcursors k&ouml;nnen Sie anschlie&szlig;end auch wieder f&uuml;r die Funktion <span class="listing">mysql_field_seek()</span> verwenden.</p>
<p>Ben&ouml;tigen Sie die Anzahl der Spalten, die f&uuml;r die letzte Anfrage zu einer Verbindung (Achtung! Nicht Ergebnismenge!) gestellt wurde, dann k&ouml;nnen Sie die folgende Funktion verwenden:<a id="Xxx999661" name="Xxx999661"></a></p>
<pre>#include &lt;mysql.h&gt;
unsigned int mysql_field_count(MYSQL *mysql) ;</pre>
<p>Gew&ouml;hnlich wird diese Funktion benutzt, wenn <span class="listing">mysql_store_result()<a id="Xxx999663" name="Xxx999663"></a></span> <span class="listing">NULL</span> zur&uuml;ckgab (und Sie somit keinen Ergebnismengen-Zeiger haben). In diesem Fall k&ouml;nnen Sie <span class="listing">mysql_field_count()</span> aufrufen, um festzustellen, ob <span class="listing">mysql_store_result()</span> ein leeres Ergebnis h&auml;tte zur&uuml;ckgeben sollen oder nicht. Dies erm&ouml;glicht es Ihnen, die richtigen Entscheidungen zu treffen, ohne dass Sie wissen m&uuml;ssen, ob es sich bei der Anfrage um ein <span class="listing">SELECT</span> handelte oder nicht.</p>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>Die Funktion ist erst bei der MySQL-Version 3.2.24 eingef&uuml;hrt worden. Daher sollten Sie bei einer &auml;lteren Version die Funktion <span class="listing">mysql_num_fields()<a id="Xxx999668" name="Xxx999668"></a></span> stattdessen verwenden (oder noch besser, schnellstens ein Update machen).</p>
</td>
</tr>
</table><br>
<a name="t39"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t310"></a><h3 class="t3">12.5.9 Ein Beispie<a id="RxxKap12004040004361F03F267" name="RxxKap12004040004361F03F267"></a>l 
      <a href="#t2t311"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t39"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p>Bevor Sie auf den n&auml;chsten Seiten weitere API-Funktionen zu MySQL kennen lernen, folgt hierzu wieder ein Beispiel, das einige der Funktionen, &uuml;ber die Sie auf den Seiten zuvor etwas gelesen haben, in der Praxis demonstriert. Mit dem Listing k&ouml;nnen Sie alle vorhandenen Datenbanken, alle Tabellen einer Datenbank und alle Spalten einer Tabelle auflisten lassen. Au&szlig;erdem k&ouml;nnen Sie alle vorhandenen Prozesse auflisten lassen – einfach alles, was eben in der (etwas langatmigen) Theorie beschrieben wurde.</p>
<pre><a id="Xxx999673" name="Xxx999673"></a>/* mysql4.c */
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;mysql.h&gt;
#define MAX 255
/* Verbindungsdaten f&uuml;r mysql_real_connect */
static char *connect_param[7];
/* globaler Hilfsz&auml;hler f&uuml;r die Verbindungsdaten */
static int connect_param_count = 0;
static void print_line (MYSQL_RES * res);
/*
 *  &Uuml;bernehmen Sie die my_fgets()-, my_cat()-, get_connect_param()-,
 *  mein_connect()-, cleanup_shutdown()-Funktionen von oben
 *  (mysql2.c) -&gt; oder den kompletten Code auf der Buch-CD
 */
/* Listet alle vorhandenen Datenbanken auf */
static void list_DB (MYSQL * my) {
  MYSQL_RES *res;
  MYSQL_ROW row;
  int zeilen;
  unsigned int i;
  res = mysql_list_dbs (my, NULL);
  zeilen = (unsigned long) mysql_num_rows (res);
  printf ("Datenbanken gefunden : %d\n", zeilen);
  while ((row = mysql_fetch_row (res)) != NULL)
    /* mysql_num_flields() w&auml;re hier  nicht n&ouml;tig */
    for (i = 0; i &lt; mysql_num_fields (res); i++)
      printf ("%s\n", row[i]);
  mysql_free_result (res);
  getchar ();
}
/* Listet alle Tabellen einer Datenbank auf */
static void list_table_DB (MYSQL * my) {
  MYSQL_RES *res;
  MYSQL_ROW row;
  int zeilen;
  unsigned int i;
  res = mysql_list_tables (my, NULL);
  if (res == NULL) {
    fprintf (stderr, "Fehler bei mysql_list_tables():"
             "%u (%s)\n", mysql_errno (my), mysql_error (my));
    return;
  }
  zeilen = (unsigned long) mysql_num_rows (res);
  printf ("Tabellen in der Datenbank : %d\n", zeilen);
  while ((row = mysql_fetch_row (res)) != NULL) {
    for (i = 0; i &lt; mysql_num_fields (res); i++)
      printf ("%s", row[i]);
    printf ("\n");
  }
  mysql_free_result (res);
  getchar ();
}
/* Listet alle Felder einer Tabelle auf */
static void list_fields_DB (MYSQL * my) {
  unsigned int i, col_len;
  MYSQL_RES *res;
  MYSQL_FIELD *field;
  char buffer[MAX];
  printf ("Bitte eine Tabelle ausw&auml;hlen: ");
  my_fgets (buffer, MAX);
  res = mysql_list_fields (my, buffer, NULL);
  if (res == NULL) {
    fprintf (stderr, "Fehler bei mysql_list_tables():"
             "%u (%s)\n", mysql_errno (my), mysql_error (my));
    return;
  }
  /* offset = 0 bedeutet, auf den Anfang der Zeile setzen */
  mysql_field_seek (res, 0);
  /* Damit bei der Ausgabe ein einheitliches Bild entsteht,
   * sollen die Daten f&uuml;r die max. L&auml;nge einer Spalte bei jeder
   * einzelnen (MYSQL_FIELD)-Spalte ver&auml;ndert werden   */
  for (i = 0; i &lt; mysql_num_fields (res); i++) {
     field = mysql_fetch_field (res);
     /* L&auml;nge des Namens in der Spalte ermitteln */
     col_len = strlen (field-&gt;name);
     /* Ist die L&auml;nge des Elements in der Spalte kleiner als
      * die max. L&auml;nge ... */
     if (col_len &lt; field-&gt;max_length)
        /* ... dann bekommt col_len den Wert der max. erl. L&auml;nge
         * der Spalte */
        col_len = field-&gt;max_length;
     /* F&uuml;r den Fall, dass eine Spalte keine Daten
      * beinhaltet ... */
     if (col_len &lt; 4 &amp;&amp; !IS_NOT_NULL (field-&gt;flags))
        /* col_len bekommt den Wert 4 f&uuml;r den String
         * "NULL" -&gt;keine Daten */
        col_len = 4;
     /* max. L&auml;nge von Spalten-Info ver&auml;ndern */
     field-&gt;max_length = col_len;
  }
  /* Namen der Tabelle ausgeben */
  printf ("Daten der Tabelle: [ %s ]\n", field-&gt;table);
  printf("Mit mysql_fetch_field()\n");
  /* Demonstriert mysql_fetch_field() */
  print_line (res);
  printf ("|");
  /* Alles wieder auf den Anfang stellen */
  mysql_field_seek (res, 0);
  /* Jetzt den Tabellenkopf ausgeben  */
  for (i = 0; i &lt; mysql_num_fields (res); i++) {
     field = mysql_fetch_field (res);
     printf (" %-*s |", field-&gt;max_length, field-&gt;name);
  }
  printf ("\n");
  print_line (res);
  printf("Gleiches mit mysql_fetch_fields()\n");
  /* Dasselbe nochmals mit mysql_fetch_fields() */
  print_line (res);
  printf ("|");
  /* Alles wieder auf den Anfang stellen */
  mysql_field_seek (res, 0);
  field = mysql_fetch_fields (res);
  for (i = 0; i &lt; mysql_num_fields (res); i++) {
     printf (" %-*s |", field[i].max_length, field[i].name);
  }
  printf ("\n");
  print_line (res);
  mysql_free_result (res);
}
static void print_line (MYSQL_RES * res) {
  MYSQL_FIELD *field;
  unsigned int i, j;
  mysql_field_seek (res, 0);
  /* Erstes Zeichen der Linie */
  printf ("+");
  for (i = 0; i &lt; mysql_num_fields (res); i++) {
     field = mysql_fetch_field (res);
     /* max_length '-' Zeichen jeder Spalte ausgeben */
     for (j = 0; j &lt; field-&gt;max_length + 2; j++)
        printf ("-");
     /* Am Ende der Spalte '+' ausgeben */
     printf ("+");
  }
  printf ("\n");
}
/* Listet alle vorhandenen Prozesse auf */
static void list_process (MYSQL * my) {
  MYSQL_RES *res;
  MYSQL_ROW row;
  int zeilen;
  unsigned int i, col_len;
  MYSQL_FIELD *field;
  res = mysql_list_processes (my);
  zeilen = (unsigned long) mysql_num_rows (res);
  printf ("Prozesse gefunden : %d\n", zeilen);
  /* offset = 0 bedeutet, auf den Anfang der Zeile setzen */
  mysql_field_seek (res, 0);
  /* Damit bei der Ausgabe ein einheitliches Bild entsteht,
   * sollen die Daten f&uuml;r die max. L&auml;nge einer Spalte bei jeder
   * einzelnen (MYSQL_FIELD)-Spalte ver&auml;ndert werden */
  for (i = 0; i &lt; mysql_num_fields (res); i++) {
     field = mysql_fetch_field (res);
     /* L&auml;nge des Namens in der Spalte ermitteln */
     col_len = strlen (field-&gt;name);
     /* Ist die L&auml;nge des Elements in der Spalte kleiner als
      * die max. L&auml;nge ... */
     if (col_len &lt; field-&gt;max_length)
        /* ... dann bekommt col_len den Wert der max. erl. L&auml;nge
         * der Spalte */
        col_len = field-&gt;max_length;
     /* F&uuml;r den Fall, dass eine Spalte keine Daten
      * beinhaltet ... */
     if (col_len &lt; 4 &amp;&amp; !IS_NOT_NULL (field-&gt;flags))
        /* col_len bekommt den Wert 4 f&uuml;r den String
         * "NULL" -&gt;kein Daten */
        col_len = 4;
     /* max. L&auml;nge von Spalten-Info ver&auml;ndern */
     field-&gt;max_length = col_len;
  }
  print_line (res);
  printf ("|");
  /* Alles wieder auf den Anfang stellen */
  mysql_field_seek (res, 0);
  /* Jetzt den Tabellenkopf ausgeben (titel, hauptrolle, fsk,
   * gedreht) */
  for (i = 0; i &lt; mysql_num_fields (res); i++) {
      field = mysql_fetch_field (res);
      printf (" %-*s |", field-&gt;max_length, field-&gt;name);
  }
  printf ("\n");
  print_line (res);
  mysql_field_seek (res, 0);
  while ((row = mysql_fetch_row (res)) != NULL) {
     printf ("|");
     for (i = 0; i &lt; mysql_num_fields (res); i++) {
        field = mysql_fetch_field (res);
        printf (" %-*s |",field-&gt;max_length, row[i]);
     }
     printf ("\n");
     mysql_field_seek (res, 0);
  }
  print_line (res);
  mysql_free_result (res);
}
int main (int argc, char *argv[]) {
  MYSQL *my;
  int auswahl;
  /* Handle initialisieren */
  my = mysql_init (NULL);
  if (my == NULL) {
    fprintf (stderr, " Initialisierung fehlgeschlagen\n");
    exit (EXIT_FAILURE);
  }
  /* Verbindungsdaten f&uuml;r die Datenbank abfragen */
  get_connect_param ();
  /* Mit dem Server verbinden */
  if (mein_connect (my) != -1)
    printf ("Erfolgreich mit dem MySQL-Server verbunden\n");
  do {
    printf ("\nInformationen zu den Datenbanken auf dem"
            " MySQL-Server\n\n");
    printf ("- 1 - Alle vorhandenen Datenbanken ausgeben \n");
    printf ("- 2 - Tabellen einer Datenbank auflisten\n");
    printf (" -3 - Spalten der Tabelle auflisten\n");
    printf ("- 4 - Prozessliste anzeigen\n");
    printf ("- 0 - Beenden\n\n");
    printf ("Ihre Auswahl : ");
    scanf ("%d", &amp;auswahl);
    switch (auswahl) {
    case 1:
      list_DB (my);
      getchar ();
      break;
    case 2:
      getchar ();
      list_table_DB (my);
      break;
    case 3:
      getchar ();
      list_fields_DB (my);
      break;
    case 4:
      getchar ();
      list_process (my);
      break;
    case 0:
      printf ("Bye\n");
      break;
    default:
      printf ("Fehlerhafte Eingabe\n");
    }
  } while (auswahl != 0);
  /* Verbindung trennen */
  clean_up_shutdown (my);
  return EXIT_SUCCESS;
}</pre>
<p>Das Programm bei der Ausf&uuml;hrung:</p>
<pre>$  gcc -c -I/usr/include/mysql mysql4.c
$  gcc -o mysql4 mysql4.o -L/usr/lib/mysql -lmysqlclient
$ ./mysq4
Hostname (&lt;ENTER&gt; == default) : localhost
User-Name (&lt;ENTER&gt; == default) : root
Passwort (&lt;ENTER&gt; == default)  : k4p6m3o3
Datenbank (&lt;ENTER&gt; == default) : adressen
Port (&lt;ENTER&gt; == default)      : ENTER
Socket (&lt;ENTER&gt; == default)    : ENTER
Flag (&lt;ENTER&gt; == default)      : ENTER
Erfolgreich mit dem MySQL-Server verbunden
Informationen zu den Datenbanken auf dem MySQL-Server
-----------------------------------------------
- 1 - Alle vorhandenen Datenbanken ausgeben
- 2 - Tabellen einer Datenbank auflisten
 -3 - Spalten der Tabelle auflisten
- 4 - Prozessliste anzeigen
- 0 - Beenden
Ihre Auswahl : 1
Datenbanken gefunden : 7
adressen
dvd_archiv
mail_archiv
mein_test
mysql
news
test
...
...
Ihre Auswahl : 2
Tabellen in der Datenbank : 1
privat
...
...
Ihre Auswahl : 3
Bitte eine Tabelle ausw&auml;hlen : privat
Daten der Tabelle: [ privat ]
+-------+-------+------+------+---------+--------+-------+
| vname | nname | plz  | ort  | strasse | hausnr | phone |
+-------+-------+------+------+---------+--------+-------+
...
...
Ihre Auswahl : 4
Prozesse gefunden : 2
+--+----+---------+--------+-----------+----+------+-------+
|Id|User|Host     |db      |Command    |Time|State | Info  |
+--+----+---------+--------+-----------+----+------+-------+
|1 |root|localhost|adressen|Processlist|0   |(null)| (null)|
|3 |root|localhost|(null)  |Sleep      |6   |      | (null)|
+--+----+---------+--------+-----------+----+------+-------+</pre>
<a name="t310"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t311"></a><h3 class="t3">12.5.10 Ergebnismenge – weitere Funktione<a id="RxxKap12004040004361F03F26C" name="RxxKap12004040004361F03F26C"></a>n 
      <a href="#t2t312"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t310"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999679" name="Xxx999679"></a>Jetzt folgen hier noch weitere Funktionen im Bezug auf die Ergebnismenge (<span class="listing">MYSQL_RES</span>), die sich recht allgemein einsetzen lassen.</p>
<p>Besitzt eine Ergebnismenge das gesamte Anfrageergebnis, dann k&ouml;nnen Sie mit der Funktion<a id="Xxx999682" name="Xxx999682"></a></p>
<pre>#include &lt;mysql.h&gt;
void mysql_data_seek( MYSQL_RES *result,
                      my_ulonglong offset );</pre>
<p>bis zu einer beliebigen Zeile in der Ergebnismenge suchen. Die Funktion kann daher nur in Verbindung mit der Funktion <span class="listing">mysql_store_result()</span> verwendet werden – nicht mit <span class="listing">mysql_use_result()</span>. Als Offset sollte ein Wert zwischen dem Bereich 0 bis <span class="listing">mysql_num_row(max)-1</span> verwendet werden.</p>
<p>Ben&ouml;tigen Sie die L&auml;nge der Spalten der aktuellen Zeile einer Ergebnismenge, um etwa Feldwerte zu kopieren, dann kann hierf&uuml;r folgende Funktion verwendet werden:<a id="Xxx999686" name="Xxx999686"></a></p>
<pre>#include &lt;mysql.h&gt;
unsigned long *mysql_fetch_lengths(MYSQL_RES *result) ;</pre>
<p>Der Vorteil dieser Funktion ist, dass diese nicht die Funktion <span class="listing">strlen()</span> aufruft, was sich positiv in der Performance auswirkt und sich somit auch bestens f&uuml;r Bin&auml;rdaten eignet. Denn bei Bin&auml;rdaten w&uuml;rde die Funktion <span class="listing">strlen()</span> ein falsches Ergebnis f&uuml;r die Felder zur&uuml;ckgeben, die Nullzeichen enthalten. Ist das Feld leer oder beinhaltet Nullwerte, gibt <span class="listing">mysql_fetch_length()</span> 0 zur&uuml;ck – was dabei zutrifft, k&ouml;nnen Sie mit <span class="listing">mysql_fetch_row()</span> ermitteln. Hier ein Beispiel, wie das in der Praxis geht:</p>
<pre>MYSQL_ROW zeile;
unsigned int anzahl_felder;
unsigned int i;
anzahl_felder = mysql_num_fields(ergebnis);
while ((zeile = mysql_fetch_row(ergebnis))) {
   unsigned long *laengen;
   laengen = mysql_fetch_lengths(ergebnis);
   for(i = 0; i &lt; anzahl_felder; i++) {
       printf("[%.*s] ",
           (int) laengen[i], zeile[i] ? zeile[i] : "NULL");
   }
   printf("\n");
}</pre>
<p>Als R&uuml;ckgabewert liefert Ihnen <span class="listing">mysql_fetch_length()</span> ein Array von vorzeichenlosen Ganzzahlen zur&uuml;ck, das die Gr&ouml;&szlig;e einer jeden Spalte beinhaltet. Bei einem Fehler wird <span class="listing">NULL</span> zur&uuml;ckgegeben.</p>
<a name="t311"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t312"></a><h3 class="t3">12.5.11 Befehle an den Server – mysql_query() und mysql_real_query(<a id="RxxKap12004040004361F03F276" name="RxxKap12004040004361F03F276"></a>) 
      <a href="#t2t313"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t311"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999693" name="Xxx999693"></a>Sicherlich haben Sie sich schon &uuml;berlegt, wie Sie wohl SQL-Anfragen à la <span class="listing">SELECT</span>, <span class="listing">INSERT</span> ... an den MySQL-Server mithilfe der C-API stellen k&ouml;nnen.</p>
<p>Eine SQL-Anfrage k&ouml;nnen Sie mit der Funktion <span class="listing">mysql_query()<a id="Xxx999695" name="Xxx999695"></a></span> bzw. <span class="listing">mysql_real_query()<a id="Xxx999696" name="Xxx999696"></a></span> stellen. Der Vorgang einer solchen Anfrage ist folgender:</p>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"> Eine SQL-Anfrage an den Server</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"> Server empf&auml;ngt die Anfrage und &uuml;berpr&uuml;ft diese auf syntaktische Fehler.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"> Server f&uuml;hrt die angefragte Aktion aus und gibt abh&auml;ngig von der Art der Anfrage ein Resultat zur&uuml;ck. So wird, im Gegensatz zu einer <span class="listing">SELECT</span>-Anfrage, bei einer <span class="listing">INSERT</span>-Anfrage nichts zur&uuml;ckgegeben.</td>
</tr>
</table>
<p>Die Funktion, mit der Sie eine SQL-Anfrage an den Server stellen k&ouml;nnen, ist:</p>
<pre>#include &lt;mysql.h&gt;
int mysql_query(MYSQL *mysql, const char *anfrage); 
int mysql_real_query( MYSQL *mysql, const char *anfrage, 
                      unsigned long laenge );</pre>
<p>Damit k&ouml;nnen Sie SQL-Anweisungen (Anfragen) als nullterminierten String ausf&uuml;hren, der am Ende allerdings im Gegensatz zur MySQL-Shell kein Semikolon oder <span class="listing">\g</span> haben darf. Verl&auml;uft bei der Anfrage alles planm&auml;&szlig;ig, wird 0, ansonsten bei einem Fehler ungleich 0 zur&uuml;ckgegeben.</p>
<p>Da <span class="listing">mysql_query()</span> wegen der Bedeutung des String-Endezeichens nicht f&uuml;r Bin&auml;rdaten geeignet ist, m&uuml;ssen Sie hierf&uuml;r die Funktion <span class="listing">mysql_real_query()</span> mit der Angabe der L&auml;nge (<span class="listing">laenge</span>) des Strings als extra Parameter verwenden.</p>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>Da mit <span class="listing">mysql_query()</span> keinerlei Angaben zur L&auml;nge des Strings gemacht werden, ist diese Funktion ein Kandidat f&uuml;r einen Buffer Overflow – deshalb sollte immer die Funktion <span class="listing">mysql_real_query()</span> bevorzugt werden.</p>
</td>
</tr>
</table><br>
<p>Wenn die SQL-Anfrage an den Server nicht klappen will, sollten Sie den Fehler mit <span class="listing">mysql_errno()</span> und <span class="listing">mysql_error()</span> &uuml;berpr&uuml;fen. Folgende Fehler k&ouml;nnen dabei auftreten:</p>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_COMMANDS_OUT_OF_SYNC</span> – Befehle wurden nicht in der korrekten Reihenfolge ausgef&uuml;hrt.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_SERVER_GONE_ERROR</span> – Der MySQL-Server ist weg.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_SERVER_LOST</span> – Die Verbindung zum Server ging w&auml;hrend der Anfrage verloren.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_UNKNOWN_ERROR</span> – Ein unbekannter Fehler trat auf.</td>
</tr>
</table>
<p>F&uuml;r Anfragen an den Server mit z. B. <span class="listing">INSERT</span>, wo ja nichts zur&uuml;ckgegeben wird, reichen <span class="listing">mysql_query()</span> und <span class="listing">mysql_real_query()</span> aus. Allerdings bei Anfragen mittels <span class="listing">SELECT</span>, <span class="listing">SHOW</span>, <span class="listing">DESCRIBE</span> oder <span class="listing">EXPLAIN</span>, wo etwas zur&uuml;ckgegeben wird, ben&ouml;tigen Sie eine Funktion, um die Daten der SQL-Abfrage abzuholen. Hierf&uuml;r m&uuml;ssen Sie die Funktionen <span class="listing">mysql_store_result()</span> oder <span class="listing">mysql_use_result()</span> aufrufen. Es ist allerdings auch m&ouml;glich, die beiden Funktionen bei SQL-Anfragen aufzurufen, die keinen Wert zur&uuml;ckgeben. Damit k&ouml;nnen Sie z. B. feststellen, ob die Anfrage eine Ergebnismenge hatte, wenn Sie pr&uuml;fen, ob <span class="listing">mysql_store_result()</span> 0 zur&uuml;ckgibt.<a id="Xxx999715" name="Xxx999715"></a></p>
<p>Beginnend mit <span class="listing">mysql_store_result()</span> – die Syntax:</p>
<pre>#include &lt;mysql.h&gt;
MYSQL_RES *mysql_store_result(MYSQL *mysql) ;</pre>
<p>Damit lesen Sie das gesamte Ergebnis einer SQL-Anfrage (meist mit <span class="listing">mysql_real_query()</span>) zum Client ein. Als R&uuml;ckgabewert erhalten Sie eine Ergebnismenge vom Typ der <span class="listing">MYSQ_RES</span>-Struktur zur&uuml;ck. Wie Sie diese Ergebnismenge behandeln k&ouml;nnen, haben Sie ja bereits gelesen. Hat die Anfrage keine Ergebnismenge zur&uuml;ckgegeben, gibt <span class="listing">mysql_store_result()</span> <span class="listing">NULL</span> zur&uuml;ck (z. B. wenn die Anfrage ein <span class="listing">INSERT</span>-Statement war). <span class="listing">NULL</span> wird allerdings auch zur&uuml;ckgegeben, wenn das Lesen der Ergebnismenge fehlgeschlagen ist. Sie k&ouml;nnen &uuml;berpr&uuml;fen, ob es sich dabei um einen Fehler handelt, wenn <span class="listing">mysql_error()</span> keinen <span class="listing">NULL</span>-Zeiger zur&uuml;ckgibt und/oder <span class="listing">mysql_errno()</span> ungleich 0 zur&uuml;ckgab. Eine leere Ergebnismenge wird zur&uuml;ckgegeben, wenn keine Zeilen zur&uuml;ckgegeben werden. (Eine leere Ergebnismenge unterscheidet sich als R&uuml;ckgabewert von einem <span class="listing">NULL</span>-Zeiger.)</p>
<p>Wenn Sie mittels <span class="listing">mysql_store_result()</span> ein Ergebnis erhalten haben, das kein <span class="listing">NULL</span>-Zeiger ist, k&ouml;nnen Sie mit der Funktion <span class="listing">mysql_num_rows()</span> herausfinden, wie viele Zeilen in der Ergebnismenge enthalten sind. Mit <span class="listing">mysql_fetch_row()</span> k&ouml;nnen Sie die einzelnen Zeilen der Ergebnismenge holen oder mit <span class="listing">mysql_row_seek()</span> und <span class="listing">mysql_row_tell()</span> die Zeilenposition (Zeilencursor) innerhalb der Zeile setzen oder abfragen (funktioniert auch mit <span class="listing">mysql_data_seek()</span>).</p>
<p>Die Behandlung des Erhalts der Ergebnismenge mit <span class="listing">mysql_store_result()</span> kann also ebenso gehandhabt werden, wie Sie dies schon in den Seiten zuvor mit der Behandlung der Mengen zeilenweise und spaltenweise gesehen und (hoffentlich auch) gemacht haben.</p>
<p>Sie m&uuml;ssen <span class="listing">mysql_free_result()</span> aufrufen, wenn Sie mit der Ergebnismenge fertig sind.</p>
<p>Nat&uuml;rlich kann es auch passieren, dass <span class="listing">mysql_store_result()</span> <span class="listing">NULL</span> zur&uuml;ckliefert, obwohl der Aufruf von <span class="listing">mysql_real_query()</span> erfolgreich war. Dies kann mehrere Ursachen haben. So war die R&uuml;ckgabe der Ergebnismenge zu gro&szlig;, und es konnte daf&uuml;r kein Speicher mehr reserviert werden, oder die Daten konnten nicht gelesen werden. Und – der plausibelste Grund – die Anfrage gibt keine Daten zur&uuml;ck, wie dies bei <span class="listing">INSERT</span>, <span class="listing">UPDATE</span> oder <span class="listing">DELETE</span> der Fall ist.</p>
<p>Um zu &uuml;berpr&uuml;fen, ob das Statement eine leere Ergebnismenge zur&uuml;ckgegeben hat, sollten Sie <span class="listing">mysql_field_count()</span> aufrufen. Wenn <span class="listing">mysql_field_count()</span> 0 zur&uuml;ckgibt, ist die Ergebnismenge leer, und bei der Anfrage handelte es sich um ein SQL-Statement, das keinen R&uuml;ckgabewert liefert (<span class="listing">INSERT</span>, <span class="listing">UPDATE</span>, <span class="listing">DELETE</span>).</p>
<p>Es empfiehlt sich au&szlig;erdem, mit <span class="listing">mysql_error()</span> und <span class="listing">mysql_errno()</span> auf Fehler zu &uuml;berpr&uuml;fen. Folgende Fehler k&ouml;nnen dabei auftreten:</p>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_COMMANDS_OUT_OF_SYNC</span> – Befehle wurden nicht in der korrekten Reihenfolge ausgef&uuml;hrt.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_OUT_OF_MEMORY</span> – Kein Speicher mehr.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_SERVER_GONE_ERROR</span> – Der MySQL-Server ist weg.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_SERVER_LOST</span> – Die Verbindung zum Server ging w&auml;hrend der Anfrage verloren.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_UNKNOWN_ERROR</span> – Ein unbekannter Fehler trat auf.</td>
</tr>
</table>
<p>Die Funktion <span class="listing">mysql_use_result()</span> initiiert einen Ergebnismengen-Abruf, aber liest die Ergebnismenge nicht in die Clientanwendung ein wie <span class="listing">mysql_store_result()</span>.<a id="Xxx999731" name="Xxx999731"></a></p>
<pre>#include &lt;mysql.h&gt;
MYSQL_RES *mysql_use_result(MYSQL *mysql);</pre>
<p>Mit <span class="listing">mysql_use_result()</span> muss jede Zeile extra abgerufen werden, indem hierzu Aufrufe mit <span class="listing">mysql_fetch_row()</span> ausgef&uuml;hrt werden. Damit wird das Ergebnis einer Anfrage direkt vom Server geholt, ohne (wie bei <span class="listing">mysql_store_result()</span>) zuvor eine tempor&auml;re Tabelle oder einen lokalen Puffer zu belasten – was daher logischerweise schneller sein kann als <span class="listing">mysql_store_result()</span>. Der Clientanwendung wird nur Speicher f&uuml;r die aktuelle Zeile zugewiesen sowie ein Kommunikationspuffer, der bis zu max_allowed_packet Bytes gro&szlig; werden kann.</p>
<p>Auf der anderen Seite sollten Sie <span class="listing">mysql_use_result()</span> nicht verwenden, wenn Sie viele Verarbeitungen f&uuml;r jede Zeile auf der Clientseite durchf&uuml;hren oder wenn die Ausgabe auf den Bildschirm geschickt wird, auf dem der Benutzer <b>(STRG)</b>+<b>(S)</b> (stop scroll) eingeben kann. Das bindet den Server und sorgt daf&uuml;r, dass andere Threads irgendwelche Tabellen nicht aktualisieren k&ouml;nnen, von denen gerade Daten geholt werden.</p>
<p>Bei der Funktion <span class="listing">mysql_use_result()</span> m&uuml;ssen Sie au&szlig;erdem <span class="listing">mysql_fetch_row()</span> ausf&uuml;hren, bis ein <span class="listing">NULL</span>-Wert zur&uuml;ckgegeben wird, da sonst die nicht geholten Zeilen als ein Teil der Ergebnismenge bei der n&auml;chsten Anfrage zur&uuml;ckgegeben werden. Wird dies nicht beachtet, bekommen Sie einen Fehler wie Commands out of sync; You can't run this command now zur&uuml;ck.</p>
<p>Da die Funktion <span class="listing">mysql_use_result()</span> jede Zeile extra aufruft, k&ouml;nnen Sie Funktionen wie <span class="listing">mysql_data_seek()</span>, <span class="listing">mysql_row_seek()</span>, <span class="listing">mysql_row_tell()</span>, <span class="listing">mysql_num_rows()</span> oder <span class="listing">mysql_affected_rows()</span> nicht bei einem Ergebnis verwenden. Des Weiteren darf keine Anfrage gesetzt werden, wenn <span class="listing">mysql_use_result()</span> nicht beendet ist. Wenn alle Zeilen geholt wurden, wird die Funktion <span class="listing">mysql_num_row()</span> aber dennoch die exakte Anzahl der geholten Zeilen zur&uuml;ckgeben. Sie m&uuml;ssen <span class="listing">mysql_free_result()</span> aufrufen, wenn Sie mit der Ergebnismenge fertig sind.</p>
<p>Die Fehler, die Sie mit <span class="listing">mysql_error()</span> und <span class="listing">mysql_errno()</span> abfragen k&ouml;nnen, sind dieselben wie bei der Funktion <span class="listing">mysql_store_result()</span>.</p>
<p>Um herauszufinden, wie viele Zeilen von einem SQL-Statement wie <span class="listing">UPDATE</span>, <span class="listing">DELETE</span> oder <span class="listing">INSERT</span> betroffen waren, kann man direkt nach <span class="listing">mysql_real_query()</span> die Funktion<a id="Xxx999739" name="Xxx999739"></a></p>
<pre>#include &lt;mysql.h&gt;
my_ulonglong mysql_affected_rows(MYSQL *mysql) ;</pre>
<p>aufrufen. Bei <span class="listing">SELECT</span>-Statements funktioniert <span class="listing">mysql_affectetd_rows()</span> wie <span class="listing">mysql_num_rows()</span>. Ein Wert gr&ouml;&szlig;er als 0 gibt die Anzahl der Zeilen, die vom Abruf betroffen waren. Bei 0 wurde kein Datensatz ge&auml;ndert, und bei -1 ist ein Fehler aufgetreten. So wird auch ein Fehler zur&uuml;ckgegeben, wenn Sie bei einem <span class="listing">SELECT</span>-Statement die Funktion <span class="listing">mysql_affected_row()</span> vor der Funktion <span class="listing">mysql_store_result()</span> aufrufen. Ein Beispiel einer solchen Abfrage k&ouml;nnte so aussehen:</p>
<pre>char
str[BUF] = "UPDATE adressen SET plz=86316 WHERE ort='Friedberg'";
mysql_real_query(&amp;mysql, str, strlen(str));
printf("%ld Adressen vom UPDATE betroffen",
         (long) mysql_affected_rows(&amp;mysql));</pre>
<p>Bei der Verwendung eines <span class="listing">REPLACE</span>-Statements und f&uuml;r den Fall, dass ein Datensatz ver&auml;ndert wurde, gibt <span class="listing">mysql_affected_row()</span> 2 zur&uuml;ck. Dies liegt daran, dass erst eine neue Zeile eingef&uuml;gt und dann die alte gel&ouml;scht wird.</p>
<p>Wenn Sie mit der Abarbeitung der Ergebnismenge von <span class="listing">mysql_store_result()</span>, <span class="listing">mysql_use_result()</span>, <span class="listing">mysql_list_dbs()</span>, <span class="listing">mysql_list_fields()</span>, <span class="listing">mysql_list_tables()</span> ... fertig sind, sollten Sie den Speicher wieder freigeben, um Memory Leaks zu vermeiden. Eine Ergebnismenge freigeben k&ouml;nnen Sie mit der Angabe der Ergebnismenge als Parameter mit der Funktion:<a id="Xxx999745" name="Xxx999745"></a></p>
<pre>#include &lt;mysql.h&gt;
void mysql_free_result(MYSQL_RES *result) ;</pre>
<a name="t312"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t313"></a><h3 class="t3">12.5.12 Weitere Funktione<a id="RxxKap12004040004361F03F2A4" name="RxxKap12004040004361F03F2A4"></a>n 
      <a href="#t2t314"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t312"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999749" name="Xxx999749"></a>Bevor Sie ein etwas umfangreicheres Beispiel sehen werden, folgen hier noch zu Referenzzwecken weitere API-Funktionen im Schnelldurchlauf, die allerdings im anschlie&szlig;enden Beispiel nicht verwendet werden.</p>
<p>Soll der Benutzer ge&auml;ndert wurden, kann die Funktion<a id="Xxx999751" name="Xxx999751"></a><a id="Xxx999752" name="Xxx999752"></a></p>
<pre>#include &lt;mysql.h&gt;
my_bool mysql_change_user(MYSQL *mysql, const char *user,
                          const char *password, const char *db);</pre>
<p>verwendet werden. Damit wird der Benutzer f&uuml;r die Verbindung mit dem MySQL-Handle ge&auml;ndert. Als weitere Parameter werden der Username, das Passwort und eventuell die Datenbank ben&ouml;tigt. Wenn Sie keine den Vorgaben entsprechende Datenbank haben wollen, k&ouml;nnen Sie hierf&uuml;r auch <span class="listing">NULL</span> angeben. Kann der Benutzer nicht authentifiziert werden oder fehlen die entsprechenden Zugriffsrechte auf die Datenbank, schl&auml;gt die Funktion <span class="listing">mysql_change_user()</span> fehl. Bei einem Fehler wird ein Wert ungleich 0 zur&uuml;ckgegeben – bei Erfolg 0. Um zu ermitteln, welcher Fehler aufgetreten ist, empfiehlt es sich, die Funktionen <span class="listing">mysql_error()</span> und <span class="listing">mysql_errno()</span> zu verwenden. Die Fehler, die Sie dabei erhalten k&ouml;nnen, entsprechen denselben, die Sie bei der Funktion <span class="listing">mysql_real_connect()</span> erhalten k&ouml;nnten.</p>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>Bei einer API-Version vor 3.23.3 ist diese Funktionen noch nicht implementiert.</p>
</td>
</tr>
</table><br>
<p>Ein Codeausschnitt zur Anwendung sieht wie folgt aus:</p>
<pre>if (mysql_change_user(&amp;mysql, "nobody",
                              "x4i4d1k4",
                              "datenbank_3")) {
   fprintf(stderr, "&Auml;nderung des Benutzers fehlgeschlagen. "
                   " Fehler: %s\n", mysql_error(&amp;mysql));
}</pre>
<p>Um eine korrekte SQL-Zeichenkette f&uuml;r ein SQL-Statement zu erzeugen, kann folgende Funktion verwendet werden:<a id="Xxx999763" name="Xxx999763"></a><a id="Xxx999764" name="Xxx999764"></a></p>
<pre>#include &lt;mysql.h&gt;
unsigned int mysql_escape_string( MYSQL *mysql, char *nach,
                                  const char *von,
                                  unsigned int laenge );
unsigned int mysql_real_escape_string( MYSQL *mysql, char *nach,
                                       const char *von,
                                       unsigned int laenge );</pre>
<p>Die Zeichenkette <span class="listing">von</span> wird in eine escape-SQL-Zeichenkette kodiert. Kodierte Zeichen sind NUL (ASCII 0), <span class="listing">\n</span>, <span class="listing">\r</span>, <span class="listing">\</span>, <span class="listing">'</span>, <span class="listing">"</span> und <b>(STRG)</b>+<b>(Z)</b>; wobei die Funktion <span class="listing">mysql_real_escape_string()</span> der Funktion <span class="listing">mysql_escape_string()</span> vorzuziehen ist, da diese Funktion den aktuellen Zeichensatz, der verwendet wird, ber&uuml;cksichtigt. Bei <span class="listing">mysql_escape_string()</span> wird die aktuelle Zeichenstellung ignoriert. Das Ergebnis finden Sie als einen terminierten String in <span class="listing">nach</span>. Der String, auf den <span class="listing">von</span> zeigt, muss <span class="listing">laenge</span> Bytes lang sein. Sie m&uuml;ssen den <span class="listing">nach</span>-Puffer so zuweisen, dass er mindestens <span class="listing">laenge*2+1</span> Bytes lang ist. Der R&uuml;ckgabewert ist die L&auml;nge der kodierten Zeichenkette ohne das Nullzeichen am Ende.</p>
<p>Wenn Sie eine Kennung f&uuml;r eine <span class="listing">AUTO_INCREMENT</span>-Spalte ben&ouml;tigen, die durch eine vorherige Anfrage erzeugt wurde, dann kann die Funktion<a id="Xxx999768" name="Xxx999768"></a></p>
<pre>#include &lt;mysql.h&gt;
my_ulonglong mysql_insert_id(MYSQL *mysql) ;</pre>
<p>verwendet werden. Benutzen sollten Sie die Funktion unmittelbar nach einer <span class="listing">INSERT</span>-Anfrage f&uuml;r eine Tabelle, die den <span class="listing">AUTO_INCREMENT</span>-Wert erzeugt hat. <span class="listing">mysql_insert_id()</span> wird nach jedem <span class="listing">INSERT</span>- und <span class="listing">UPDATE</span>-Statement aktualisiert, die einen <span class="listing">AUTO_INCREMENT</span>-Wert erzeugen oder einen Spaltenwert auf <span class="listing">LAST_INSERT_ID(ausdruck)</span> setzen. Beachten Sie auch, dass der Wert der <span class="listing">LAST_INSERT_ID()</span>-Funktion immer den aktuellsten erzeugten <span class="listing">AUTO_INCREMENT</span>-Wert enth&auml;lt und zwischen den Anfragen nicht zur&uuml;ckgesetzt wird, weil der Wert dieser Funktion beim Server erwartet wird. Zur&uuml;ckgegeben wird der Wert des <span class="listing">AUTO_INCREMENT</span>-Feldes, der durch die vorherige Anfrage ver&auml;ndert wurde – ansonsten 0, wenn es keine Anfrage gab oder wenn die Anfrage keinen <span class="listing">AUTO_INCREMENT</span>-Wert aktualisiert hat.</p>
<p>Wollen Sie einen bestimmten Thread mit einer bestimmten Prozess-ID beenden, k&ouml;nnen Sie folgende Funktion verwenden:</p>
<pre>#include &lt;mysql.h&gt;
int mysql_kill(MYSQL *mysql, unsigned long pid) ;</pre>
<p>Damit wird der Thread der aktuellen Verbindung <span class="listing">mysql</span> mit der Erkennung <span class="listing">pid</span> beendet. Konnte der Thread erfolgreich »get&ouml;tet« werden, gibt diese Funktion 0, ansonsten bei einem Fehler ungleich 0 zur&uuml;ck.</p>
<p>Es besteht auch die M&ouml;glichkeit, das Verhalten einer Verbindung zu ver&auml;ndern. Mit der Funktion <span class="listing">mysql_options()</span> k&ouml;nnen Sie zus&auml;tzlich Optionen zu einer Verbindung setzen.<a id="Xxx999775" name="Xxx999775"></a></p>
<pre>#include &lt;mysql.h&gt;
int mysql_options(MYSQL *mysql, enum mysql_option option,
                  const char *arg) ;</pre>
<p><span class="listing">mysql_options()</span> kann zwar mehrfach aufgerufen werden, um verschiedene Optionen zu setzen, allerdings muss dies nach <span class="listing">mysql_init()</span> und noch vor <span class="listing">mysql_real_connect()</span> (bzw. <span class="listing">mysql_connect()</span>) geschehen. Ist eine Verbindung erst hergestellt, gibt es keine M&ouml;glichkeit mehr, die laufende Verbindung mit den Optionen zu modifizieren. Die Funktion gibt 0 bei Erfolg und ungleich 0 zur&uuml;ck, wenn Sie eine unbekannte Option verwenden. Das <span class="listing">option</span>-Argument ist die Option, die Sie setzen wollen. Das <span class="listing">arg</span>-Argument ist der Wert f&uuml;r die Option. Wenn die Option eine Ganzzahl ist, sollte <span class="listing">arg</span> auf den Wert der Ganzzahl zeigen, ist die Option ein String, dann sollte <span class="listing">arg</span> auch auf einen String zeigen. Hier die m&ouml;glichen Optionswerte mit den Argumenttypen und deren Bedeutungen:</p>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<caption class="tabunter">
<p><span class="tabunter"><b>Tabelle 12.8   
    </b>Optionen und deren Argumenttypen f&uuml;r mysql_options()</span></p>
</caption>
<tr>
<td class="tabellenkopf" bgcolor="#000000"><b>Option</b>
</td>
<td class="tabellenkopf" bgcolor="#000000"><b>arg-Typ</b>
</td>
<td class="tabellenkopf" bgcolor="#000000"><b>Bedeutung</b>
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">MYSQL_OPT_CONNECT_TIMEOUT
</td>
<td class="tabellentext" bgcolor="#000000">unsigned
int *
</td>
<td class="tabellentext" bgcolor="#000000">Verbindungszeit&uuml;berschreitung (Timeout) in Sekunden
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">MYSQL_OPT_COMPRESS
</td>
<td class="tabellentext" bgcolor="#000000">Unbenutzt
</td>
<td class="tabellentext" bgcolor="#000000">Das komprimierte Client-Server-Protokoll verwenden
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">MYSQL_OPT_NAMED_PIPE
</td>
<td class="tabellentext" bgcolor="#000000">Unbenutzt
</td>
<td class="tabellentext" bgcolor="#000000">Named Pipes benutzen, um sich mit einem MySQL-Server unter NT zu verbinden.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">MYSQL_INIT_COMMAND
</td>
<td class="tabellentext" bgcolor="#000000">char *
</td>
<td class="tabellentext" bgcolor="#000000">Befehl, der beim Verbinden mit dem MySQL-Server ausgef&uuml;hrt werden soll. Wird beim erneuten Verbinden automatisch wieder ausgef&uuml;hrt.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">MYSQL_READ_DEFAULT_FILE
</td>
<td class="tabellentext" bgcolor="#000000">char *
</td>
<td class="tabellentext" bgcolor="#000000">Optionen aus der benannten Optionsdatei anstelle von my.cnf einlesen.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">MYSQL_READ_DEFAULT_GROUP
</td>
<td class="tabellentext" bgcolor="#000000">char *
</td>
<td class="tabellentext" bgcolor="#000000">Optionen aus der benannten Gruppe von my.cnf oder der Datei einlesen, die durch MYSQL_READ_DEFAULT_FILE angegeben wurde.
</td>
</tr>
</table><br>
<p>Beachten Sie, dass die Gruppe <span class="listing">client</span> immer gelesen wird, wenn Sie <span class="listing">MYSQL_READ_DEFAULT_FILE</span> oder <span class="listing">MYSQL_READ_DEFAULT_GROUP</span> benutzen. Die angegebene Gruppe in der Optionsdatei kann folgende Optionen enthalten:</p>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> connect_timeout</span> – Zeit&uuml;berschreitung (Timeout) f&uuml;r die Verbindung in Sekunden. Unter Linux wird dieser Wert zus&auml;tzlich f&uuml;r die Wartezeit auf die erste Antwort vom Server benutzt. Beachten Sie, dass <span class="listing">timeout</span> durch <span class="listing">connect_timeout</span> ersetzt wurde. Dennoch wird <span class="listing">timeout</span> noch f&uuml;r eine Weile funktionieren.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> compress</span> – Das komprimierte Client-Server-Protokoll benutzen</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> database</span> – Mit dieser Datenbank verbinden, wenn im Verbindungsbefehl keine Datenbank angegeben wurde.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> debug</span> – Debug-Optionen</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> host</span> – Vorgabem&auml;&szlig;iger Hostname</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> init-commund</span> – Befehl, der bei der Verbindung zum MySQL-Server ausgef&uuml;hrt wird. Wird automatisch beim erneuten Verbinden noch einmal ausgef&uuml;hrt.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> interactive-timeout</span> – Dasselbe wie die Angabe von <span class="listing">CLIENT_INTERACTIVE</span> f&uuml;r <span class="listing">mysql_real_connect()</span></td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> password</span> – Vorgabem&auml;&szlig;iges Passwort</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> pipe</span> – Named Pipes benutzen, um sich mit einem MySQL-Server unter NT zu verbinden.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> port</span> – Vorgabem&auml;&szlig;ige Portnummer</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> return-found-rows</span> – Weist <span class="listing">mysql_info()</span> an, gefundene Zeilen anstelle von aktualisierten Zeilen zur&uuml;ckzugeben, wenn <span class="listing">UPDATE</span> benutzt wird.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> socket</span> – Vorgabem&auml;&szlig;ige Socket-Nummer</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> user</span> – Vorgabem&auml;&szlig;iger Benutzer</td>
</tr>
</table>
<p>Ein Code-Ausschnitt einer solchen Anwendung:</p>
<pre>MYSQL my;
mysql_init(&amp;my);
mysql_options(&amp;my,MYSQL_OPT_COMPRESS,0);
mysql_options(&amp;my,MYSQL_READ_DEFAULT_GROUP,"odbc");
if (mysql_real_connect(&amp;my, "host",
                            "benutzer",
                            "passwort",
                            "datenbank"
                            ,0,NULL,0) == 0 ) {
    fprintf(stderr, "Fehler bei mysql_real_connect: %s\n",
          mysql_error(&amp;my));
    exit(EXIT_FAILURE);
}</pre>
<p>Im obigen Beispiel wird der Client angewiesen, das komprimierte Client-Server-Protokoll zu benutzen und zus&auml;tzliche Optionen aus dem odbc-Abschnitt in my.cnf zu lesen.</p>
<p>Um zu &uuml;berpr&uuml;fen, ob eine Verbindung zum Server noch steht oder nicht, k&ouml;nnen Sie folgende Funktion verwenden:<a id="Xxx999849" name="Xxx999849"></a></p>
<pre>#include &lt;mysql.h&gt;
int mysql_ping(MYSQL *mysql) ;</pre>
<p>Besteht keine Verbindung mehr zum Server, wird versucht, von Clientseite erneut eine Verbindung zum Server herzustellen. Dies ist z. B. n&ouml;tig, wenn Ihre Clientanwendung lange Zeit im Leerlauf mit dem Server verbunden ist und der Server die Verbindung getrennt hat und Sie sich erneut verbinden wollen. Die Funktion gibt bei Erfolg 0, ansonsten, wenn der Server nicht mehr da ist oder ein Fehler auftrat, ungleich 0 zur&uuml;ck. Was genau passiert ist, sollten Sie am besten mit <span class="listing">mysql_error()</span> und <span class="listing">mysql_errno()</span> &uuml;berpr&uuml;fen. Folgende Fehler k&ouml;nnen dabei aufgetreten sein:</p>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_COMMANDS_OUT_OF_SYNC</span> – Befehle wurden nicht in der korrekten Reihenfolge ausgef&uuml;hrt.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_SERVER_GONE_ERROR</span> – Der MySQL-Server ist weg.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"><span class="listing"> CR_UNKNOWN_ERROR</span> – Ein unbekannter Fehler trat auf.</td>
</tr>
</table>
<p>Wollen Sie f&uuml;r eine Verbindung eine vorgabem&auml;&szlig;ige Datenbank angeben, dann k&ouml;nnen Sie folgende Funktion verwenden:<a id="Xxx999856" name="Xxx999856"></a></p>
<pre>#include &lt;mysql.h&gt;
int mysql_select_db(MYSQL *mysql, const char *db) ;</pre>
<p>Damit wird die Datenbank, die Sie mit <span class="listing">db</span> angeben, zur aktuellen Datenbank der Verbindung <span class="listing">mysql</span>. Alle nachfolgenden Anfragen beziehen sich auf diese Datenbank. Die Funktion schl&auml;gt fehl, sofern der Benutzer keine Zugriffsrechte auf diese Datenbank hat. Die Funktion gibt bei Erfolg 0, ansonsten bei einem Fehler ungleich 0 zur&uuml;ck.</p>
<p>Den MySQL-Server herunterfahren k&ouml;nnen Sie, sofern entsprechende Berechtigungen vorhanden sind, mit der folgenden Funktion:<a id="Xxx999860" name="Xxx999860"></a></p>
<pre>#include &lt;mysql.h&gt;
int mysql_shutdown(MYSQL *mysql) ;</pre>
<p>Konnte der Server erfolgreich heruntergefahren werden, wird 0, ansonsten bei einem Fehler ungleich 0 zur&uuml;ckgegeben.</p>
<p>Ben&ouml;tigen Sie Informationen, &auml;hnlich wie die der Ausgabe von <span class="listing">mysqladmin</span> <span class="listing">status</span>, k&ouml;nnen Sie folgende Funktion verwenden:</p>
<pre>#include &lt;mysql.h&gt;
const char *mysql_stat(MYSQL *mysql);</pre>
<p>Dabei erhalten Sie einen terminierten String zur&uuml;ck, der Informationen wie die Betriebszeit (Uptime) in Sekunden und die Anzahl laufender Threads, Anfragen (Questions), Neuladen (Reloads) und offene Tabellen ausgibt. Konnte der Status nicht erfragt werden oder trat sonst ein Fehler auf, wird <span class="listing">NULL</span> zur&uuml;ckgegeben.</p>
<p>Die Kennung (pid) eines aktuellen Threads k&ouml;nnen Sie mit der Funktion<a id="Xxx999866" name="Xxx999866"></a></p>
<pre>#include &lt;mysql.h&gt;
unsigned long mysql_thread_id(MYSQL *mysql) ;</pre>
<p>ermitteln. Diesen zur&uuml;ckgegebenen Wert k&ouml;nnen Sie anschlie&szlig;end z. B. verwenden, um den Thread mit der Funktion <span class="listing">mysql_kill()</span> zu beenden. Beachten Sie allerdings, wenn eine Verbindung beendet wird und Sie mit <span class="listing">mysql_ping()</span> eine neue Verbindung aufbauen, dass sich die Thread-ID ebenfalls ver&auml;ndert hat und Sie somit die Funktion <span class="listing">mysql_thread_id()</span> erneut aufrufen sollten, sofern Sie die Kennung ben&ouml;tigen.</p>
<p>Sofern Sie Probleme mit dem Server oder der Clientanwendung haben, k&ouml;nnen Sie mit der Funktion <span class="listing">mysql_debug()<a id="Xxx999871" name="Xxx999871"></a></span> ein <span class="listing">DBUG_PUSH</span> mit einem angegebenen String durchf&uuml;hren, z. B.:</p>
<pre>mysql_debug("d:t:O,/tmp/client.trace");</pre>
<p>Mit dieser Funktion wird die Debug-Bibliothek von Fred Fish benutzt. Voraussetzung daf&uuml;r, dass Sie diese Funktion verwenden k&ouml;nnen, ist, dass Sie die Client-Bibliothek so kompilieren, dass diese das Debuggen unterst&uuml;tzt. Mit der Funktion <span class="listing">mysql_dump_debug_info()<a id="Xxx999874" name="Xxx999874"></a></span> weisen Sie den Server an, Debug-Informationen in die Log-Datei zu schreiben (entsprechende Zugriffsrechte vorausgesetzt!). Ich will allerdings auf die Debug-Geschichte nicht n&auml;her eingehen, da dies ein umfangreicheres Unterfangen ist und nicht Diskussionspunkt in diesem Buch ist.</p>
<a name="t313"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t314"></a><h3 class="t3">12.5.13 Veraltete Funktione<a id="RxxKap12004040004361F03F2F8" name="RxxKap12004040004361F03F2F8"></a>n 
      <a href="#t2t315"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t313"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999877" name="Xxx999877"></a>Zum Abschluss folgen hier noch einige Funktionen, die allerdings nicht mehr verwendet werden sollten, da sie als veraltet gelten. Damit &auml;ltere Clientanwendungen noch mit einer neueren API-Bibliothek &uuml;bersetzt werden k&ouml;nnen, sind diese Funktionen noch vorhanden. Falls Sie eine &auml;ltere Clientanwendung ver&auml;ndern m&uuml;ssen und Sie auf eine dieser Funktionen treffen, wissen Sie wenigstens Bescheid, worum es sich handelt.</p>
<p>Mit der Funktion</p>
<pre>#include &lt;mysql.h&gt;
int mysql_create_db(MYSQL *mysql, const char *db) ;</pre>
<p>kann eine Datenbank, die mit dem Parameter <span class="listing">db</span> angegeben wird, erzeugt werden. Als Alternative wird empfohlen, die Funktion <span class="listing">mysql_real_query()</span> und das SQL-Statement <span class="listing">CREATE</span> <span class="listing">DATABASES</span> zu verwenden, z. B.:</p>
<pre>const char buf[BUF] = "CREATE DATABASE datenbank";
mysql_real_query( my, buf, strlen(buf));</pre>
<p>Ebenso sieht es mit der Funktion</p>
<pre>#include &lt;mysql.h&gt;
int mysql_drop_db(MYSQL *mysql, const char *db) ;</pre>
<p>aus. Damit wird eine Datenbank, die mit dem Parameter <span class="listing">db</span> angegeben wird, gel&ouml;scht. Auch hierzu sollte <span class="listing">mysql_real_query()</span> mit dem SQL-Statement <span class="listing">DROP_DATABASES</span> bevorzugt werden:</p>
<pre>const char buf[BUF] = "DROP DATABASE datenbank";
mysql_real_query(my, buf, strlen(buf));</pre>
<p>Mit der Funktion</p>
<pre>#include &lt;mysql.h&gt;
my_bool mysql_eof(MYSQL_RES *result) ;</pre>
<p>kann festgestellt werden, ob die letzte Zeile einer Ergebnismenge gelesen wurde oder nicht. Es wird allerdings empfohlen, die Funktionen <span class="listing">mysql_error()</span> und <span class="listing">mysql_errno()</span> zu verwenden, da diese Funktionen diesen Fehler ebenfalls &uuml;berpr&uuml;fen und auch mehr Auskunft zur Verf&uuml;gung stellen als <span class="listing">mysql_eof()</span>, die nur einen booleschen Wert zur&uuml;ckgibt und keine Meldung dar&uuml;ber, warum der Fehler auftrat.</p>
<p>Um die Anforderung an den Server zu stellen, dass er die Berechtigungstabelle neu laden soll, kann die Funktion</p>
<pre>#include &lt;mysql.h&gt;
int mysql_reload(MYSQL *mysql) ;</pre>
<p>verwendet werden. Voraussetzung ist nat&uuml;rlich eine entsprechende Berechtigung dazu. Auch hierbei sei empfohlen, die Funktion <span class="listing">mysql_real_query()</span> mit dem SQL-Statement <span class="listing">FLUSH_PRIVILEGS</span> zu verwenden.</p>
<a name="t314"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t315"></a><h3 class="t3">12.5.14 Neue Funktionen ab Version 4.1.<a id="RxxKap12004040004361F03F308" name="RxxKap12004040004361F03F308"></a>x 
      <img src="common/15x15leer.gif" width="15" height="15" border="0" alt="top"><a href="#t2t314"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999895" name="Xxx999895"></a>Die Weiterentwicklung der MySQL C-API schl&auml;ft nicht und wird munter vorangetrieben. Schon seit der Version 4.1.x ist wieder bereits eine Menge neuer Funktionen hinzugekommen – und ein Ende ist nicht in Sicht. Leider hat man bei einem Buch das Problem, je nach Verkaufszahlen, h&ouml;chstens jedes Jahr ein Update (Neuauflage) zu machen. In der folgenden Tabelle finden Sie einen kurzen &Uuml;berblick &uuml;ber neuere Funktionen ab Version 4.1.x:</p>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<caption class="tabunter">
<p><span class="tabunter"><b>Tabelle 12.9   
    </b>Weitere neuere Funktionen ab MySQL C-API 4.1.x</span></p>
</caption>
<tr>
<td class="tabellenkopf" bgcolor="#000000"><b>Funktion</b>
</td>
<td class="tabellenkopf" bgcolor="#000000"><b>Bedeutung</b>
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">mysql_sqlstate()<a id="Xxx999903" name="Xxx999903"></a>
</td>
<td class="tabellentext" bgcolor="#000000">Gibt einen nullterminierten String mit einem SQLSTATE-Fehlercode f&uuml;r den letzten aufgetretenen Fehler zur&uuml;ck. Der Fehlercode beinhaltet f&uuml;nf Zeichen. So bedeutet '00000', dass kein Fehler aufgetreten ist. Dieser Wert wird von ANSI SQL und ODBC vorgegeben. F&uuml;r eine Liste der Fehlercodes sei auf die (englische) Dokumentation hingewiesen.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">mysql_warning_count()<a id="Xxx999908" name="Xxx999908"></a>
</td>
<td class="tabellentext" bgcolor="#000000">Gibt die Anzahl der Warnungen zur&uuml;ck, die bei einer Ausf&uuml;hrung eines SQL-Statements erzeugt wurden.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">mysql_commit()<a id="Xxx999913" name="Xxx999913"></a>
</td>
<td class="tabellentext" bgcolor="#000000">Legt die aktuellen Transaktionen fest.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">mysql_rollback()<a id="Xxx999918" name="Xxx999918"></a>
</td>
<td class="tabellentext" bgcolor="#000000">Macht die letzte Transaktion r&uuml;ckg&auml;ngig.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">mysql_autocommit()<a id="Xxx999923" name="Xxx999923"></a>
</td>
<td class="tabellentext" bgcolor="#000000">Kann gesetzt oder nicht gesetzt werden, damit eine Transaktion automatisch durchgef&uuml;hrt wird.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">mysql_more_results()<a id="Xxx999928" name="Xxx999928"></a>
</td>
<td class="tabellentext" bgcolor="#000000">Funktion gibt TRUE zur&uuml;ck, wenn eine SQL-Anfrage mehrere Resultate enth&auml;lt. Falls dies der Fall ist, muss mysql_next_result() aufgerufen werden, um die Menge abzuholen.
</td>
</tr>
<tr>
<td class="tabellentext" bgcolor="#000000">mysql_next_result()<a id="Xxx999933" name="Xxx999933"></a>
</td>
<td class="tabellentext" bgcolor="#000000">Wenn mehrere Ergebnismengen existieren, liest mysql_next_result() immer das Resultat der n&auml;chsten Anfrage und gibt den Status an die Anwendung zur&uuml;ck (0 = es sind noch mehr Resultate vorhanden; -1 = kein Resultat mehr vorhanden).
</td>
</tr>
</table><br>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td width="100%" class="start" colspan="1" height="22" align="center">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="20%"><a class="navnav" href="Kap12-003.html"> &lt;&lt; zur&uuml;ck</a></td>
<td width="59%">
<div align="center"><a class="navnav" href="#">&lt;top&gt;</a></div>
</td>
<td align="right" width="20%">
<div align="right"><a class="navnav" href="Kap12-005.html">vor &gt;&gt; </a></div>
</td>
</tr>
</table>
</td>
</tr>
</table>
</div>
</td>
<td width="10" valign="top">&nbsp;&nbsp;</td>
<td width="160" valign="top">
    <table border="0" cellpadding="0" cellspacing="0" width="160">
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                        <td class="tbl2" height="20" colspan="2">
                            &nbsp;<a href="https://www.rheinwerk-verlag.de/?GPP=oplup" class="navs">
                            <strong>Zum Katalog</strong></a>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2">
                            <img src="common/leer.gif" border="0" height="1" width="1"></td>
                        <td valign="top">
                            <table cellspacing="3">
                                <tr>
                                    <td><a href="https://www.rheinwerk-verlag.de/linux-unix-programmierung_1137/?GPP=oplup">
                                        <img src="common/749.gif"  border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Linux-UNIX-Programmierung" title="Zum Katalog: Linux-UNIX-Programmierung">
                                        <br /><strong>Linux-UNIX-<br />Programmierung</strong><br /><img src="common/pfeil_rechts5.gif" border="0" alt="">bestellen</a>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td><img src="common/leer.gif" height="2" width="1" border="0" /></td>
        </tr>
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                        <td class="tbl2" height="20" colspan="2"><strong>&nbsp;Ihre Meinung?</strong></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td>
                        <td valign="top">
                            <table cellspacing="3">
                                <tr>
                                    <td>Wie hat Ihnen das &lt;openbook&gt; gefallen?<br /><a href="https://www.rheinwerk-verlag.de/feedback/"><img src="common/pfeil_rechts5.gif" border="0" alt="">Ihre Meinung</a>
                                    <br /><br /></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td><img src="common/leer.gif" height="2" width="1" border="0" /></td>
        </tr>
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                        <td class="tbl2" height="20" colspan="2">&nbsp;<a href="https://www.rheinwerk-verlag.de/?GPP=oplup" class="navs"><strong>Buchtipps</strong></a></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/linux-server_3685/?GPP=oplup">
                        <img src="common/3020.gif" width="78" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Linux-Server" title="Zum Katalog: Linux-Server"><br /><br /><br /><br /><br /><br /><br />&nbsp;Linux-Server</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/das-komplettpaket-lpic-1-lpic-2_3782/?GPP=oplup">
                        <img src="common/3529.gif" width="70" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Das Komplettpaket LPIC-1 &amp; LPIC-2" title="Zum Katalog: Das Komplettpaket LPIC-1 &amp; LPIC-2"><br /><br /><br /><br /><br /><br /><br />&nbsp;Das Komplettpaket<br />&nbsp;LPIC-1 &amp; LPIC-2</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/linux-hochverfugbarkeit_3420/?GPP=oplup">
                        <img src="common/2542.gif" width="70" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Linux-Hochverfügbarkeit" title="Zum Katalog: Linux-Hochverfügbarkeit"><br /><br /><br /><br /><br /><br /><br />&nbsp;Linux-<br />&nbsp;Hochverfügbarkeit</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/shell-programmierung_3345/?GPP=oplup">
                        <img src="common/2310.gif" width="69" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Shell-Programmierung" title="Zum Katalog: Shell-Programmierung"><br /><br /><br /><br /><br /><br /><br />&nbsp;Shell-<br />&nbsp;Programmierung</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/linux_3436/?GPP=oplup">
                        <img src="common/2591.gif" width="79" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Linux Handbuch" title="Zum Katalog: Linux Handbuch"><br /><br /><br /><br /><br /><br /><br />&nbsp;Linux Handbuch</a><br /><br /></td>
                    </tr>
                </table></td>
        </tr>
        <tr>
            <td><img src="common/leer.gif" height="2" width="1" border="0" /></td>
        </tr>
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                        <td class="tbl2" height="20" colspan="2"><strong>&nbsp;Shopping</strong></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td>
                        <td valign="top">
                            <table cellspacing="3">
                                <tr>
                                    <td><b>Versandkostenfrei</b> bestellen in Deutschland und &Ouml;sterreich<br /><a href="https://www.rheinwerk-verlag.de/hilfe/bestellung_6?GPP=oplup"><img src="common/pfeil_rechts5.gif" border="0" alt="">Info</a><br /><br /></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</td>
</tr>
</table>
<br /><br />
<hr width="70%" align="center">
<br />
<div align="center">
    <p class="standard">
        <strong>Copyright © Rheinwerk Verlag GmbH 2006</strong>
        <br />F&uuml;r Ihren privaten Gebrauch d&uuml;rfen Sie die Online-Version nat&uuml;rlich 
        ausdrucken. Ansonsten unterliegt das &lt;openbook&gt; denselben Bestimmungen, 
        wie die gebundene Ausgabe: Das Werk einschlie&szlig;lich aller seiner Teile ist 
        urheberrechtlich gesch&uuml;tzt. Alle Rechte vorbehalten einschlie&szlig;lich der 
        Vervielf&auml;ltigung, &Uuml;bersetzung, Mikroverfilmung sowie Einspeicherung und 
        Verarbeitung in elektronischen Systemen.
    </p>
    <br><a href="https://www.rheinwerk-verlag.de/">[Rheinwerk Computing]</a>
    <br /><br />Rheinwerk Verlag GmbH, Rheinwerkallee 4, 53227 Bonn, 
    Tel.: 0228.42150.0, Fax 0228.42150.77, 
    <a href="mailto:service@rheinwerk-verlag.de">service@rheinwerk-verlag.de</a>
</div>
<br /><br />
</body>

<!-- Mirrored from openbook.rheinwerk-verlag.de/linux_unix_programmierung/Kap12-004.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 May 2017 19:58:03 GMT -->
</html>
