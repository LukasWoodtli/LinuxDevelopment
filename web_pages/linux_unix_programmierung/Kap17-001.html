<html>

<!-- Mirrored from openbook.rheinwerk-verlag.de/linux_unix_programmierung/Kap17-001.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 May 2017 19:47:19 GMT -->
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Linux-UNIX-Programmierung – 17.2 Bibliotheken erstellen</title>
<meta name="title" content="Linux-UNIX-Programmierung">
<meta name="author" content="J&uuml;rgen Wolf">
<meta name="publisher" content="Rheinwerk Verlag GmbH 2006">
<meta name="copyright" content="Rheinwerk Verlag GmbH 2006">
<meta name="description" content="Linux-UNIX-Programmierung - Das umfassende Handbuch – 2., aktualisierte und erweiterte Auflage 2006 – ISBN 3-89842-749-8">
<meta name="audience" content="Alle">
<meta name="robots" content="INDEX,FOLLOW">
<meta http-equiv="content-language" content="de">
<link rel="stylesheet" type="text/css" href="common/rw_open.css">
<link rel="prev" href="Kap17-000.html">
<link rel="next" href="Kap17-002.html"><script type="text/javascript" language="JavaScript"><!--
function OpenWin(url,name,height,width)
{
  var InfoWin = window.open(url,name,"directories=0,height="+height+",width=" + width + ",hotkeys=0,location=0,menubar=0,resizable=1,screenX=150,screenY=10,left=150,top=10,scrollbars=1,status=1,titlebar=0,toolbar=0");
  InfoWin.focus();
}
//--></script></head>
<body vlink="#000099" link="#000099" alink="#000099">
<table width="100%" height="74" border="0" cellpadding="0" cellspacing="0" bgcolor="#00549d">
<tr>
<td height="74" valign="bottom" colspan="2"><a href="https://www.rheinwerk-verlag.de/openbook/?GPP=oplup"><img src="common/rw_openbook.gif" width="200" height="56" border="0" alt="Rheinwerk Computing < openbook >"></a></td>
<td width="80" height="74">
<a href="https://www.rheinwerk-verlag.de/?GPP=oplup"><img src="common/rw_computing.gif" border="0" alt="Rheinwerk Computing - Professionelle B&uuml;cher. Auch f&uuml;r Einsteiger."></a>
</td>
</tr>
</table><div align="right"><a href="https://www.rheinwerk-verlag.de/?GPP=oplup" class="navnav">Professionelle B&uuml;cher. Auch f&uuml;r Einsteiger</a></div><br /><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="156" valign="top"><table border="0" cellpadding="0" cellspacing="0" width="100%" align="left">
<tr>
<td colspan="2" class="nav1" align="left" valign="top" height="150">
<table class="tbl1" width="150" border="0" cellpadding="3" cellspacing="0">
<tr>
<td class="tbl2" height="25"><A class="nav" href="index-2.html">Inhaltsverzeichnis</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap00a-000.html#Xxx999195">Vorwort des Autors</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap00b-000.html#Xxx999195">Vorwort der Fachgutachter</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap01-000.html#Xxx999235">1 Einf&uuml;hrung</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap02-000.html#Xxx999234">2 E/A-Funktionen</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap03-000.html#Xxx999234">3 Attribute von Dateien und Verzeichnissen</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap04-000.html#Xxx999234">4 Zugriff auf Systeminformationen</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap05-000.html#Xxx999234">5 Devices – eine einfache Verbindung zur Hardware</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap06-000.html#Xxx999234">6 System- und Benutzerdateien</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap07-000.html#Xxx999234">7 D&auml;monen, Zombies und Prozesse</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap08-000.html#Xxx999235">8 Signale</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap09-000.html#Xxx999235">9 IPC – Interprozesskommunikation</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap10-000.html#Xxx999234">10 Threads</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap11-000.html#Xxx999235">11 Netzwerkprogrammierung</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap12-000.html#Xxx999236">12 MySQL und PostgreSQL</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap13-000.html#Xxx999235">13 Terminal E/A und Benutzerschnittstellen f&uuml;r die Konsole</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap14-000.html#Xxx999235">14 Xlib – X Window-Programmierung</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap15-000.html#Xxx999235">15 GTK+</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap16-000.html#Xxx999235">16 SDL</A></td>
</tr>
<tr>
<td><A class="navnavh" href="Kap17-000.html#Xxx999247">17 Werkzeuge f&uuml;r Programmierer</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap18A-000.html#Xxx999248">A Sicherheit unter Linux</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap18B-000.html#Xxx999245">B Funktionsreferenz</A></td>
</tr>
<tr>
<td><A class="navnav" href="Kap18C-000.html#Xxx999245">C Inhalt der Buch-CD</A></td>
</tr>
<tr>
<td><A class="navnav" href="stichwort.html#Xxx537584">Index</A></td>
</tr>
<tr><td><br /><!--<a class="navnav" href="http://download.galileo-press.de/openbook/lup/galileocomputing_linux_unix_programmierung.zip"><strong>Download:</strong><br />- ZIP, ca. 4,3 MB</a></td></tr>
<tr><td><a class="navnav" href="https://www.rheinwerk-verlag.de/1137/?GPP=oplup">Buch bestellen</a></td></tr>
<tr><td>--><a class="navnav" href="https://www.rheinwerk-verlag.de/feedback/">Ihre Meinung?</a><br /><br /></td></tr>
</table></td>
</tr>

</table>
</td>
<td width="10"><img src="common/spacer10.gif" width="10" height="10"></td>
<td width="85%" valign="top" align="center">
<div align="center">
<table width="98%" border="0" cellspacing="0" cellpadding="0" bgcolor="#FFFFFF">
<tr>
<td width="100%" class="start" colspan="1" height="22" align="center">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="20%"><a class="navnav" href="Kap17-000.html"> &lt;&lt; zur&uuml;ck</a></td>
<td width="59%">
<div align="center"><a href="https://www.rheinwerk-verlag.de/?GPP=oplup" class="navnav">Rheinwerk Computing /</a><a class="navnav" href="https://www.rheinwerk-verlag.de/openbook/?GPP=oplup"> &lt;openbook&gt; /</a> <a href="index-2.html" class="navnav"> Linux-UNIX-Programmierung</a></div>
</td>
<td align="right" width="20%">
<div align="right"><a class="navnav" href="Kap17-002.html">vor &gt;&gt; </a></div>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td width="100%" valign="top">
<table width="100%" border="0" cellpadding="10" cellspacing="0" class="box">
<tr>
<td colspan="2"><a href="https://www.rheinwerk-verlag.de/1137/?GPP=oplup" class="buchtitel">Linux-UNIX-Programmierung</a><span class="autor"> von J&uuml;rgen Wolf</span><br><span class="untertitel">Das umfassende Handbuch – 2., aktualisierte und erweiterte Auflage 2006</span></td>
</tr>
<tr>
<td valign="top" width="90"><a href="https://www.rheinwerk-verlag.de/1137/?GPP=oplup"><img src="common/9783898427494.gif" border="0" alt="Buch: Linux-UNIX-Programmierung" title="Buch: Linux-UNIX-Programmierung" align="left"><br /><br /><span class="autor"><strong>Linux-UNIX-Programmierung</strong><br />1216 S., mit CD, 49,90 Euro<br />Rheinwerk Computing<br />ISBN 3-89842-749-8</span></a></a></td>
<td width="80%">
<table border="0">
<tr>
<td valign="baseline"><img src="common/pfeil_u.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="3" class="kap"><b>Kapitel <a href="Kap17-000.html#RxxKap17000040005FD1F04C100">17 Werkzeuge f&uuml;r Programmierer</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap17-000.html#RxxKap17000040005FD1F04C1D5">17.1 Make</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-000.html#RxxKap17000040005FD1F04C1E8">17.1.1 Erzeugen eines Makefiles</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-000.html#RxxKap17000040005FD1F04C226">17.1.2 Variablen, Makros und Abk&uuml;rzungen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-000.html#RxxKap17000040005FD1F04C253">17.1.3 Implizite Regeln</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-000.html#RxxKap17000040005FD1F04C262">17.1.4 Musterregeln</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-000.html#RxxKap17000040005FD1F04C268">17.1.5 make zur Installation verwenden</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-000.html#RxxKap17000040005FD1F04C26E">17.1.6 make-Optionen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-000.html#RxxKap17000040005FD1F04C270">17.1.7 Ausblick</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a class="navh2" href="#RxxKap170010400061A1F029100">17.2 Bibliotheken erstellen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap170010400061A1F029102">17.2.1 Statische Bibliotheken erstellen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap170010400061A1F02917F">17.2.2 Dynamische Bibliotheken (Shared Libraries) erstellen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a class="navh2" href="#RxxKap170010400061A1F0291A1">17.2.3 Dynamisches Nachladen von Bibliotheken</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap17-002.html#RxxKap170020400061B1F03E100">17.3 RPM</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-002.html#RxxKap170020400061B1F03E181">17.3.1 Verzeichnisse, die RPM ben&ouml;tigt</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-002.html#RxxKap170020400061B1F03E194">17.3.2 Ein eigenes RPM-Paket erstellen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-002.html#RxxKap170020400061B1F03E196">17.3.3 Sources</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-002.html#RxxKap170020400061B1F03E19D">17.3.4 Die Spec-Datei</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-002.html#RxxKap170020400061B1F03E1E3">17.3.5 Paket erstellen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-002.html#RxxKap170020400061B1F03E1FB">17.3.6 Das Paket installieren</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap17-003.html#RxxKap170030400061C1F047100">17.4 RCS und CVS</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-003.html#RxxKap170030400061C1F047102">17.4.1 Software-Configuration-Management-Systeme (SCM)</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-003.html#RxxKap170030400061C1F047109">17.4.2 RCS</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-003.html#RxxKap170030400061C1F0471C2">17.4.3 CVS</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap17-004.html#RxxKap170040400061D1F040100">17.5 Zeitmessung von Programmen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-004.html#RxxKap170040400061D1F040105">17.5.1 Einfache Zeitmessung mit TIME – Laufzeit von Prozessen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-004.html#RxxKap170040400061D1F04010F">17.5.2 Profiling mit GPROF – Laufzeit von Funktionen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-004.html#RxxKap170040400061D1F040198">17.5.3 Analyse mit GCOV</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap17-005.html#RxxKap170050400061E1F02B100">17.6 Debuggen mit gdb und ddd</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap17-006.html#RxxKap170060400061F1F03C100">17.7 STRACE – Systemaufrufe verfolgen</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap17-007.html#RxxKap17007040006201F02E100">17.8 Memory Leaks und unerlaubte Speicherzugriffe</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-007.html#RxxKap17007040006201F02E104">17.8.1 efence</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline"><b><T3Verw><a href="Kap17-007.html#RxxKap17007040006201F02E112">17.8.2 valgrind</a></b></td>
</tr>
<tr>
<td valign="baseline" width="10"> </td>
<td valign="baseline" width="10"><img src="common/pfeil_rechts5.gif" width="10" height="10" border="0" alt="gp"></td>
<td valign="baseline" colspan="2"><b><a href="Kap17-008.html#RxxKap17008040006211F036100">17.9 Ausblick</a></b></td>
</tr>
</table><br></td>
</tr>
</table>
<table width="100%" cellpadding="20" cellspacing="0" border="0" bgcolor="#eeeeee">
<tr>
<td>
<a name="t21"></a><a name="t2t31"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div>
<h2 class="t2">17.2 <a id="RxxKap17201Bibliothekenerstellen" name="RxxKap17201Bibliothekenerstellen"></a>Bibliotheken erstell<a id="RxxKap170010400061A1F029100" name="RxxKap170010400061A1F029100"></a>en 
      <a href="#t2t32"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><img src="common/15x15leer.gif" width="15" height="15" border="0" alt="top"></h2>
<p><a id="Xxx999248" name="Xxx999248"></a><a id="Xxx999249" name="Xxx999249"></a>Zu Beginn der Programmiererlaufbahn verwendet man Bibliotheken, die von einer Distribution oder von anderen Programmierern zur Verf&uuml;gung gestellt werden. Aber irgendwann wird es Sie packen, eine eigene Bibliothek zu entwerfen; sei es nun, um der Open-Source-Gemeinde auch etwas zur&uuml;ckzugeben, oder aus Eigenbedarf, um immer wiederkehrende Routinen endlich ein f&uuml;r alle Mal in einer Bibliothek zu vereinen. Hierzu stehen Ihnen zwei M&ouml;glichkeiten zur Verf&uuml;gung – das Erstellen einer statischen oder einer dynamischen Bibliothek. Welche von beiden Methoden die bessere f&uuml;r welchen Anwendungsfall ist und wie Sie diese erstellen k&ouml;nnen, erfahren Sie jetzt in den folgenden Abschnitten.</p>
<a name="t31"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t32"></a><h3 class="t3">17.2.1 Statische Bibliotheken erstelle<a id="RxxKap170010400061A1F029102" name="RxxKap170010400061A1F029102"></a>n 
      <a href="#t2t33"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t31"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999253" name="Xxx999253"></a>Wenn Sie in Ihrem Programm eine statische Bibliothek verwenden wollen, m&uuml;ssen Sie diese namentlich beim Linken angeben. Damit steht dem Programm das komplette Archiv zur Verf&uuml;gung. Dieses Vorgehen hat allerdings den Nachteil, dass mehr Platz sowohl auf der Festplatte als auch im Hauptspeicher daf&uuml;r n&ouml;tig ist, weil statische Bibliotheken mehrfach vorhanden sein k&ouml;nnten – sprich in allen Programmen, die ebenfalls diese statische Bibliothek verwenden. Allerdings hat diese Methode auch Vorteile, sonst w&uuml;rde man sie ja schlie&szlig;lich nicht verwenden. Da alle Funktionen der Bibliothek dem Programm hinzugef&uuml;gt werden, stehen somit auch alle jederzeit sofort zur Verf&uuml;gung.</p>
<p>Im Folgenden m&ouml;chte ich Ihnen das Erstellen einer statischen Bibliothek in einfachster Weise zeigen. Dies kann jederzeit auch mit umfangreicheren Projekten gemacht werden. Sie ben&ouml;tigen dazu folgende Dateien:</p>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"> Eine Headerdatei mit den Funktionsdefinitionen, symbolischen Konstanten und eventuell globalen Variablen.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"> Mindestens eine Quelldatei, in der die einzelnen Funktionen kodiert werden – sprich, deren Ausf&uuml;hrung programmiert wird. Aus dieser Quelldatei erstellen Sie anschlie&szlig;end die statische Bibliothek. Diese Datei ben&ouml;tigt somit auch keine <span class="listing">main()</span>-Funktion.</td>
</tr>
</table>
<p>Als Beispiel wird hier eine einfache Bibliothek erstellt, die lediglich zwei Integer miteinander vergleicht und bei Gleichheit 1 (<span class="listing">MYTRUE</span>) oder Ungleichheit 0 (<span class="listing">MYFALSE</span>) zur&uuml;ckliefert. Die Headerdatei <span class="listing">myequal.h</span> sieht wie folgt aus:</p>
<pre><a id="Xxx999259" name="Xxx999259"></a>/* myequal.h */
#ifndef _MYEQUAL_H_
#define _MYEQUAL_H_
#define MYTRUE  1
#define MYFALSE 0
typedef int MYBOOL;
MYBOOL my_equal( int a, int b );
#endif</pre>
<p>Jetzt fehlt noch die kodierte Funktion, woraus Sie anschlie&szlig;end die Bibliothek erstellen werden:</p>
<pre><a id="Xxx999262" name="Xxx999262"></a>/* myequal.c */
#include &lt;stdio.h&gt;
#include "myequal.h"
MYBOOL my_equal( int a, int b ) {
   if( a == b )
      return MYTRUE;
   return MYFALSE;
}</pre>
<p>Um jetzt aus der Quelldatei <span class="listing">myequal.c</span> eine Bibliotheksdatei zu machen, m&uuml;ssen Sie zuerst eine Objektdatei daraus erzeugen:</p>
<pre>$ gcc -c myequal.c
$ ls -l
insgesamt 12
-rw-r--r--    1 tot      users    125 2004–04–08 01:12 myequal.c
-rw-r--r--    1 tot      users    158 2004–04–08 01:11 myequal.h
-rw-r--r--    1 tot      users    644 2004–04–08 01:18 myequal.o</pre>
<p>Jetzt m&uuml;ssen Sie im n&auml;chsten Schritt ein Archiv erstellen. Sie wissen ja seit dem Kapitel &uuml;ber GCC, dass Archivdateien von statischen Bibliotheken meistens immer mit <span class="listing">lib</span> beginnen, gefolgt vom Namen der Bibliothek, und mit <span class="listing">.a</span> enden (z. B. <span class="listing">lib</span>name<span class="listing">.a</span>). Somit wird im Folgenden aus der Objektdatei <span class="listing">myequal.o</span> eine Archivdatei mit dem Namen <span class="listing">libmyequal.a</span> erstellt werden. Bei der Vergabe des Namens einer Bibliothek sollten Sie sicherstellen, dass es keine Bibliothek mit diesem Namen gibt.</p>
<p><a id="Xxx999267" name="Xxx999267"></a>Eine solche Archivdatei k&ouml;nnen Sie mit dem Befehl <span class="listing">ar</span> (Archiver) erzeugen. Damit k&ouml;nnen Sie Archive erstellen und ver&auml;ndern.</p>
<pre>$ ar crs libmyequal.a myequal.o
$ ls -l
insgesamt 16
-rw-r--r--    1 tot    users    790 2004–04–08 01:19 libmyequal.a
-rw-r--r--    1 tot    users    125 2004–04–08 01:12 myequal.c
-rw-r--r--    1 tot    users    158 2004–04–08 01:11 myequal.h
-rw-r--r--    1 tot    users    644 2004–04–08 01:18 myequal.o</pre>
<p>Mit der Option <span class="listing">r</span> sorgen Sie daf&uuml;r, dass bei einem bereits bestehenden Archiv die &auml;ltere Version der Objektdatei durch eine neuere Version ersetzt wird, und mit der Option <span class="listing">c</span> wird erzwungen, dass ein Archiv angelegt wird, falls es noch nicht existiert. Soll ein Index hinzugef&uuml;gt werden, so kann <span class="listing">s</span> mit hinzugegeben werden. <span class="listing">s</span> macht allerdings erst Sinn, wenn man weitere Objektfiles in ein bereits existierendes Archiv aufnimmt.</p>
<p>Jetzt haben Sie zwar ein Archiv in Ihrem Verzeichnis, aber der GCC wei&szlig; noch nichts davon, wenn Sie diesen mit dem Flag <span class="listing">-l</span> aufrufen w&uuml;rden. Daher muss diese Bibliothek noch einem Index, wo alle Funktionen eines Archivs eingetragen sind, hinzugef&uuml;gt werden. Mithilfe des Indexeintrags werden die Zugriffe auf Funktionen im Archiv optimiert. Dieser Eintrag wird mit einem einfachen Aufruf von <span class="listing">ranlib</span> erledigt.<a id="Xxx999272" name="Xxx999272"></a></p>
<pre>$ ranlib libmyequal.a</pre>
<p>Jetzt k&ouml;nnen Sie die Bibliothek installieren. Dazu m&uuml;ssen Sie nur noch die Bibliothek <span class="listing">libmyequal.a</span> in das Verzeichnis <span class="listing">/usr/lib</span> oder <span class="listing">/usr/local/lib</span> und die Headerdatei <span class="listing">myequal.h</span> in das Verzeichnis <span class="listing">/usr/include</span> oder <span class="listing">/usr/local/include</span> kopieren.</p>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>Die Verzeichnisse <span class="listing">/usr/lib</span> und <span class="listing">/usr/include</span> bzw. eigentlich alle Pfade au&szlig;er <span class="listing">/opt</span>, die nicht irgendwie ein »<span class="listing">local</span>« enthalten, sind f&uuml;r das System aus organisatorischen Gr&uuml;nden vorbehalten. Somit kann man immer gleich unterscheiden: <span class="listing">/usr/include/popt.h</span> <span class="listing">=&gt;</span> RPM-Paket, <span class="listing">/usr/local/include/popt.h</span> <span class="listing">=&gt;</span> eigener Weg. Nat&uuml;rlich befolgen nicht alle Source-Pakete unbedingt diese »<span class="listing">local</span>«-Technik.</p>
<p class="BStandard"><b>Hinweis   </b>Sie m&uuml;ssen die Bibliothek nat&uuml;rlich nicht in ein entsprechendes Verzeichnis installieren. Sie k&ouml;nnen nat&uuml;rlich auch jedes andere Verzeichnis hierzu verwenden, nur m&uuml;ssen Sie beim &Uuml;bersetzen angeben, wo sich die Include-Datei (<span class="listing">-I</span>) und wo sich die Bibliothek befindet (<span class="listing">-L</span>). Au&szlig;erdem empfiehlt es sich nat&uuml;rlich in der Praxis, den kompletten Vorgang mit einem Makefile zusammenzustellen. Statt <span class="listing">-L</span> ist nat&uuml;rlich auch der Pfad zur Bibliothek m&ouml;glich, z. B.: <span class="listing">gcc</span> <span class="listing">-o</span> <span class="listing">prog</span> <span class="listing">strap.o</span> <span class="listing">libdir/myequal.a</span>.</p>
</td>
</tr>
</table><br>
<pre># cp -p libmyequal.a /usr/local/lib
# cp -p myequal.h /usr/local/include</pre>
<p>Sofern die eben erw&auml;hnte »<span class="listing">local</span>«-Technik bei Ihnen nicht funktioniert, k&ouml;nnen Sie auch das <span class="listing">local</span> weglassen und die Dateien nach <span class="listing">/usr/lib</span> bzw. <span class="listing">/usr/include</span> kopieren. Am Ende k&ouml;nnen Sie nochmals <span class="listing">ranlib</span> &uuml;ber das Archiv laufen lassen, falls sich etwas ver&auml;ndert hat.</p>
<p>Hierzu ein einfaches Listing, das die Verwendung der neu erstellten statischen Bibliothek zeigt.</p>
<pre><a id="Xxx999283" name="Xxx999283"></a>/* testlist.c */
#include &lt;stdio.h&gt;
#include &lt;myequal.h&gt;
int main(void) {
   MYBOOL ret;   
   ret = my_equal ( 5 , 5 );
   if( ret == MYTRUE )
      printf("Beide Werte sind gleich\n");
   else
      printf("Die Wert sind nicht gleich\n");
   return 0;
}</pre>
<p>Das Programm bei der Ausf&uuml;hrung:</p>
<pre>$ gcc -o testlist testlist.c -lmyequal
$ ./testlist
Beide Werte sind gleich</pre>
<a name="t32"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t33"></a><h3 class="t3">17.2.2 Dynamische Bibliotheken (Shared Libraries) erstelle<a id="RxxKap170010400061A1F02917F" name="RxxKap170010400061A1F02917F"></a>n 
      <a href="#t2t34"><img src="common/down.gif" width="15" height="15" border="0" alt="down"></a><a href="#t2t32"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999289" name="Xxx999289"></a><a id="Xxx999290" name="Xxx999290"></a><a id="Xxx999291" name="Xxx999291"></a>Dynamische Bibliotheken (auch Shared Libraries genannt) werden im Gegensatz zu den statischen Verwandten nicht zum Programm hinzugebunden, sondern erst beim Aufruf des Programms aus einem Bibliotheksverzeichnis (gew&ouml;hnlich <span class="listing">/usr/lib</span> bzw. <span class="listing">/usr/local/lib</span>) in den Speicher geladen und dynamisch an das Programm gebunden. Verwendet nun ein weiteres Programm eine Funktion aus dieser Bibliothek, muss diese nicht erneut in den Speicher geladen werden, sondern es wird die bereits verwendete Instanz in den Adressraum des zweiten Programms eingeblendet. Dies hat auch den Vorteil, dass die Programme etwas schlanker sind – und das trifft sowohl auf deren Gr&ouml;&szlig;e als auch auf den Speicherverbrauch zu. Denn zum einen ist die Bibliothek nicht im Programmcode eingebunden, und zum anderen wird der Hauptspeicherbedarf dadurch gering gehalten, dass nur eine Instanz der Bibliothek ben&ouml;tigt wird. Nachteil: Befindet sich eine Bibliothek noch nicht im Speicher, kann beim ersten Laden dieser Bibliothek der Programmstart ein wenig l&auml;nger dauern, weil Shared Libraries immer vollst&auml;ndig geladen werden, w&auml;hrend bei der Kompilierung nur Objektdateien aus dem Archiv ausgew&auml;hlt werden, in denen auch betroffene Symbole (Funktionen, Variablen etc.) vorkommen. Allerdings ist diese »l&auml;ngere Dauer« kaum bemerkbar und eigentlich auch nicht erw&auml;hnenswert.</p>
<p>Ein wichtiger Aspekt bei dynamischen Bibliotheken ist die Abw&auml;rtskompatibilit&auml;t zu den vorhergehenden Versionen. Die Ver&auml;nderungen sollten dabei durch die Erh&ouml;hung der Unterversionsnummer gekennzeichnet werden. Sollte sich etwas gravierend &auml;ndern, kann auch die Hauptversionsnummer ver&auml;ndert werden. Der Aufbau von solchen Bibliotheken sieht wie folgt aus:</p>
<pre>lib(name).so.(Hauptversionsnr.)(Unterversionsnr.)(Releasenr.)</pre>
<p>Folgende Regeln gilt es dabei einzuhalten: Werden Fehler behoben, &auml;ndert sich die Release-Nummer. Werden neue Funktionen hinzugef&uuml;gt, doch die Bibliothek bleibt trotzdem abw&auml;rts kompatibel, dann sollte die Unterversionsnummer ver&auml;ndert werden. Ist die neue Bibliotheksversion hingegen nicht mehr abw&auml;rts kompatibel, wird die Hauptversionsnummer ver&auml;ndert. Nicht mehr abw&auml;rts kompatibel hei&szlig;t:</p>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"> Eine Funktion der Vorg&auml;ngerversion wurde ver&auml;ndert oder entfernt.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"> Wenn sich Funktionen anders verhalten als in der alten Version.</td>
</tr>
</table>
<table width="100%" border="0">
<tr>
<td valign="baseline" width="16"><img src="common/gp.gif" width="8" height="9" border="0" alt="gp"> 
        </td>
<td valign="top" width="100%" align="left"> Wenn sich Datenstrukturen grundlegend ver&auml;ndert haben; wurde z. B. in einer Datenstruktur der Datentyp ver&auml;ndert.</td>
</tr>
</table>
<p>Da allerdings nicht alle Systeme die gleichen Versionen von Bibliotheken verwenden, wird nach dem Kopieren einer neuen Bibliotheksversion ein entsprechendes Verzeichnis <span class="listing">ldconfig</span> aufgerufen. Dieses Programm legt f&uuml;r eine Bibliothek mit Versionsnummer einen symbolischen Link an, der nur den Namen der Bibliothek (ohne Versionsnummer) und einen Link auf den Namen der Bibliothek mit der Hauptversionsnummer (ohne Unterversionsnummer und Release-Nummer) enth&auml;lt. Einen &Uuml;berblick zu allen eingerichteten symbolischen Links k&ouml;nnen Sie sich mit folgendem Aufruf verschaffen:<a id="Xxx999300" name="Xxx999300"></a></p>
<pre># ldconfig -p 
887 libs found in cache `/etc/ld.so.cache'
        libzvt.so.2 (libc6) =&gt; /opt/gnome/lib/libzvt.so.2
        libzvt-2.0.so.0 (libc6) =&gt; /opt/gnome2/lib/libzvt-2.0.so.0
        libz.so.1 (libc6) =&gt; /lib/libz.so.1
        libz.so (libc6) =&gt; /usr/lib/libz.so
        liby2util.so.3 (libc6) =&gt; /usr/lib/liby2util.so.3
        liby2pm.so.2 (libc6) =&gt; /usr/lib/liby2pm.so.2
        liby2.so.2 (libc6) =&gt; /usr/lib/liby2.so.2
        libyui.so.2 (libc6) =&gt; /usr/lib/libyui.so.2
...</pre>
<p><span class="listing">ldconfig</span> sucht immer nach allen dynamischen Bibliotheken, die in einem bestimmten Verzeichnis liegen, und erstellt bei Bedarf einen symbolischen Link auf die jeweilige Version. Also eignet sich <span class="listing">ldconfig</span> prima zum Austausch von verschiedenen Bibliotheksversionen. Bitte beachten Sie, dass <span class="listing">ldconfig</span> nur mit Superuser-Rechten ausgef&uuml;hrt werden kann.</p>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>In welchem Verzeichnis <span class="listing">ldconfig</span> sucht, wird in der Datei <span class="listing">/etc/ld.so.conf<a id="Xxx999305" name="Xxx999305"></a></span> beschrieben. Sofern Sie weitere Verzeichnisse hinzuf&uuml;gen wollen, m&uuml;ssen Sie hier nur einen entsprechenden Eintrag hinzuf&uuml;gen.</p>
</td>
</tr>
</table><br>
<p>Hierzu folgen jetzt die einzelnen Schritte, die gew&ouml;hnlich verwendet werden, um eine dynamische Bibliothek zu erzeugen und auch zu installieren. Als Beispiel dient wieder dasselbe Listing, wie Sie es schon beim Erstellen von statischen Bibliotheken verwendet haben.</p>
<p>Zuerst m&uuml;ssen Sie die Quelldatei kompilieren, um eine Objektdatei daraus zu erzeugen:</p>
<pre>$ gcc -fPIC -Wall -g -c myequal.c</pre>
<p>Hierbei wurde zus&auml;tzlich die Option <span class="listing">-fPIC</span> verwendet, um positionsunabh&auml;ngigen Code zu erzeugen. Dies verhindert, dass im Maschinencode eine feste Adresse daf&uuml;r vergeben wird und somit die dynamische Bibliothek an (fast) jeder beliebigen Stelle des Adressraums vom Programm eingebunden werden kann.</p>
<p>Jetzt zum Linken der Objektdatei:</p>
<pre>$ gcc -ggdb3 -shared -Wl,-soname,libequal.so.1 –o \
             libequal.so.1.0 myequal.o -lc</pre>
<p>Mit <span class="listing">-shared</span> geben Sie an, dass hier eine dynamische Bibliothek erzeugt werden soll. <span class="listing">-Wl</span> leitet die Optionen an den Linker <span class="listing">ld</span> weiter. F&uuml;r <span class="listing">-soname</span> wird der vollst&auml;ndige Bibliotheksname mit den Versionsnummern angegeben. Mit <span class="listing">myequal.o</span> geben Sie die Objektdatei an, die in dieser dynamischen Bibliothek aufzunehmen ist. Hierbei k&ouml;nnen selbstverst&auml;ndlich mehrere Objektdateien aufgelistet werden. Mit <span class="listing">-lc</span> linken Sie noch die C-Bibliothek hinzu, was Sie in der Praxis immer machen sollten. Nat&uuml;rlich k&ouml;nnen auch hierbei noch mehr Bibliotheken hinzugelinkt werden. Hier nochmals die Syntax dazu:</p>
<pre>gcc -g -shared – Wl,-soname,soname -o bibliotheksname \
Objektdatei(en) Bibliothek(en)</pre>
<p>Beim anschlie&szlig;enden Linken mit einer Bibliothek (&uuml;ber <span class="listing">-l</span>) sucht der Linker sich dann die entsprechende Datei, z. B. <span class="listing">/usr/lib/libbibliotheksname.so</span>, sieht sich diese an (dass es ein Symlink ist, wird ignoriert) und schaut nach dem <span class="listing">DT_SONAME</span>-Tag, das den Dateinamen beinhaltet, der in die Executable eingetragen werden soll.</p>
<p>Bei einem Vergleich zwischen den dynamischen Bibliotheken und den statischen f&auml;llt der Gr&ouml;&szlig;enunterschied erheblich auf:</p>
<pre>$ ls -l
insgesamt 36
-rwxr-xr-x  1 tot  users   11634 2004–04–08 04:26 libequal.so.1.0
-rw-r--r--  1 tot  users     790 2004–04–08 01:38 libmyequal.a</pre>
<p>Jetzt ben&ouml;tigen Sie Superuser-Rechte, um die dynamische Bibliothek in das Verzeichnis    <span class="listing">/usr/lib</span> bzw. <span class="listing">/usr/local/lib</span> zu kopieren. Wechseln Sie am besten gleich in das Verzeichnis:</p>
<pre># cp libequal.so.1.0 /usr/lib
# cd /usr/lib</pre>
<p>Erzeugen Sie jetzt einen symbolischen Link, den Sie f&uuml;r den Linker beim &Uuml;bersetzen ben&ouml;tigen, wenn Sie die dynamische Bibliothek mit dem Flag <span class="listing">-l</span> angeben:</p>
<pre>/usr/lib # ln -fs libequal.so.1.0 libequal.so.1
/usr/lib # ln -fs libequal.so.1 libequal.so</pre>
<p>Zu guter Letzt m&uuml;ssen Sie jetzt noch <span class="listing">ldconfig</span> aufrufen:</p>
<pre># ldconfig</pre>
<p>Das sollte gen&uuml;gen, um mit der dynamischen Bibliothek arbeiten zu k&ouml;nnen. Jetzt k&ouml;nnen Sie wieder dasselbe Listing wie schon im Beispiel der statischen Bibliothek verwenden und folgenderma&szlig;en &uuml;bersetzen:</p>
<pre>$ gcc -o testlist testlist.c –lequal</pre>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>Haben Sie auf Ihrem System sowohl eine statische als auch eine dynamische Version von <span class="listing">libequal.so</span> und <span class="listing">libequal.a</span>, bindet der Compiler, sofern Sie nichts anderes angeben wird, standardm&auml;&szlig;ig immer die dynamische Version hinzu – was nat&uuml;rlich durch Linker-Skripte ge&auml;ndert werden kann. Ein Blick in z. B. <span class="listing">/usr/lib/libc.so</span> zeigt so manches mehr.</p>
</td>
</tr>
</table><br>
<a name="t33"></a><br><div align="center"><a href="#top"><img src="common/top.gif" border="0" alt="Rheinwerk Computing"></a></div><a name="t2t34"></a><h3 class="t3">17.2.3 Dynamisches Nachladen von Bibliotheke<a id="RxxKap170010400061A1F0291A1" name="RxxKap170010400061A1F0291A1"></a>n 
      <img src="common/15x15leer.gif" width="15" height="15" border="0" alt="top"><a href="#t2t33"><img src="common/top.gif" width="15" height="15" border="0" alt="top"></a></h3>
<p><a id="Xxx999333" name="Xxx999333"></a>Au&szlig;er dem automatischen Nachladen und Binden von Bibliotheken k&ouml;nnen Sie dynamische Bibliotheken auch zur Laufzeit des Programms nachladen. Hierf&uuml;r sind folgende Funktionen n&ouml;tig:<a id="Xxx999335" name="Xxx999335"></a><a id="Xxx999336" name="Xxx999336"></a><a id="Xxx999337" name="Xxx999337"></a><a id="Xxx999338" name="Xxx999338"></a></p>
<pre> #include &lt;dlfcn.h&gt;<a id="Xxx999339" name="Xxx999339"></a>
 void *dlopen(const char *filename, int flags);
 const char *dlerror(void);
 void *dlsym(void *handle, const char *symbol);
 int dlclose(void *handle);</pre>
<p>Mit der Funktion <span class="listing">dlopen()</span> &ouml;ffnen Sie eine dynamische Bibliothek <span class="listing">filename</span>. Bei Erfolg wird ein Zeiger auf die ge&ouml;ffnete Bibliothek zur&uuml;ckgegeben oder im Fehlerfall <span class="listing">NULL</span>. Sind in der Bibliothek Symbole, die nicht aufgel&ouml;st werden k&ouml;nnen (eine Bibliothek kann wie oben erw&auml;hnt ja eine andere noch ben&ouml;tigen), h&auml;ngt das Verhalten vom <span class="listing">flag</span> ab. Folgende Flags k&ouml;nnen hierf&uuml;r verwendet werden:</p>
<p><span class="listing">RTLD_LAZY</span> – Undefinierte Symbole werden aufgel&ouml;st, wenn eine Funktion in der dynamischen Bibliothek ausgef&uuml;hrt wird.</p>
<p><span class="listing">RTLD_NOW</span> – <span class="listing">dlopen()</span> – Kehrt erst dann zur&uuml;ck, wenn alle undefinierten Symbole aufgel&ouml;st werden konnten.</p>
<p><span class="listing">RTLD_GLOBAL</span> – Dieses Flag wird mit dem bitweisen ODER und mit einem der eben erw&auml;hnten Flags verwendet. Ist dieses angegeben, so sind die Symbole aus der geladenen Bibliothek den nachfolgenden geladenen Bibliotheken ebenfalls bekannt. Es gibt sozusagen zwei Symbolr&auml;ume, einmal f&uuml;r die Hauptanwendung und einmal die Library.</p>
<p>Tritt ein Fehler auf, k&ouml;nnen Sie mit der Funktion <span class="listing">dlerror()</span> einen String ausgeben lassen, der den zuletzt aufgetretenen Fehler genauer umschreibt.</p>
<p>Mit der Funktion <span class="listing">dlsym()</span> bekommen Sie bei Erfolg die Adresse des gew&uuml;nschten Symbols, das sich in der Bibliothek <span class="listing">handle</span> befindet, zur&uuml;ck (man kann n&auml;mlich nicht nur Funktionen mit <span class="listing">dl*()</span> holen!). Wenn <span class="listing">symbol</span> nicht aufgel&ouml;st werden konnte, wird <span class="listing">NULL</span> zur&uuml;ckgegeben.</p>
<p>Der Speicher, der auf die Bibliothek <span class="listing">handle</span> verweist, kann mit der Funktion <span class="listing">dlclose()</span> unter Angabe der Bibliothek <span class="listing">handle</span> wieder freigegeben werden. (Der Memory Debugger <span class="listing">GXmalloc</span> (Eigenkreation des Fachgutachters) verr&auml;t, dass <span class="listing">dlclose()</span> nicht alles freigibt, was <span class="listing">dlopen()</span> sich geholt hatte. Aber es handelt sich dabei um wenige Bytes pro Bibliothek.) Au&szlig;erdem wird ein Z&auml;hler, der die Anzahl der ge&ouml;ffneten Bibliotheken von <span class="listing">dlopen()</span> mitz&auml;hlt, wieder dekrementiert. Ist dieser Z&auml;hler 0, wird die Bibliothek aus dem Speicher entfernt.</p>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>Zum Verwenden der hier vorgestellten Funktionen m&uuml;ssen Sie die Bibliothek <span class="listing">libdl.a</span> bzw. <span class="listing">libdl.so</span> (statische oder dynamische Version) mit dem Flag <span class="listing">-ldl</span> hinzulinken.</p>
</td>
</tr>
</table><br>
<p>Das folgende Beispiel l&auml;dt die zuvor selbst geschriebene dynamische Bibliothek <span class="listing">libequal.so</span> w&auml;hrend der Laufzeit des Programms hinzu. Anschlie&szlig;end wird die Funktion <span class="listing">my_equal()</span> geladen (genauer, die Adresse der Funktion ermittelt) und zwei Zahlen miteinander so lange verglichen, bis Sie f&uuml;r einen der Werte 0 angeben. Am Ende wird jeweils der Speicher wieder freigegeben. Zwar hat unsere dynamische Bibliothek nur eine Funktion, die verwendet werden kann, dennoch k&ouml;nnen Sie beinahe beliebig viele (vorhandene) Funktionen einer Bibliothek dynamisch dazuladen. Die einzelnen Funktionen wurden so geschrieben, dass Sie diese auch ohne Probleme bei einem anderen Projekt mit einer anderen Bibliothek verwenden k&ouml;nnen.</p>
<pre><a id="Xxx999353" name="Xxx999353"></a>/* dynamisch.c */
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;myequal.h&gt;
#include &lt;dlfcn.h&gt;
#define LIBEQUAL "libequal.so"
/* dynamische Bibliothek laden */
static void *my_load_dyn (const char *lib) {
  static void *handle;
  handle = dlopen (LIBEQUAL, RTLD_NOW);
  if (handle == NULL) {
    printf ("Fehler bei dlopen(): %s\n", dlerror ());
    exit (EXIT_FAILURE);
  }
  return handle;
}
/* Funktion aus der dynamischen Bibliothek laden */
static void *my_load_func (void *handle, const char *func) {
  void *funcptr = dlsym (handle, func);
  if (funcptr == NULL) {
    printf ("Fehler bei dlsym(): %s\n", dlerror ());
    exit (EXIT_FAILURE);
  }
  return funcptr;
}
/* Speicher wieder freigeben */
static void my_close_func (void *handle) {
  if (dlclose (handle))
    printf ("Fehler bei dlclose(): %s\n", dlerror ());
}
int main (void ) {
  MYBOOL ret;
  void *lib_handle;
  int (*equal) (int a, int b);
  int val1=1 ,val2 = 1;
  while ( 1 ) {
    printf ("Zahl 1 eingeben: ");
    scanf ("%d", &amp;val1);
    printf ("Zahl 2 eingeben: ");
    scanf ("%d", &amp;val2);
    if( val1 == 0 || val2 ==0 )
      break;
    lib_handle = my_load_dyn (LIBEQUAL);
    equal = my_load_func (lib_handle, "my_equal");
    ret = (*equal) (val1, val2);
    if (ret == MYTRUE)
      printf ("Beide Werte sind gleich\n");
    else
      printf ("Die Werte sind nicht gleich\n");
    my_close_func (lib_handle);
  }
  return EXIT_SUCCESS;
}</pre>
<p>Das Programm bei der Ausf&uuml;hrung:</p>
<pre>$ gcc -o dynamisch dynamisch.c -ldl
$ ./dynamisch
Zahl 1 eingeben: 3
Zahl 2 eingeben: 4
Die Werte sind nicht gleich
Zahl 1 eingeben: 5
Zahl 2 eingeben: 5
Beide Werte sind gleich
Zahl 1 eingeben: 1
Zahl 2 eingeben: 0</pre>
<br><table width="100%" border="0" cellspacing="1" cellpadding="3">
<tr>
<td class="tabellentext" bgcolor="#000000">
<p class="BStandard"><b>Hinweis   </b>Dass die Bibliothek im Beispiel immer von neuem geladen wird, dient nur zur Demonstration – sprich, Sie k&ouml;nnen sich hierbei gerne eine Abfrage einbauen, die ermittelt, welche Bibliothek Sie sich im n&auml;chsten Durchgang laden wollen. Es soll praktisch damit gezeigt werden, dass jederzeit – w&auml;hrend der Laufzeit des Programms – eine Bibliothek geladen und am Ende wieder freigegeben werden kann. In der Praxis sollten Sie das <span class="listing">dlopen()</span> nat&uuml;rlich noch vor das <span class="listing">while()</span> setzen. </p>
</td>
</tr>
</table><br>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td width="100%" class="start" colspan="1" height="22" align="center">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td width="20%"><a class="navnav" href="Kap17-000.html"> &lt;&lt; zur&uuml;ck</a></td>
<td width="59%">
<div align="center"><a class="navnav" href="#">&lt;top&gt;</a></div>
</td>
<td align="right" width="20%">
<div align="right"><a class="navnav" href="Kap17-002.html">vor &gt;&gt; </a></div>
</td>
</tr>
</table>
</td>
</tr>
</table>
</div>
</td>
<td width="10" valign="top">&nbsp;&nbsp;</td>
<td width="160" valign="top">
    <table border="0" cellpadding="0" cellspacing="0" width="160">
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                        <td class="tbl2" height="20" colspan="2">
                            &nbsp;<a href="https://www.rheinwerk-verlag.de/?GPP=oplup" class="navs">
                            <strong>Zum Katalog</strong></a>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2">
                            <img src="common/leer.gif" border="0" height="1" width="1"></td>
                        <td valign="top">
                            <table cellspacing="3">
                                <tr>
                                    <td><a href="https://www.rheinwerk-verlag.de/linux-unix-programmierung_1137/?GPP=oplup">
                                        <img src="common/749.gif"  border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Linux-UNIX-Programmierung" title="Zum Katalog: Linux-UNIX-Programmierung">
                                        <br /><strong>Linux-UNIX-<br />Programmierung</strong><br /><img src="common/pfeil_rechts5.gif" border="0" alt="">bestellen</a>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td><img src="common/leer.gif" height="2" width="1" border="0" /></td>
        </tr>
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                        <td class="tbl2" height="20" colspan="2"><strong>&nbsp;Ihre Meinung?</strong></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td>
                        <td valign="top">
                            <table cellspacing="3">
                                <tr>
                                    <td>Wie hat Ihnen das &lt;openbook&gt; gefallen?<br /><a href="https://www.rheinwerk-verlag.de/feedback/"><img src="common/pfeil_rechts5.gif" border="0" alt="">Ihre Meinung</a>
                                    <br /><br /></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td><img src="common/leer.gif" height="2" width="1" border="0" /></td>
        </tr>
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                        <td class="tbl2" height="20" colspan="2">&nbsp;<a href="https://www.rheinwerk-verlag.de/?GPP=oplup" class="navs"><strong>Buchtipps</strong></a></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/linux-server_3685/?GPP=oplup">
                        <img src="common/3020.gif" width="78" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Linux-Server" title="Zum Katalog: Linux-Server"><br /><br /><br /><br /><br /><br /><br />&nbsp;Linux-Server</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/das-komplettpaket-lpic-1-lpic-2_3782/?GPP=oplup">
                        <img src="common/3529.gif" width="70" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Das Komplettpaket LPIC-1 &amp; LPIC-2" title="Zum Katalog: Das Komplettpaket LPIC-1 &amp; LPIC-2"><br /><br /><br /><br /><br /><br /><br />&nbsp;Das Komplettpaket<br />&nbsp;LPIC-1 &amp; LPIC-2</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/linux-hochverfugbarkeit_3420/?GPP=oplup">
                        <img src="common/2542.gif" width="70" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Linux-Hochverfügbarkeit" title="Zum Katalog: Linux-Hochverfügbarkeit"><br /><br /><br /><br /><br /><br /><br />&nbsp;Linux-<br />&nbsp;Hochverfügbarkeit</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/shell-programmierung_3345/?GPP=oplup">
                        <img src="common/2310.gif" width="69" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Shell-Programmierung" title="Zum Katalog: Shell-Programmierung"><br /><br /><br /><br /><br /><br /><br />&nbsp;Shell-<br />&nbsp;Programmierung</a><br /><br /></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td><td valign="top">
                        <a href="https://www.rheinwerk-verlag.de/linux_3436/?GPP=oplup">
                        <img src="common/2591.gif" width="79" height="100" border="0" align="left" hspace="4" vspace="8" alt="Zum Katalog: Linux Handbuch" title="Zum Katalog: Linux Handbuch"><br /><br /><br /><br /><br /><br /><br />&nbsp;Linux Handbuch</a><br /><br /></td>
                    </tr>
                </table></td>
        </tr>
        <tr>
            <td><img src="common/leer.gif" height="2" width="1" border="0" /></td>
        </tr>
        <tr>
            <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                    <tr>
                        <td class="tbl2" height="20" colspan="2"><strong>&nbsp;Shopping</strong></td>
                    </tr>
                    <tr>
                        <td valign="top" class="tbl2" width="2"><img src="common/leer.gif" border="0" height="1" width="1"></td>
                        <td valign="top">
                            <table cellspacing="3">
                                <tr>
                                    <td><b>Versandkostenfrei</b> bestellen in Deutschland und &Ouml;sterreich<br /><a href="https://www.rheinwerk-verlag.de/hilfe/bestellung_6?GPP=oplup"><img src="common/pfeil_rechts5.gif" border="0" alt="">Info</a><br /><br /></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</td>
</tr>
</table>
<br /><br />
<hr width="70%" align="center">
<br />
<div align="center">
    <p class="standard">
        <strong>Copyright © Rheinwerk Verlag GmbH 2006</strong>
        <br />F&uuml;r Ihren privaten Gebrauch d&uuml;rfen Sie die Online-Version nat&uuml;rlich 
        ausdrucken. Ansonsten unterliegt das &lt;openbook&gt; denselben Bestimmungen, 
        wie die gebundene Ausgabe: Das Werk einschlie&szlig;lich aller seiner Teile ist 
        urheberrechtlich gesch&uuml;tzt. Alle Rechte vorbehalten einschlie&szlig;lich der 
        Vervielf&auml;ltigung, &Uuml;bersetzung, Mikroverfilmung sowie Einspeicherung und 
        Verarbeitung in elektronischen Systemen.
    </p>
    <br><a href="https://www.rheinwerk-verlag.de/">[Rheinwerk Computing]</a>
    <br /><br />Rheinwerk Verlag GmbH, Rheinwerkallee 4, 53227 Bonn, 
    Tel.: 0228.42150.0, Fax 0228.42150.77, 
    <a href="mailto:service@rheinwerk-verlag.de">service@rheinwerk-verlag.de</a>
</div>
<br /><br />
</body>

<!-- Mirrored from openbook.rheinwerk-verlag.de/linux_unix_programmierung/Kap17-001.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 19 May 2017 19:47:19 GMT -->
</html>
